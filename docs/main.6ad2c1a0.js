parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"VUpU":[function(require,module,exports) {

},{}],"OgiL":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){for(var n,o=h(r),a=o[0],u=o[1],i=new e(c(r,a,u)),f=0,A=u>0?a-4:a,d=0;d<A;d+=4)n=t[r.charCodeAt(d)]<<18|t[r.charCodeAt(d+1)]<<12|t[r.charCodeAt(d+2)]<<6|t[r.charCodeAt(d+3)],i[f++]=n>>16&255,i[f++]=n>>8&255,i[f++]=255&n;return 2===u&&(n=t[r.charCodeAt(d)]<<2|t[r.charCodeAt(d+1)]>>4,i[f++]=255&n),1===u&&(n=t[r.charCodeAt(d)]<<10|t[r.charCodeAt(d+1)]<<4|t[r.charCodeAt(d+2)]>>2,i[f++]=n>>8&255,i[f++]=255&n),i}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"uQZ8":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"buj3":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"iFYY":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"OgiL","ieee754":"uQZ8","isarray":"buj3","buffer":"iFYY"}],"oJsy":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"jphU":[function(require,module,exports) {
var define;
var Buffer = require("buffer").Buffer;
var global = arguments[3];
var process = require("process");
var t,e=require("buffer").Buffer,i=arguments[3],r=require("process"),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=s||{version:"2.3.6"};function o(t){var e=t.targetCanvas,i=e.width,r=e.height,n=t.destinationWidth,s=t.destinationHeight;i===n&&r===s||(e.width=n,e.height=s)}function a(t,e){var i=t.canvas,r=e.targetCanvas,n=r.getContext("2d");n.translate(0,r.height),n.scale(1,-1);var s=i.height-r.height;n.drawImage(i,0,s,r.width,r.height,0,0,r.width,r.height)}function h(t,e){var i=e.targetCanvas.getContext("2d"),r=e.destinationWidth,n=e.destinationHeight,s=r*n*4,o=new Uint8Array(this.imageBuffer,0,s),a=new Uint8ClampedArray(this.imageBuffer,0,s);t.readPixels(0,0,r,n,t.RGBA,t.UNSIGNED_BYTE,o);var h=new ImageData(a,r,n);i.putImageData(h,0,0)}"undefined"!=typeof exports?exports.fabric=s:"function"==typeof t&&t.amd&&t([],function(){return s}),"undefined"!=typeof document&&"undefined"!=typeof window?(s.document=document,s.window=window):(s.document=require("jsdom").jsdom(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]}}),s.jsdomImplForWrapper=require("jsdom/lib/jsdom/living/generated/utils").implForWrapper,s.nodeCanvas=require("jsdom/lib/jsdom/utils").Canvas,s.window=s.document.defaultView,DOMParser=require("xmldom").DOMParser),s.isTouchSupported="ontouchstart"in s.window,s.isLikelyNode=void 0!==e&&"undefined"==typeof window,s.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","instantiated_by_use"],s.DPI=96,s.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",s.fontPaths={},s.iMatrix=[1,0,0,1,0,0],s.canvasModule="canvas",s.perfLimitSizeTotal=2097152,s.maxCacheSideLimit=4096,s.minCacheSideLimit=256,s.charWidthsCache={},s.textureSize=2048,s.enableGLFiltering=!0,s.devicePixelRatio=s.window.devicePixelRatio||s.window.webkitDevicePixelRatio||s.window.mozDevicePixelRatio||1,s.browserShadowBlurConstant=1,s.arcToSegmentsCache={},s.boundsOfCurveCache={},s.cachesBoundsOfCurve=!0,s.initFilterBackend=function(){return s.enableGLFiltering&&s.isWebglSupported&&s.isWebglSupported(s.textureSize)?(console.log("max texture size: "+s.maxTextureSize),new s.WebglFilterBackend({tileSize:s.textureSize})):s.Canvas2dFilterBackend?new s.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=s),function(){function t(t,e){if(this.__eventListeners[t]){var i=this.__eventListeners[t];e?i[i.indexOf(e)]=!1:s.util.array.fill(i,!1)}}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"===n(arguments[0]))for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,n=i.length;r<n;r++)i[r]&&i[r].call(this,e||{});return this.__eventListeners[t]=i.filter(function(t){return!1!==t}),this}}}s.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),s.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,i){var r=this._objects;return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,i=!1,r=0,n=arguments.length;r<n;r++)-1!==(t=e.indexOf(arguments[r]))&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[r]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=0,n=i.length;r<n;r++)t.call(e,i[r],r,i);return this},getObjects:function(t){return void 0===t?this._objects.concat():this._objects.filter(function(e){return e.type===t})},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t){return this._objects.indexOf(t)>-1},complexity:function(){return this._objects.reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},s.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof s.Gradient||this.set(e,new s.Gradient(t))},_initPattern:function(t,e,i){!t||!t.source||t instanceof s.Pattern?i&&i():this.set(e,new s.Pattern(t,i))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var e=s.util.getFunctionBody(t.clipTo);void 0!==e&&(this.clipTo=new Function("ctx",e))}},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"===(void 0===t?"undefined":n(t))?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.pow,n=Math.abs,o=Math.PI/180,a=Math.PI/2;s.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/a){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/a){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*o},radiansToDegrees:function(t){return t/o},rotatePoint:function(t,e,i){t.subtractEquals(e);var r=s.util.rotateVector(t,i);return new s.Point(r.x,r.y).addEquals(e)},rotateVector:function(t,e){var i=s.util.sin(e),r=s.util.cos(e);return{x:t.x*r-t.y*i,y:t.x*i+t.y*r}},transformPoint:function(t,e,i){return i?new s.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new s.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t){var e=[t[0].x,t[1].x,t[2].x,t[3].x],i=s.util.array.min(e),r=s.util.array.max(e)-i,n=[t[0].y,t[1].y,t[2].y,t[3].y],o=s.util.array.min(n);return{left:i,top:o,width:r,height:s.util.array.max(n)-o}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),i=[e*t[3],-e*t[1],-e*t[2],e*t[0]],r=s.util.transformPoint({x:t[4],y:t[5]},i,!0);return i[4]=-r.x,i[5]=-r.y,i},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=s.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*s.DPI/25.4;case"cm":return r*s.DPI/2.54;case"in":return r*s.DPI;case"pt":return r*s.DPI/72;case"pc":return r*s.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=s.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),s.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(e){if(!e)return s;var i,r=e.split("."),n=r.length,o=t||s.window;for(i=0;i<n;++i)o=o[r[i]];return o},loadImage:function(t,e,i,r){if(t){var n=s.util.createImage(),o=function(){e&&e.call(i,n),n=n.onload=n.onerror=null};n.onload=o,n.onerror=function(){s.log("Error loading "+n.src),e&&e.call(i,null,!0),n=n.onload=n.onerror=null},0!==t.indexOf("data")&&r&&(n.crossOrigin=r),"data:image/svg"===t.substring(0,14)&&(n.onload=null,s.util.loadImageInDom(n,o)),n.src=t}else e&&e.call(i,t)},loadImageInDom:function(t,e){var i=s.document.createElement("div");i.style.width=i.style.height="1px",i.style.left=i.style.top="-100%",i.style.position="absolute",i.appendChild(t),s.document.querySelector("body").appendChild(i),t.onload=function(){e(),i.parentNode.removeChild(i),i=null}},enlivenObjects:function(t,e,i,r){function n(){++a===h&&e&&e(o)}var o=[],a=0,h=(t=t||[]).length;h?t.forEach(function(t,e){t&&t.type?s.util.getKlass(t.type,i).fromObject(t,function(i,s){s||(o[e]=i),r&&r(t,i,s),n()}):n()}):e&&e(o)},enlivenPatterns:function(t,e){function i(){++n===o&&e&&e(r)}var r=[],n=0,o=(t=t||[]).length;o?t.forEach(function(t,e){t&&t.source?new s.Pattern(t,function(t){r[e]=t,i()}):(r[e]=t,i())}):e&&e(r)},groupSVGElements:function(t,e,i){var r;return 1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),r=new s.Group(t,e),void 0!==i&&(r.sourcePath=i),r)},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,n=i.length;r<n;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,n,s,o,a){var h=s-r,c=o-n,l=e(h*h+c*c),u=i(c,h),f=a.length,d=0,g=!0;for(t.save(),t.translate(r,n),t.moveTo(0,0),t.rotate(u),r=0;l>r;)(r+=a[d++%f])>l&&(r=l),t[g?"lineTo":"moveTo"](r,0),g=!g;t.restore()},createCanvasElement:function(){return s.document.createElement("canvas")},createImage:function(){return s.document.createElement("img")},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var n=i(t[1],t[0]),s=r(t[0],2)+r(t[1],2),a=e(s),h=(t[0]*t[3]-t[2]*t[1])/a,c=i(t[0]*t[2]+t[1]*t[3],s);return{angle:n/o,scaleX:a,scaleY:h,skewX:c/o,skewY:0,translateX:t[4],translateY:t[5]}},customTransformMatrix:function(t,e,i){var r=[1,0,n(Math.tan(i*o)),1],a=[n(t),0,0,n(e)];return s.util.multiplyTransformMatrices(a,r,!0)},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);var n,s=!0,o=t.getImageData(e,i,2*r||1,2*r||1),a=o.data.length;for(n=3;n<a&&!1!==(s=o.data[n]<=0);n+=4);return o=null,s},parsePreserveAspectRatioAttribute:function(t){var e,i="meet",r=t.split(" ");return r&&r.length&&("meet"!==(i=r.pop())&&"slice"!==i?(e=i,i="meet"):r.length&&(e=r.pop())),{meetOrSlice:i,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?s.charWidthsCache[t]&&delete s.charWidthsCache[t]:s.charWidthsCache={}},limitDimsByArea:function(t,e){var i=Math.sqrt(e*t),r=Math.floor(e/i);return{x:Math.floor(i),y:r}},capValue:function(t,e,i){return Math.max(t,Math.min(e,i))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)}}}("undefined"!=typeof exports?exports:this),function(){var t=Array.prototype.join;function e(e,n,o,a,h,c,l){var u=t.call(arguments);if(s.arcToSegmentsCache[u])return s.arcToSegmentsCache[u];var f=Math.PI,d=l*f/180,g=s.util.sin(d),p=s.util.cos(d),v=0,m=0,_=-p*e*.5-g*n*.5,y=-p*n*.5+g*e*.5,x=(o=Math.abs(o))*o,b=(a=Math.abs(a))*a,C=y*y,S=_*_,T=x*b-x*C-b*S,w=0;if(T<0){var O=Math.sqrt(1-T/(x*b));o*=O,a*=O}else w=(h===c?-1:1)*Math.sqrt(T/(x*C+b*S));var k=w*o*y/a,E=-w*a*_/o,D=p*k-g*E+.5*e,j=g*k+p*E+.5*n,A=r(1,0,(_-k)/o,(y-E)/a),P=r((_-k)/o,(y-E)/a,(-_-k)/o,(-y-E)/a);0===c&&P>0?P-=2*f:1===c&&P<0&&(P+=2*f);for(var F=Math.ceil(Math.abs(P/f*2)),M=[],I=P/F,L=8/3*Math.sin(I/4)*Math.sin(I/4)/Math.sin(I/2),R=A+I,B=0;B<F;B++)M[B]=i(A,R,p,g,o,a,D,j,L,v,m),v=M[B][4],m=M[B][5],A=R,R+=I;return s.arcToSegmentsCache[u]=M,M}function i(t,e,i,r,n,o,a,h,c,l,u){var f=s.util.cos(t),d=s.util.sin(t),g=s.util.cos(e),p=s.util.sin(e),v=i*n*g-r*o*p+a,m=r*n*g+i*o*p+h;return[l+c*(-i*n*d-r*o*f),u+c*(-r*n*d+i*o*f),v+c*(i*n*p+r*o*g),m+c*(r*n*p-i*o*g),v,m]}function r(t,e,i,r){var n=Math.atan2(e,t),s=Math.atan2(r,i);return s>=n?s-n:2*Math.PI-(n-s)}function n(e,i,r,n,o,a,h,c){var l;if(s.cachesBoundsOfCurve&&(l=t.call(arguments),s.boundsOfCurveCache[l]))return s.boundsOfCurveCache[l];var u,f,d,g,p,v,m,_,y=Math.sqrt,x=Math.min,b=Math.max,C=Math.abs,S=[],T=[[],[]];f=6*e-12*r+6*o,u=-3*e+9*r-9*o+3*h,d=3*r-3*e;for(var w=0;w<2;++w)if(w>0&&(f=6*i-12*n+6*a,u=-3*i+9*n-9*a+3*c,d=3*n-3*i),C(u)<1e-12){if(C(f)<1e-12)continue;0<(g=-d/f)&&g<1&&S.push(g)}else(m=f*f-4*d*u)<0||(0<(p=(-f+(_=y(m)))/(2*u))&&p<1&&S.push(p),0<(v=(-f-_)/(2*u))&&v<1&&S.push(v));for(var O,k,E,D=S.length,j=D;D--;)O=(E=1-(g=S[D]))*E*E*e+3*E*E*g*r+3*E*g*g*o+g*g*g*h,T[0][D]=O,k=E*E*E*i+3*E*E*g*n+3*E*g*g*a+g*g*g*c,T[1][D]=k;T[0][j]=e,T[1][j]=i,T[0][j+1]=h,T[1][j+1]=c;var A=[{x:x.apply(null,T[0]),y:x.apply(null,T[1])},{x:b.apply(null,T[0]),y:b.apply(null,T[1])}];return s.cachesBoundsOfCurve&&(s.boundsOfCurveCache[l]=A),A}s.util.drawArc=function(t,i,r,n){for(var s=n[0],o=n[1],a=n[2],h=n[3],c=n[4],l=[[],[],[],[]],u=e(n[5]-i,n[6]-r,s,o,h,c,a),f=0,d=u.length;f<d;f++)l[f][0]=u[f][0]+i,l[f][1]=u[f][1]+r,l[f][2]=u[f][2]+i,l[f][3]=u[f][3]+r,l[f][4]=u[f][4]+i,l[f][5]=u[f][5]+r,t.bezierCurveTo.apply(t,l[f])},s.util.getBoundsOfArc=function(t,i,r,s,o,a,h,c,l){for(var u,f=0,d=0,g=[],p=e(c-t,l-i,r,s,a,h,o),v=0,m=p.length;v<m;v++)u=n(f,d,p[v][0],p[v][1],p[v][2],p[v][3],p[v][4],p[v][5]),g.push({x:u[0].x+t,y:u[0].y+i}),g.push({x:u[1].x+t,y:u[1].y+i}),f=p[v][4],d=p[v][5];return g},s.util.getBoundsOfCurve=n}(),function(){var t=Array.prototype.slice;function e(t,e,i){if(t&&0!==t.length){var r=t.length-1,n=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],n)&&(n=t[r][e]);else for(;r--;)i(t[r],n)&&(n=t[r]);return n}}s.util.array={fill:function(t,e){for(var i=t.length;i--;)t[i]=e;return t},invoke:function(e,i){for(var r=t.call(arguments,2),n=[],s=0,o=e.length;s<o;s++)n[s]=r.length?e[s][i].apply(e[s],r):e[s][i].call(e[s]);return n},min:function(t,i){return e(t,i,function(t,e){return t<e})},max:function(t,i){return e(t,i,function(t,e){return t>=e})}}}(),function(){function t(e,i,r){if(r)if(!s.isLikelyNode&&i instanceof Element)e=i;else if(i instanceof Array){e=[];for(var o=0,a=i.length;o<a;o++)e[o]=t({},i[o],r)}else if(i&&"object"===(void 0===i?"undefined":n(i)))for(var h in i)i.hasOwnProperty(h)&&(e[h]=t({},i[h],r));else e=i;else for(var h in i)e[h]=i[h];return e}s.util.object={extend:t,clone:function(e,i){return t({},e,i)}},s.util.object.extend(s.util,s.Observable)}(),function(){function t(t,e){var i=t.charCodeAt(e);if(isNaN(i))return"";if(i<55296||i>57343)return t.charAt(e);if(55296<=i&&i<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var r=t.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var n=t.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1}s.util.string={camelize:function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var i,r=0,n=[];for(r=0;r<e.length;r++)!1!==(i=t(e,r))&&n.push(i);return n}}}(),function(){var t=Array.prototype.slice,e=function(){},i=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),r=function(t,e,r){for(var n in e)n in t.prototype&&"function"==typeof t.prototype[n]&&(e[n]+"").indexOf("callSuper")>-1?t.prototype[n]=function(t){return function(){var i=this.constructor.superclass;this.constructor.superclass=r;var n=e[t].apply(this,arguments);if(this.constructor.superclass=i,"initialize"!==t)return n}}(n):t.prototype[n]=e[n],i&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function n(){}function o(e){for(var i=null,r=this;r.constructor.superclass;){var n=r.constructor.superclass.prototype[e];if(r[e]!==n){i=n;break}r=r.constructor.superclass.prototype}return i?arguments.length>1?i.apply(this,t.call(arguments,1)):i.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}s.util.createClass=function(){var i=null,s=t.call(arguments,0);function a(){this.initialize.apply(this,arguments)}"function"==typeof s[0]&&(i=s.shift()),a.superclass=i,a.subclasses=[],i&&(n.prototype=i.prototype,a.prototype=new n,i.subclasses.push(a));for(var h=0,c=s.length;h<c;h++)r(a,s[h],i);return a.prototype.initialize||(a.prototype.initialize=e),a.prototype.constructor=a,a.prototype.callSuper=o,a}}(),function(){var t="unknown";function e(t){var e,i,r=Array.prototype.slice.call(arguments,1),s=r.length;for(i=0;i<s;i++)if(e=n(t[r[i]]),!/^(?:function|object|unknown)$/.test(e))return!1;return!0}var i,r,o,a,h=(o=0,function(t){return t.__uniqueID||(t.__uniqueID="uniqueID__"+o++)});function c(t,e){return{handler:e,wrappedHandler:function(t,e){return function(r){e.call(i(t),r||s.window.event)}}(t,e)}}a={},i=function(t){return a[t]},r=function(t,e){a[t]=e};var l,u,f=e(s.document.documentElement,"addEventListener","removeEventListener")&&e(s.window,"addEventListener","removeEventListener"),d=e(s.document.documentElement,"attachEvent","detachEvent")&&e(s.window,"attachEvent","detachEvent"),g={},p={};f?(l=function(t,e,i,r){t&&t.addEventListener(e,i,!d&&r)},u=function(t,e,i,r){t&&t.removeEventListener(e,i,!d&&r)}):d?(l=function(t,e,i){if(t){var n=h(t);r(n,t),g[n]||(g[n]={}),g[n][e]||(g[n][e]=[]);var s=c(n,i);g[n][e].push(s),t.attachEvent("on"+e,s.wrappedHandler)}},u=function(t,e,i){if(t){var r,n=h(t);if(g[n]&&g[n][e])for(var s=0,o=g[n][e].length;s<o;s++)(r=g[n][e][s])&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),g[n][e][s]=null)}}):(l=function(t,e,i){if(t){var r=h(t);if(p[r]||(p[r]={}),!p[r][e]){p[r][e]=[];var n=t["on"+e];n&&p[r][e].push(n),t["on"+e]=function(t,e){return function(i){if(p[t]&&p[t][e])for(var r=p[t][e],n=0,o=r.length;n<o;n++)r[n].call(this,i||s.window.event)}}(r,e)}p[r][e].push(i)}},u=function(t,e,i){if(t){var r=h(t);if(p[r]&&p[r][e])for(var n=p[r][e],s=0,o=n.length;s<o;s++)n[s]===i&&n.splice(s,1)}}),s.util.addListener=l,s.util.removeListener=u;var v=function(t){return t.clientX},m=function(t){return t.clientY};function _(t,e,i){var r,n=t["touchend"===t.type?"changedTouches":"touches"];return n&&n[0]&&(r=n[0][i]),void 0===r&&(r=t[i]),r}s.isTouchSupported&&(v=function(t){return _(t,0,"clientX")},m=function(t){return _(t,0,"clientY")}),s.util.getPointer=function(e){e||(e=s.window.event);var i=e.target||(n(e.srcElement)!==t?e.srcElement:null),r=s.util.getScrollLeftTop(i);return{x:v(e)+r.left,y:m(e)+r.top}}}(),function(){var t=s.document.createElement("div"),e="string"==typeof t.style.opacity,i="string"==typeof t.style.filter,r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(t){return t};e?n=function(t,e){return t.style.opacity=e,t}:i&&(n=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),r.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(r,e)):i.filter+=" alpha(opacity="+100*e+")",t}),s.util.setStyle=function(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?n(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)"opacity"===r?n(t,e[r]):i["float"===r||"cssFloat"===r?void 0===i.styleFloat?"cssFloat":"styleFloat":r]=e[r];return t}}(),function(){var t=Array.prototype.slice;var e,i,r=function(e){return t.call(e,0)};try{e=r(s.document.childNodes)instanceof Array}catch(t){}function n(t,e){var i=s.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function o(t){for(var e=0,i=0,r=s.document.documentElement,n=s.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===s.document?(e=n.scrollLeft||r.scrollLeft||0,i=n.scrollTop||r.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:i}}e||(r=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e}),i=s.document.defaultView&&s.document.defaultView.getComputedStyle?function(t,e){var i=s.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){var t=s.document.documentElement.style,e="userSelect"in t?"userSelect":"MozUserSelect"in t?"MozUserSelect":"WebkitUserSelect"in t?"WebkitUserSelect":"KhtmlUserSelect"in t?"KhtmlUserSelect":"";s.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=s.util.falseFunction),e?t.style[e]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},s.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),e?t.style[e]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}}(),function(){s.util.getScript=function(t,e){var i=s.document.getElementsByTagName("head")[0],r=s.document.createElement("script"),n=!0;r.onload=r.onreadystatechange=function(t){if(n){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;n=!1,e(t||s.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}}(),s.util.getById=function(t){return"string"==typeof t?s.document.getElementById(t):t},s.util.toArray=r,s.util.makeElement=n,s.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},s.util.wrapElement=function(t,e,i){return"string"==typeof e&&(e=n(e,i)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},s.util.getScrollLeftTop=o,s.util.getElementOffset=function(t){var e,r,n=t&&t.ownerDocument,s={left:0,top:0},a={left:0,top:0},h={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!n)return a;for(var c in h)a[h[c]]+=parseInt(i(t,c),10)||0;return e=n.documentElement,void 0!==t.getBoundingClientRect&&(s=t.getBoundingClientRect()),r=o(t),{left:s.left+r.left-(e.clientLeft||0)+a.left,top:s.top+r.top-(e.clientTop||0)+a.top}},s.util.getElementStyle=i,s.util.getNodeCanvas=function(t){var e=s.jsdomImplForWrapper(t);return e._canvas||e._image},s.util.cleanUpJsdomNode=function(t){if(s.isLikelyNode){var e=s.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){var t=function(){for(var t=[function(){return new s.window.XMLHttpRequest},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")}],e=t.length;e--;)try{if(t[e]())return t[e]}catch(t){}}();function e(){}s.util.request=function(i,r){r||(r={});var n=r.method?r.method.toUpperCase():"GET",s=r.onComplete||function(){},o=t(),a=r.body||r.parameters;return o.onreadystatechange=function(){4===o.readyState&&(s(o),o.onreadystatechange=e)},"GET"===n&&(a=null,"string"==typeof r.parameters&&(i=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(i,r.parameters))),o.open(n,i,!0),"POST"!==n&&"PUT"!==n||o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(a),o}}(),s.log=function(){},s.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){void 0!==console[t]&&"function"==typeof console[t].apply&&(s[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(){return!1}var e=s.window.requestAnimationFrame||s.window.webkitRequestAnimationFrame||s.window.mozRequestAnimationFrame||s.window.oRequestAnimationFrame||s.window.msRequestAnimationFrame||function(t){return s.window.setTimeout(t,1e3/60)},i=s.window.cancelAnimationFrame||s.window.clearTimeout;function r(){return e.apply(s.window,arguments)}s.util.animate=function(e){r(function(i){e||(e={});var n,s=i||+new Date,o=e.duration||500,a=s+o,h=e.onChange||t,c=e.abort||t,l=e.onComplete||t,u=e.easing||function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},f="startValue"in e?e.startValue:0,d="endValue"in e?e.endValue:100,g=e.byValue||d-f;e.onStart&&e.onStart(),function t(i){if(c())l(d,1,1);else{var p=(n=i||+new Date)>a?o:n-s,v=p/o,m=u(p,f,g,o),_=Math.abs((m-f)/g);h(m,_,v),n>a?e.onComplete&&e.onComplete():r(t)}}(s)})},s.util.requestAnimFrame=r,s.util.cancelAnimFrame=function(){return i.apply(s.window,arguments)}}(),function(){s.util.animateColor=function(t,e,i,r){var n=new s.Color(t).getSource(),o=new s.Color(e).getSource();r=r||{},s.util.animate(s.util.object.extend(r,{duration:i||500,startValue:n,endValue:o,byValue:o,easing:function(t,e,i,n){var s,o,a,h,c=r.colorEasing?r.colorEasing(t,n):1-Math.cos(t/n*(Math.PI/2));return s=e,o=i,a=c,h="rgba("+parseInt(s[0]+a*(o[0]-s[0]),10)+","+parseInt(s[1]+a*(o[1]-s[1]),10)+","+parseInt(s[2]+a*(o[2]-s[2]),10),h+=","+(s&&o?parseFloat(s[3]+a*(o[3]-s[3])):1),h+=")"}}))}}(),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=0===e&&0===t?i/(2*Math.PI)*Math.asin(1):i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function i(t,e,i,n){return i-r(n-t,0,i,n)+e}function r(t,e,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}s.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return(t/=r/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:function(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,r){return(t/=r/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,r){return i*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,r){return(t/=r/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,r){return i*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,r){return(t/=r/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,i,r){return t===r?e+i:i*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,i,r){return(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(i,r,n,s){var o=0;return 0===i?r:1==(i/=s)?r+n:(o||(o=.3*s),-e(t(n,n,o,1.70158),i,s)+r)},easeOutElastic:function(e,i,r,n){var s=0;if(0===e)return i;if(1==(e/=n))return i+r;s||(s=.3*n);var o=t(r,r,s,1.70158);return o.a*Math.pow(2,-10*e)*Math.sin((e*n-o.s)*(2*Math.PI)/o.p)+o.c+i},easeInOutElastic:function(i,r,n,s){var o=0;if(0===i)return r;if(2==(i/=s/2))return r+n;o||(o=s*(.3*1.5));var a=t(n,n,o,1.70158);return i<1?-.5*e(a,i,s)+r:a.a*Math.pow(2,-10*(i-=1))*Math.sin((i*s-a.s)*(2*Math.PI)/a.p)*.5+a.c+r},easeInBack:function(t,e,i,r,n){return void 0===n&&(n=1.70158),i*(t/=r)*t*((n+1)*t-n)+e},easeOutBack:function(t,e,i,r,n){return void 0===n&&(n=1.70158),i*((t=t/r-1)*t*((n+1)*t+n)+1)+e},easeInOutBack:function(t,e,i,r,n){return void 0===n&&(n=1.70158),(t/=r/2)<1?i/2*(t*t*((1+(n*=1.525))*t-n))+e:i/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e},easeInBounce:i,easeOutBounce:r,easeInOutBounce:function(t,e,n,s){return t<s/2?.5*i(2*t,0,n,s)+e:.5*r(2*t-s,0,n,s)+.5*n+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,n=e.util.toFixed,s=e.util.parseUnit,o=e.util.multiplyTransformMatrices,a={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity"},h={stroke:"strokeOpacity",fill:"fillOpacity"};function c(t){return t in a?a[t]:t}function l(t,i,r,n){var a,h="[object Array]"===Object.prototype.toString.call(i);if("fill"!==t&&"stroke"!==t||"none"!==i)if("strokeDashArray"===t)i="none"===i?null:i.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)});else if("transformMatrix"===t)i=r&&r.transformMatrix?o(r.transformMatrix,e.parseTransformAttribute(i)):e.parseTransformAttribute(i);else if("visible"===t)i="none"!==i&&"hidden"!==i,r&&!1===r.visible&&(i=!1);else if("opacity"===t)i=parseFloat(i),r&&void 0!==r.opacity&&(i*=r.opacity);else if("textAnchor"===t)i="start"===i?"left":"end"===i?"right":"center";else if("charSpacing"===t)a=s(i,n)/n*1e3;else if("paintFirst"===t){var c=i.indexOf("fill"),l=i.indexOf("stroke");i="fill";c>-1&&l>-1&&l<c?i="stroke":-1===c&&l>-1&&(i="stroke")}else a=h?i.map(s):s(i,n);else i="";return!h&&isNaN(a)?i:a}function u(t){return new RegExp("^("+t.join("|")+")\\b","i")}function f(t,e){var i,r,n,s,o=[];for(n=0,s=e.length;n<s;n++)i=e[n],r=t.getElementsByTagName(i),o=o.concat(Array.prototype.slice.call(r));return o}function d(t,e){var i,r=!0;return(i=g(t,e.pop()))&&e.length&&(r=function(t,e){var i,r=!0;for(;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=g(t,i);return 0===e.length}(t,e)),i&&r&&0===e.length}function g(t,e){var i,r,n=t.nodeName,s=t.getAttribute("class"),o=t.getAttribute("id");if(i=new RegExp("^"+n,"i"),e=e.replace(i,""),o&&e.length&&(i=new RegExp("#"+o+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),s&&e.length)for(r=(s=s.split(" ")).length;r--;)i=new RegExp("\\."+s[r]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"");return 0===e.length}function p(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var r,n,s,o=t.getElementsByTagName("*");for(n=0,s=o.length;n<s;n++)if(e===(r=o[n]).getAttribute("id"))return r}e.svgValidTagNamesRegEx=u(["path","circle","polygon","polyline","ellipse","rect","line","image","text","linearGradient","radialGradient","stop"]),e.svgViewBoxElementsRegEx=u(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=u(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=u(["symbol","g","a","svg"]),e.cssRules={},e.gradientDefs={},e.parseTransformAttribute=function(){function t(t,i,r){t[r]=Math.tan(e.util.degreesToRadians(i[0]))}var i=[1,0,0,1,0,0],r=e.reNum,n="(?:\\s+,?\\s*|,\\s*)",s="(?:"+("(?:(matrix)\\s*\\(\\s*("+r+")"+n+"("+r+")"+n+"("+r+")"+n+"("+r+")"+n+"("+r+")"+n+"("+r+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+r+")(?:"+n+"("+r+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+r+")(?:"+n+"("+r+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+r+")(?:"+n+"("+r+")"+n+"("+r+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+r+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+r+")\\s*\\))")+")",o=new RegExp("^\\s*(?:"+("(?:"+s+"(?:"+n+"*"+s+")*)")+"?)\\s*$"),a=new RegExp(s,"g");return function(r){var n=i.concat(),h=[];if(!r||r&&!o.test(r))return n;r.replace(a,function(r){var o=new RegExp(s).exec(r).filter(function(t){return!!t}),a=o[1],c=o.slice(2).map(parseFloat);switch(a){case"translate":!function(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}(n,c);break;case"rotate":c[0]=e.util.degreesToRadians(c[0]),function(t,i){var r=e.util.cos(i[0]),n=e.util.sin(i[0]),s=0,o=0;3===i.length&&(s=i[1],o=i[2]),t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=s-(r*s-n*o),t[5]=o-(n*s+r*o)}(n,c);break;case"scale":!function(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}(n,c);break;case"skewX":t(n,c,2);break;case"skewY":t(n,c,1);break;case"matrix":n=c}h.push(n.concat()),n=i.concat()});for(var c=h[0];h.length>1;)h.shift(),c=e.util.multiplyTransformMatrices(c,h[0]);return c}}();var v=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function m(t){var i,r,n,o,a,h,c=t.getAttribute("viewBox"),l=1,u=1,f=t.getAttribute("width"),d=t.getAttribute("height"),g=t.getAttribute("x")||0,p=t.getAttribute("y")||0,m=t.getAttribute("preserveAspectRatio")||"",_=!c||!e.svgViewBoxElementsRegEx.test(t.nodeName)||!(c=c.match(v)),y=!f||!d||"100%"===f||"100%"===d,x=_&&y,b={},C="",S=0,T=0;if(b.width=0,b.height=0,b.toBeParsed=x,x)return b;if(_)return b.width=s(f),b.height=s(d),b;if(i=-parseFloat(c[1]),r=-parseFloat(c[2]),n=parseFloat(c[3]),o=parseFloat(c[4]),y?(b.width=n,b.height=o):(b.width=s(f),b.height=s(d),l=b.width/n,u=b.height/o),"none"!==(m=e.util.parsePreserveAspectRatioAttribute(m)).alignX&&("meet"===m.meetOrSlice&&(u=l=l>u?u:l),"slice"===m.meetOrSlice&&(u=l=l>u?l:u),S=b.width-n*l,T=b.height-o*l,"Mid"===m.alignX&&(S/=2),"Mid"===m.alignY&&(T/=2),"Min"===m.alignX&&(S=0),"Min"===m.alignY&&(T=0)),1===l&&1===u&&0===i&&0===r&&0===g&&0===p)return b;if((g||p)&&(C=" translate("+s(g)+" "+s(p)+") "),a=C+" matrix("+l+" 0 0 "+u+" "+(i*l+S)+" "+(r*u+T)+") ","svg"===t.nodeName){for(h=t.ownerDocument.createElement("g");t.firstChild;)h.appendChild(t.firstChild);t.appendChild(h)}else a=(h=t).getAttribute("transform")+a;return h.setAttribute("transform",a),b}e.parseSVGDocument=function(t,i,n,s){if(t){!function(t){for(var e=f(t,["use","svg:use"]),i=0;e.length&&i<e.length;){var r,n,s,o,a=e[i],h=(a.getAttribute("xlink:href")||a.getAttribute("href")).substr(1),c=a.getAttribute("x")||0,l=a.getAttribute("y")||0,u=p(t,h).cloneNode(!0),d=(u.getAttribute("transform")||"")+" translate("+c+", "+l+")",g=e.length;if(m(u),/^svg$/i.test(u.nodeName)){var v=u.ownerDocument.createElement("g");for(n=0,o=(s=u.attributes).length;n<o;n++)r=s.item(n),v.setAttribute(r.nodeName,r.nodeValue);for(;u.firstChild;)v.appendChild(u.firstChild);u=v}for(n=0,o=(s=a.attributes).length;n<o;n++)"x"!==(r=s.item(n)).nodeName&&"y"!==r.nodeName&&"xlink:href"!==r.nodeName&&"href"!==r.nodeName&&("transform"===r.nodeName?d=r.nodeValue+" "+d:u.setAttribute(r.nodeName,r.nodeValue));u.setAttribute("transform",d),u.setAttribute("instantiated_by_use","1"),u.removeAttribute("id"),a.parentNode.replaceChild(u,a),e.length===g&&i++}}(t);var o,a,h=e.Object.__uid++,c=m(t),l=e.util.toArray(t.getElementsByTagName("*"));if(c.crossOrigin=s&&s.crossOrigin,c.svgUid=h,0===l.length&&e.isLikelyNode){var u=[];for(o=0,a=(l=t.selectNodes('//*[name(.)!="svg"]')).length;o<a;o++)u[o]=l[o];l=u}var d=l.filter(function(t){return m(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)});!d||d&&!d.length?i&&i([],{}):(e.gradientDefs[h]=e.getGradientDefs(t),e.cssRules[h]=e.getCSSRules(t),e.parseElements(d,function(t,e){i&&i(t,c,e,l)},r(c),n,s))}};var _=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");i(e,{parseFontDeclaration:function(t,e){var i=t.match(_);if(i){var r=i[1],n=i[3],o=i[4],a=i[5],h=i[6];r&&(e.fontStyle=r),n&&(e.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),o&&(e.fontSize=s(o)),h&&(e.fontFamily=h),a&&(e.lineHeight="normal"===a?1:a)}},getGradientDefs:function(t){var e,i,r,n=f(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),s=0,o={},a={};for(s=n.length;s--;)r=(e=n[s]).getAttribute("xlink:href"),i=e.getAttribute("id"),r&&(a[i]=r.substr(1)),o[i]=e;for(i in a){var h=o[a[i]].cloneNode(!0);for(e=o[i];h.firstChild;)e.appendChild(h.firstChild)}return o},parseAttributes:function(t,r,s){if(t){var o,a,u={};void 0===s&&(s=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(u=e.parseAttributes(t.parentNode,r,s)),a=u&&u.fontSize||t.getAttribute("font-size")||e.Text.DEFAULT_SVG_FONT_SIZE;var f=r.reduce(function(e,i){return(o=t.getAttribute(i))&&(e[i]=o),e},{});f=i(f,i(function(t,i){var r={};for(var n in e.cssRules[i])if(d(t,n.split(" ")))for(var s in e.cssRules[i][n])r[s]=e.cssRules[i][n][s];return r}(t,s),e.parseStyleAttribute(t)));var g,p,v={};for(var m in f)p=l(g=c(m),f[m],u,a),v[g]=p;v&&v.font&&e.parseFontDeclaration(v.font,v);var _=i(u,v);return e.svgValidParentsRegEx.test(t.nodeName)?_:function(t){for(var i in h)if(void 0!==t[h[i]]&&""!==t[i]){if(void 0===t[i]){if(!e.Object.prototype[i])continue;t[i]=e.Object.prototype[i]}if(0!==t[i].indexOf("url(")){var r=new e.Color(t[i]);t[i]=r.setAlpha(n(r.getAlpha()*t[h[i]],2)).toRgba()}}return t}(_)}},parseElements:function(t,i,r,n,s){new e.ElementsParser(t,i,r,n,s).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?function(t,e){var i,r;t.replace(/;\s*$/,"").split(";").forEach(function(t){var n=t.split(":");i=n[0].trim().toLowerCase(),r=n[1].trim(),e[i]=r})}(i,e):function(t,e){var i,r;for(var n in t)void 0!==t[n]&&(i=n.toLowerCase(),r=t[n],e[i]=r)}(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;var e,i,r=[];for(e=0,i=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<i;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){var i,r,n=t.getElementsByTagName("style"),s={};for(i=0,r=n.length;i<r;i++){var o=n[i].textContent||n[i].text;""!==(o=o.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&o.match(/[^{]*\{[\s\S]*?\}/g).map(function(t){return t.trim()}).forEach(function(t){var n=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),o={},a=n[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(i=0,r=a.length;i<r;i++){var h=a[i].split(/\s*:\s*/),c=h[0],l=h[1];o[c]=l}(t=n[1]).split(",").forEach(function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(s[t]?e.util.object.extend(s[t],o):s[t]=e.util.object.clone(o))})})}return s},loadSVGFromURL:function(t,i,r,n){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var s=t.responseXML;s&&!s.documentElement&&e.window.ActiveXObject&&t.responseText&&((s=new ActiveXObject("Microsoft.XMLDOM")).async="false",s.loadXML(t.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));s&&s.documentElement||i&&i(null);e.parseSVGDocument(s.documentElement,function(t,e,r,n){i&&i(t,e,r,n)},r,n)}})},loadSVGFromString:function(t,i,r,n){var s;if(t=t.trim(),"undefined"!=typeof DOMParser){var o=new DOMParser;o&&o.parseFromString&&(s=o.parseFromString(t,"text/xml"))}else e.window.ActiveXObject&&((s=new ActiveXObject("Microsoft.XMLDOM")).async="false",s.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));e.parseSVGDocument(s.documentElement,function(t,e,r,n){i(t,e,r,n)},r,n)}})}("undefined"!=typeof exports?exports:this),s.ElementsParser=function(t,e,i,r,n){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g},s.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},s.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;t<e;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},s.ElementsParser.prototype.createObject=function(t,e){var i=s[s.util.string.capitalize(t.tagName.replace("svg:",""))];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(t){s.log(t)}else this.checkIfDone()},s.ElementsParser.prototype._createObject=function(t,e,i){t.fromElement(e,this.createCallback(i,e),this.options)},s.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){var n;i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),r instanceof s.Image&&(n=r.parsePreserveAspectRatioAttribute(e)),r._removeTransformMatrix(n),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},s.ElementsParser.prototype.resolveGradient=function(t,e){var i=t[e];if(/^url\(/.test(i)){var r=this.regexUrl.exec(i)[1];this.regexUrl.lastIndex=0,s.gradientDefs[this.svgUid][r]&&t.set(e,s.Gradient.fromElement(s.gradientDefs[this.svgUid][r],t))}},s.ElementsParser.prototype.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances,this.elements))},function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=i,i.prototype={type:"point",constructor:i,add:function(t){return new i(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new i(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new i(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new i(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new i(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new i(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new i(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new i(this.x,this.y)}})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=i,e.Intersection.prototype={constructor:i,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,r,n,s){var o,a=(s.x-n.x)*(t.y-n.y)-(s.y-n.y)*(t.x-n.x),h=(r.x-t.x)*(t.y-n.y)-(r.y-t.y)*(t.x-n.x),c=(s.y-n.y)*(r.x-t.x)-(s.x-n.x)*(r.y-t.y);if(0!==c){var l=a/c,u=h/c;0<=l&&l<=1&&0<=u&&u<=1?(o=new i("Intersection")).appendPoint(new e.Point(t.x+l*(r.x-t.x),t.y+l*(r.y-t.y))):o=new i}else o=new i(0===a||0===h?"Coincident":"Parallel");return o},e.Intersection.intersectLinePolygon=function(t,e,r){var n,s,o,a,h=new i,c=r.length;for(a=0;a<c;a++)n=r[a],s=r[(a+1)%c],o=i.intersectLineLine(t,e,n,s),h.appendPoints(o.points);return h.points.length>0&&(h.status="Intersection"),h},e.Intersection.intersectPolygonPolygon=function(t,e){var r,n=new i,s=t.length;for(r=0;r<s;r++){var o=t[r],a=t[(r+1)%s],h=i.intersectLinePolygon(o,a,e);n.appendPoints(h.points)}return n.points.length>0&&(n.status="Intersection"),n},e.Intersection.intersectPolygonRectangle=function(t,r,n){var s=r.min(n),o=r.max(n),a=new e.Point(o.x,s.y),h=new e.Point(s.x,o.y),c=i.intersectLinePolygon(s,a,t),l=i.intersectLinePolygon(a,o,t),u=i.intersectLinePolygon(o,h,t),f=i.intersectLinePolygon(h,s,t),d=new i;return d.appendPoints(c.points),d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function r(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=i,e.Color.prototype={_tryParsingColor:function(t){var e;t in i.colorNameMap&&(t=i.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=i.sourceFromHex(t)),e||(e=i.sourceFromRgb(t)),e||(e=i.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,i,r){t/=255,i/=255,r/=255;var n,s,o,a=e.util.array.max([t,i,r]),h=e.util.array.min([t,i,r]);if(o=(a+h)/2,a===h)n=s=0;else{var c=a-h;switch(s=o>.5?c/(2-a-h):c/(a+h),a){case t:n=(i-r)/c+(i<r?6:0);break;case i:n=(r-t)/c+2;break;case r:n=(t-i)/c+4}n/=6}return[Math.round(360*n),Math.round(100*s),Math.round(100*o)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=1===(t=r[0].toString(16)).length?"0"+t:t,e=1===(e=r[1].toString(16)).length?"0"+e:e,i=1===(i=r[2].toString(16)).length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof i||(t=new i(t));var e,r=[],n=this.getAlpha(),s=this.getSource(),o=t.getSource();for(e=0;e<3;e++)r.push(Math.round(.5*s[e]+.5*o[e]));return r[3]=n,this.setSource(r),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return i.fromSource(i.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(i.reRGBa);if(e){var r=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),n=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),s=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(r,10),parseInt(n,10),parseInt(s,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=i.fromRgb,e.Color.fromHsl=function(t){return i.fromSource(i.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(i.reHSLa);if(e){var n,s,o,a=(parseFloat(e[1])%360+360)%360/360,h=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===h)n=s=o=c;else{var l=c<=.5?c*(h+1):c+h-c*h,u=2*c-l;n=r(u,l,a+1/3),s=r(u,l,a),o=r(u,l,a-1/3)}return[Math.round(255*n),Math.round(255*s),Math.round(255*o),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=i.fromHsl,e.Color.fromHex=function(t){return i.fromSource(i.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(i.reHex)){var e=t.slice(t.indexOf("#")+1),r=3===e.length||4===e.length,n=8===e.length||4===e.length,s=r?e.charAt(0)+e.charAt(0):e.substring(0,2),o=r?e.charAt(1)+e.charAt(1):e.substring(2,4),a=r?e.charAt(2)+e.charAt(2):e.substring(4,6),h=n?r?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(s,16),parseInt(o,16),parseInt(a,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new i;return e.setSource(t),e})}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,r,n,o=t.getAttribute("style"),a=t.getAttribute("offset")||0;if(a=(a=parseFloat(a)/(/%$/.test(a)?100:1))<0?0:a>1?1:a,o){var h=o.split(/\s*;\s*/);for(""===h[h.length-1]&&h.pop(),n=h.length;n--;){var c=h[n].split(/\s*:\s*/),l=c[0].trim(),u=c[1].trim();"stop-color"===l?e=u:"stop-opacity"===l&&(r=u)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),i=(e=new s.Color(e)).getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:a,color:e.toRgb(),opacity:r}}var e=s.util.object.clone;function i(t,e,i){var r,n=0,s=1,o="";for(var a in e)"Infinity"===e[a]?e[a]=1:"-Infinity"===e[a]&&(e[a]=0),r=parseFloat(e[a],10),s="string"==typeof e[a]&&/^(\d+\.\d+)%|(\d+)%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(s*="objectBoundingBox"===i?t.width:1,n="objectBoundingBox"===i&&t.left||0):"y1"!==a&&"y2"!==a||(s*="objectBoundingBox"===i?t.height:1,n="objectBoundingBox"===i&&t.top||0),e[a]=r*s+n;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var h=t.ry/t.rx;o=" scale(1, "+h+")",e.y1&&(e.y1/=h),e.y2&&(e.y2/=h)}return o}s.Gradient=s.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=s.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new s.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return s.util.populateWithProperties(this,e,t),e},toSVG:function(t){var i,r,n,s,o=e(this.coords,!0),a=e(this.colorStops,!0),h=o.r1>o.r2,c=t.width/2,l=t.height/2;for(var u in a.sort(function(t,e){return t.offset-e.offset}),"path"===t.type&&(c-=t.pathOffset.x,l-=t.pathOffset.y),o)"x1"===u||"x2"===u?o[u]+=this.offsetX-c:"y1"!==u&&"y2"!==u||(o[u]+=this.offsetY-l);if(s='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(s+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?n=["<linearGradient ",s,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'">\n']:"radial"===this.type&&(n=["<radialGradient ",s,' cx="',h?o.x1:o.x2,'" cy="',h?o.y1:o.y2,'" r="',h?o.r1:o.r2,'" fx="',h?o.x2:o.x1,'" fy="',h?o.y2:o.y1,'">\n']),"radial"===this.type){if(h)for((a=a.concat()).reverse(),i=0,r=a.length;i<r;i++)a[i].offset=1-a[i].offset;var f=Math.min(o.r1,o.r2);if(f>0){var d=f/Math.max(o.r1,o.r2);for(i=0,r=a.length;i<r;i++)a[i].offset+=d*(1-a[i].offset)}}for(i=0,r=a.length;i<r;i++){var g=a[i];n.push("<stop ",'offset="',100*g.offset+"%",'" style="stop-color:',g.color,void 0!==g.opacity?";stop-opacity: "+g.opacity:";",'"/>\n')}return n.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),n.join("")},toLive:function(t){var e,i,r,n=s.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(n.x1,n.y1,n.x2,n.y2):"radial"===this.type&&(e=t.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2)),i=0,r=this.colorStops.length;i<r;i++){var o=this.colorStops[i].color,a=this.colorStops[i].opacity,h=this.colorStops[i].offset;void 0!==a&&(o=new s.Color(o).setAlpha(a).toRgba()),e.addColorStop(h,o)}return e}}}),s.util.object.extend(s.Gradient,{fromElement:function(e,r){var n,o,a,h,c=e.getElementsByTagName("stop"),l=e.getAttribute("gradientUnits")||"objectBoundingBox",u=e.getAttribute("gradientTransform"),f=[];for("linear"===(n="linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?"linear":"radial")?o=function(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}(e):"radial"===n&&(o=function(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}(e)),h=c.length;h--;)f.push(t(c[h]));a=i(r,o,l);var d=new s.Gradient({type:n,coords:o,colorStops:f,offsetX:-r.left,offsetY:-r.top});return(u||""!==a)&&(d.gradientTransform=s.parseTransformAttribute((u||"")+a)),d},forObject:function(t,e){return e||(e={}),i(t,e.coords,"userSpaceOnUse"),new s.Gradient(e)}})}(),function(){"use strict";var t=s.util.toFixed;s.Pattern=s.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=s.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)e&&e(this);else if(void 0!==s.util.getFunctionBody(t.source))this.source=new Function(s.util.getFunctionBody(t.source)),e&&e(this);else{var i=this;this.source=s.util.createImage(),s.util.loadImage(t.source,function(t){i.source=t,e&&e(i)},null,this.crossOrigin)}},toObject:function(e){var i,r,o=s.Object.NUM_FRACTION_DIGITS;return"function"==typeof this.source?i=String(this.source):"string"==typeof this.source.src?i=this.source.src:"object"===n(this.source)&&this.source.toDataURL&&(i=this.source.toDataURL()),r={type:"pattern",source:i,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,o),offsetY:t(this.offsetY,o),patternTransform:this.patternTransform?this.patternTransform.concat():null},s.util.populateWithProperties(this,r,e),r},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.width,r=e.height/t.height,n=this.offsetX/t.width,s=this.offsetY/t.height,o="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(r=1,s&&(r+=Math.abs(s))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,n&&(i+=Math.abs(n))),e.src?o=e.src:e.toDataURL&&(o=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+s+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+o+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){for(var i in"string"==typeof t&&(t=this._parseShadow(t)),t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[];return{color:(i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var r=40,n=40,s=e.Object.NUM_FRACTION_DIGITS,o=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),a=new e.Color(this.color);return t.width&&t.height&&(r=100*i((Math.abs(o.x)+this.blur)/t.width,s)+20,n=100*i((Math.abs(o.y)+this.blur)/t.height,s)+20),t.flipX&&(o.x*=-1),t.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+i(this.blur?this.blur/2:0,s)+'"></feGaussianBlur>\n\t<feOffset dx="'+i(o.x,s)+'" dy="'+i(o.y,s)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+a.toRgb()+'" flood-opacity="'+a.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke};var t={},i=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke"].forEach(function(e){this[e]!==i[e]&&(t[e]=this[e])},this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)}("undefined"!=typeof exports?exports:this),function(){"use strict";if(s.StaticCanvas)s.warn("fabric.StaticCanvas is already defined.");else{var t=s.util.object.extend,e=s.util.getElementOffset,i=s.util.removeFromArray,r=s.util.toFixed,n=s.util.transformPoint,o=s.util.invertTransform,a=new Error("Could not initialize `canvas` element");s.StaticCanvas=s.util.createClass(s.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:s.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,onBeforeScaleRotate:function(){},enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,_initStatic:function(t,e){var i=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,i),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,i),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,i),e.overlayColor&&this.setOverlayColor(e.overlayColor,i),this.calcOffset()},_isRetinaScaling:function(){return 1!==s.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?s.devicePixelRatio:1},_initRetinaScaling:function(){this._isRetinaScaling()&&(this.lowerCanvasEl.setAttribute("width",this.width*s.devicePixelRatio),this.lowerCanvasEl.setAttribute("height",this.height*s.devicePixelRatio),this.contextContainer.scale(s.devicePixelRatio,s.devicePixelRatio))},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?s.util.loadImage(e,function(e){e&&(this[t]=new s.Image(e,r)),i&&i(e)},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i(e)),this},__setBgOverlayColor:function(t,e,i){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,i),this},_createCanvasElement:function(){var t=s.util.createCanvasElement();if(!t)throw a;if(t.style||(t.style={}),void 0===t.getContext)throw a;return t},_initOptions:function(t){this._setOptions(t),this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=s.util.getById(t)||this._createCanvasElement(),s.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;for(var r in e=e||{},t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(r,i);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this._setImageSmoothing(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,i,r,n=this._activeObject;for(this.viewportTransform=t,i=0,r=this._objects.length;i<r;i++)(e=this._objects[i]).group||e.setCoords(!1,!0);return n&&"activeSelection"===n.type&&n.setCoords(!1,!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var i=t,r=this.viewportTransform.slice(0);t=n(t,o(this.viewportTransform)),r[0]=e,r[3]=e;var s=n(t,r);return r[4]+=i.x-s.x,r[5]+=i.y-s.y,this.setViewportTransform(r)},setZoom:function(t){return this.zoomToPoint(new s.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new s.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=s.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,i=this.height,r=o(this.viewportTransform);return t.tl=n({x:0,y:0},r),t.br=n({x:e,y:i},r),t.tr=new s.Point(t.br.x,t.tl.y),t.bl=new s.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(s.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var i=this.viewportTransform;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),this.fire("before:render"),this.clipTo&&s.util.clipContext(this,t),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.clipTo&&t.restore(),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render")},_renderObjects:function(t,e){var i,r;for(i=0,r=e.length;i<r;++i)e[i]&&e[i].render(t)},_renderBackgroundOrOverlay:function(t,e){var i,r=this[e+"Color"];r&&(t.fillStyle=r.toLive?r.toLive(t,this):r,t.fillRect(r.offsetX||0,r.offsetY||0,this.width,this.height)),(r=this[e+"Image"])&&(this[e+"Vpt"]&&(i=this.viewportTransform,t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5])),r.render(t),this[e+"Vpt"]&&t.restore())},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new s.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new s.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new s.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new s.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new s.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=o(this.viewportTransform);return n({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={version:s.version,objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay(e,i)),s.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this._objects.filter(function(t){return!t.excludeFromExport}).map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var n=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),n},__serializeBgOverlay:function(t,e){var i={},r=this.backgroundImage,n=this.overlayImage;return this.backgroundColor&&(i.background=this.backgroundColor.toObject?this.backgroundColor.toObject(e):this.backgroundColor),this.overlayColor&&(i.overlay=this.overlayColor.toObject?this.overlayColor.toObject(e):this.overlayColor),r&&!r.excludeFromExport&&(i.backgroundImage=this._toObject(r,t,e)),n&&!n.excludeFromExport&&(i.overlayImage=this._toObject(n,t,e)),i},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,n=e.width||this.width,o=e.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',h=s.Object.NUM_FRACTION_DIGITS;e.viewBox?a='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(i=this.viewportTransform,a='viewBox="'+r(-i[4]/i[0],h)+" "+r(-i[5]/i[3],h)+" "+r(this.width/i[0],h)+" "+r(this.height/i[3],h)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',o,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",s.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),"</defs>\n")},createSVGRefElementsMarkup:function(){var t=this;return["backgroundColor","overlayColor"].map(function(e){var i=t[e];if(i&&i.toLive)return i.toSVG(t,!1)}).join("")},createSVGFontFacesMarkup:function(){var t,e,i,r,n,o,a,h,c="",l={},u=s.fontPaths,f=this._objects;for(a=0,h=f.length;a<h;a++)if(e=(t=f[a]).fontFamily,-1!==t.type.indexOf("text")&&!l[e]&&u[e]&&(l[e]=!0,t.styles))for(n in i=t.styles)for(o in r=i[n])!l[e=r[o].fontFamily]&&u[e]&&(l[e]=!0);for(var d in l)c+=["\t\t@font-face {\n","\t\t\tfont-family: '",d,"';\n","\t\t\tsrc: url('",u[d],"');\n","\t\t}\n"].join("");return c&&(c=['\t<style type="text/css">',"<![CDATA[\n",c,"]]>","</style>\n"].join("")),c},_setSVGObjects:function(t,e){var i,r,n,s=this._objects;for(r=0,n=s.length;r<n;r++)(i=s[r]).excludeFromExport||this._setSVGObject(t,i,e)},_setSVGObject:function(t,e,i){t.push(e.toSVG(i))},_setSVGBgOverlayImage:function(t,e,i){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(i))},_setSVGBgOverlayColor:function(t,e){var i=this[e],r=this.viewportTransform,n=this.width/r[0],s=this.height/r[3];if(i)if(i.toLive){var o=i.repeat;t.push('<rect transform="translate(',n/2,",",s/2,')"',' x="',i.offsetX-n/2,'" y="',i.offsetY-s/2,'" ','width="',"repeat-y"===o||"no-repeat"===o?i.source.width:n,'" height="',"repeat-x"===o||"no-repeat"===o?i.source.height:s,'" fill="url(#SVGID_'+i.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',this[e],'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,r,n,s=this._activeObject;if(t===s&&"activeSelection"===t.type)for(e=(n=s._objects).length;e--;)r=n[e],i(this._objects,r),this._objects.unshift(r);else i(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,r,n,s=this._activeObject;if(t===s&&"activeSelection"===t.type)for(n=s._objects,e=0;e<n.length;e++)r=n[e],i(this._objects,r),this._objects.push(r);else i(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var r,n,s,o,a,h=this._activeObject,c=0;if(t===h&&"activeSelection"===t.type)for(a=h._objects,r=0;r<a.length;r++)n=a[r],(s=this._objects.indexOf(n))>0+c&&(o=s-1,i(this._objects,n),this._objects.splice(o,0,n)),c++;else 0!==(s=this._objects.indexOf(t))&&(o=this._findNewLowerIndex(t,s,e),i(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,i){var r,n;if(i)for(r=e,n=e-1;n>=0;--n){if(t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t)){r=n;break}}else r=e-1;return r},bringForward:function(t,e){if(!t)return this;var r,n,s,o,a,h=this._activeObject,c=0;if(t===h&&"activeSelection"===t.type)for(r=(a=h._objects).length;r--;)n=a[r],(s=this._objects.indexOf(n))<this._objects.length-1-c&&(o=s+1,i(this._objects,n),this._objects.splice(o,0,n)),c++;else(s=this._objects.indexOf(t))!==this._objects.length-1&&(o=this._findNewUpperIndex(t,s,e),i(this._objects,t),this._objects.splice(o,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,i){var r,n,s;if(i)for(r=e,n=e+1,s=this._objects.length;n<s;++n){if(t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t)){r=n;break}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(s.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(t){t.dispose&&t.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,s.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(s.StaticCanvas.prototype,s.Observable),t(s.StaticCanvas.prototype,s.Collection),t(s.StaticCanvas.prototype,s.DataURLExporter),t(s.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=s.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return void 0!==i.getImageData;case"setLineDash":return void 0!==i.setLineDash;case"toDataURL":return void 0!==e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(t){}return!1;default:return null}}}),s.StaticCanvas.prototype.toJSON=s.StaticCanvas.prototype.toObject,s.isLikelyNode&&(s.StaticCanvas.prototype.createPNGStream=function(){var t=s.util.getNodeCanvas(this.lowerCanvasEl);return t&&t.createPNGStream()},s.StaticCanvas.prototype.createJPEGStream=function(t){var e=s.util.getNodeCanvas(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),s.BaseBrush=s.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,setShadow:function(t){return this.shadow=new s.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,s.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop,e=this.canvas.getZoom();t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*e,t.shadowOffsetX=this.shadow.offsetX*e,t.shadowOffsetY=this.shadow.offsetY*e}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),s.PencilBrush=s.util.createClass(s.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},_drawSegment:function(t,e,i){var r=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,r.x,r.y),r},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){if(this._captureDrawingPath(t)&&this._points.length>1)if(this.needsFullRender)this.canvas.clearContext(this.canvas.contextTop),this._render();else{var e=this._points,i=e.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,e[i-2],e[i-1],!0),r.stroke(),r.restore()}},onMouseUp:function(){this.oldEnd=void 0,this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new s.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1])||(this._points.push(t),0))},_reset:function(){this._points.length=0,this._setBrushStyles();var t=new s.Color(this.color);this.needsFullRender=t.getAlpha()<1,this._setShadow()},_captureDrawingPath:function(t){var e=new s.Point(t.x,t.y);return this._addPoint(e)},_render:function(){var t,e,i=this.canvas.contextTop,r=this._points[0],n=this._points[1];if(this._saveAndTransform(i),i.beginPath(),2===this._points.length&&r.x===n.x&&r.y===n.y){var o=this.width/1e3;r=new s.Point(r.x,r.y),n=new s.Point(n.x,n.y),r.x-=o,n.x+=o}for(i.moveTo(r.x,r.y),t=1,e=this._points.length;t<e;t++)this._drawSegment(i,r,n),r=this._points[t],n=this._points[t+1];i.lineTo(r.x,r.y),i.stroke(),i.restore()},convertPointsToSVGPath:function(t){var e,i=[],r=this.width/1e3,n=new s.Point(t[0].x,t[0].y),o=new s.Point(t[1].x,t[1].y),a=t.length,h=1,c=1,l=a>2;for(l&&(h=t[2].x<o.x?-1:t[2].x===o.x?0:1,c=t[2].y<o.y?-1:t[2].y===o.y?0:1),i.push("M ",n.x-h*r," ",n.y-c*r," "),e=1;e<a;e++){if(!n.eq(o)){var u=n.midPointFrom(o);i.push("Q ",n.x," ",n.y," ",u.x," ",u.y," ")}n=t[e],e+1<t.length&&(o=t[e+1])}return l&&(h=n.x>t[e-2].x?1:n.x===t[e-2].x?0:-1,c=n.y>t[e-2].y?1:n.y===t[e-2].y?0:-1),i.push("L ",n.x+h*r," ",n.y+c*r),i},createPath:function(t){var e=new s.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray}),i=new s.Point(e.left+e.width/2,e.top+e.height/2);return i=e.translateToGivenOrigin(i,"center","center",e.originX,e.originY),e.top=i.y,e.left=i.x,this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath();var t=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"!==t){var e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.add(e),this.canvas.renderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}else this.canvas.requestRenderAll()}}),s.CircleBrush=s.util.createClass(s.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;this._saveAndTransform(i),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,i,r=this.canvas.contextTop,n=this.points;for(this._saveAndTransform(r),t=0,e=n.length;t<e;t++)i=n[t],r.fillStyle=i.fill,r.beginPath(),r.arc(i.x,i.y,i.radius,0,2*Math.PI,!1),r.closePath(),r.fill();r.restore()},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t,e,i=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var r=[];for(t=0,e=this.points.length;t<e;t++){var n=this.points[t],o=new s.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&o.setShadow(this.shadow),r.push(o)}var a=new s.Group(r);a.canvas=this.canvas,this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=i,this.canvas.requestRenderAll()},addPoint:function(t){var e=new s.Point(t.x,t.y),i=s.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new s.Color(this.color).setAlpha(s.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),s.SprayBrush=s.util.createClass(s.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;i<r;i++)for(var n=this.sprayChunks[i],o=0,a=n.length;o<a;o++){var h=new s.Rect({width:n[o].width,height:n[o].width,left:n[o].x+1,top:n[o].y+1,originX:"center",originY:"center",fill:this.color});e.push(h)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var c=new s.Group(e);this.shadow&&c.setShadow(this.shadow),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,i,r,n={};for(i=0,r=t.length;i<r;i++)n[e=t[i].left+""+t[i].top]||(n[e]=t[i]);var s=[];for(e in n)s.push(n[e]);return s},render:function(t){var e,i,r=this.canvas.contextTop;for(r.fillStyle=this.color,this._saveAndTransform(r),e=0,i=t.length;e<i;e++){var n=t[e];void 0!==n.opacity&&(r.globalAlpha=n.opacity),r.fillRect(n.x,n.y,n.width,n.width)}r.restore()},_render:function(){var t,e,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);i.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,i,r,n,o=this.width/2;for(n=0;n<this.density;n++){e=s.util.getRandomInt(t.x-o,t.x+o),i=s.util.getRandomInt(t.y-o,t.y+o),r=this.dotWidthVariance?s.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new s.Point(e,i);a.width=r,this.randomOpacity&&(a.opacity=s.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),s.PatternBrush=s.util.createClass(s.PencilBrush,{getPatternSrc:function(){var t=s.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),i=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new s.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),e}}),function(){var t=s.util.getPointer,e=s.util.degreesToRadians,i=s.util.radiansToDegrees,r=Math.atan2,n=Math.abs,o=s.StaticCanvas.supports("setLineDash");for(var a in s.Canvas=s.util.createClass(s.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniScaleTransform:!1,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=s.PencilBrush&&new s.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,i,r=this.getActiveObjects();if(r.length>0&&!this.preserveObjectStacking){e=[],i=[];for(var n=0,s=this._objects.length;n<s;n++)t=this._objects[n],-1===r.indexOf(t)?e.push(t):i.push(t);r.length>1&&(this._activeObject._objects=i),e.push.apply(e,i)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){this.isDrawingMode&&this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.selection&&this._groupSelector&&this._drawSelection(t)},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this.contextTopDirty=!0,this},_resetCurrentTransform:function(){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,skewX:t.original.skewX,skewY:t.original.skewY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(t.target)?("center"!==t.originX&&("right"===t.originX?t.mouseXSign=-1:t.mouseXSign=1),"center"!==t.originY&&("bottom"===t.originY?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(t,e,i){var r,n=i||this.getPointer(t,!0);return r=e.group&&e.group===this._activeObject&&"activeSelection"===e.group.type?this._normalizePointer(e.group,n):{x:n.x,y:n.y},e.containsPoint(r)||e._findTargetCorner(n)},_normalizePointer:function(t,e){var i=t.calcTransformMatrix(),r=s.util.invertTransform(i),n=this.restorePointerVpt(e);return s.util.transformPoint(n,r)},isTargetTransparent:function(t,e,i){if(t.shouldCache()&&t._cacheCanvas){var r=this._normalizePointer(t,{x:e,y:i}),n=t.cacheTranslationX+r.x*t.zoomX,o=t.cacheTranslationY+r.y*t.zoomY;return s.util.isTransparent(t._cacheContext,n,o,this.targetFindTolerance)}var a=this.contextCache,h=t.selectionBackgroundColor,c=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),t.render(a),a.restore(),t===this._activeObject&&t._renderControls(a,{hasBorders:!1,transparentCorners:!1},{hasBorders:!1}),t.selectionBackgroundColor=h,s.util.isTransparent(a,e,i,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find(function(e){return!0===t[e]}):t[this.selectionKey]},_shouldClearSelection:function(t,e){var i=this.getActiveObjects(),r=this._activeObject;return!e||e&&r&&i.length>1&&-1===i.indexOf(e)&&r!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t){if(t){var e,i=this._currentTransform;return"scale"===i.action||"scaleX"===i.action||"scaleY"===i.action?e=this.centeredScaling||t.centeredScaling:"rotate"===i.action&&(e=this.centeredRotation||t.centeredRotation),e?!i.altKey:i.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},_getActionFromCorner:function(t,e,i){if(!e)return"drag";switch(e){case"mtr":return"rotate";case"ml":case"mr":return i[this.altActionKey]?"skewY":"scaleX";case"mt":case"mb":return i[this.altActionKey]?"skewX":"scaleY";default:return"scale"}},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),n=i._findTargetCorner(this.getPointer(t,!0)),o=this._getActionFromCorner(i,n,t),a=this._getOriginFromCorner(i,n);this._currentTransform={target:i,action:o,corner:n,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:a.x,originY:a.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1,shiftKey:t.shiftKey,altKey:t[this.centeredKey],original:s.util.saveObjectTransform(i)},this._currentTransform.original.originX=a.x,this._currentTransform.original.originY=a.y,this._resetCurrentTransform(),this._beforeTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform,r=i.target,n=t-i.offsetX,s=e-i.offsetY,o=!r.get("lockMovementX")&&r.left!==n,a=!r.get("lockMovementY")&&r.top!==s;return o&&r.set("left",n),a&&r.set("top",s),o||a},_changeSkewTransformOrigin:function(t,e,i){var r="originX",n={0:"center"},s=e.target.skewX,o="left",a="right",h="mt"===e.corner||"ml"===e.corner?1:-1,c=1;t=t>0?1:-1,"y"===i&&(s=e.target.skewY,o="top",a="bottom",r="originY"),n[-1]=o,n[1]=a,e.target.flipX&&(c*=-1),e.target.flipY&&(c*=-1),0===s?(e.skewSign=-h*t*c,e[r]=n[-t]):(s=s>0?1:-1,e.skewSign=s,e[r]=n[s*h*c])},_skewObject:function(t,e,i){var r,n=this._currentTransform,o=n.target,a=o.get("lockSkewingX"),h=o.get("lockSkewingY");if(a&&"x"===i||h&&"y"===i)return!1;var c,l,u=o.getCenterPoint(),f=o.toLocalPoint(new s.Point(t,e),"center","center")[i],d=o.toLocalPoint(new s.Point(n.lastX,n.lastY),"center","center")[i],g=o._getTransformedDimensions();return this._changeSkewTransformOrigin(f-d,n,i),c=o.toLocalPoint(new s.Point(t,e),n.originX,n.originY)[i],l=o.translateToOriginPoint(u,n.originX,n.originY),r=this._setObjectSkew(c,n,i,g),n.lastX=t,n.lastY=e,o.setPositionByOrigin(l,n.originX,n.originY),r},_setObjectSkew:function(t,e,i,r){var n,o,a,h,c,l,u,f,d,g,p=e.target,v=e.skewSign;return"x"===i?(c="y",l="Y",u="X",d=0,g=p.skewY):(c="x",l="X",u="Y",d=p.skewX,g=0),h=p._getTransformedDimensions(d,g),(f=2*Math.abs(t)-h[i])<=2?n=0:(n=v*Math.atan(f/p["scale"+u]/(h[c]/p["scale"+l])),n=s.util.radiansToDegrees(n)),o=p["skew"+u]!==n,p.set("skew"+u,n),0!==p["skew"+l]&&(a=p._getTransformedDimensions(),n=r[c]/a[c]*p["scale"+l],p.set("scale"+l,n)),o},_scaleObject:function(t,e,i){var r=this._currentTransform,n=r.target,o=n.lockScalingX,a=n.lockScalingY,h=n.lockScalingFlip;if(o&&a)return!1;var c,l=n.translateToOriginPoint(n.getCenterPoint(),r.originX,r.originY),u=n.toLocalPoint(new s.Point(t,e),r.originX,r.originY),f=n._getTransformedDimensions();return this._setLocalMouse(u,r),c=this._setObjectScale(u,r,o,a,i,h,f),n.setPositionByOrigin(l,r.originX,r.originY),c},_setObjectScale:function(t,e,i,r,n,s,o){var a,h,c,l,u=e.target,f=!1,d=!1,g=!1;return c=t.x*u.scaleX/o.x,l=t.y*u.scaleY/o.y,a=u.scaleX!==c,h=u.scaleY!==l,s&&c<=0&&c<u.scaleX&&(f=!0,t.x=0),s&&l<=0&&l<u.scaleY&&(d=!0,t.y=0),"equally"!==n||i||r?n?"x"!==n||u.get("lockUniScaling")?"y"!==n||u.get("lockUniScaling")||d||r||u.set("scaleY",l)&&(g=g||h):f||i||u.set("scaleX",c)&&(g=g||a):(f||i||u.set("scaleX",c)&&(g=g||a),d||r||u.set("scaleY",l)&&(g=g||h)):g=this._scaleObjectEqually(t,u,e,o),e.newScaleX=c,e.newScaleY=l,f||d||this._flipObject(e,n),g},_scaleObjectEqually:function(t,e,i,r){var n,s=t.y+t.x,o=r.y*i.original.scaleY/e.scaleY+r.x*i.original.scaleX/e.scaleX,a=t.x<0?-1:1,h=t.y<0?-1:1;return i.newScaleX=a*Math.abs(i.original.scaleX*s/o),i.newScaleY=h*Math.abs(i.original.scaleY*s/o),n=i.newScaleX!==e.scaleX||i.newScaleY!==e.scaleY,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY),n},_flipObject:function(t,e){t.newScaleX<0&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target,r=this.getZoom(),s=i.padding/r;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),n(t.x)>s?t.x<0?t.x+=s:t.x-=s:t.x=0,n(t.y)>s?t.y<0?t.y+=s:t.y-=s:t.y=0},_rotateObject:function(t,e){var n=this._currentTransform,s=n.target,o=s.translateToOriginPoint(s.getCenterPoint(),n.originX,n.originY);if(s.lockRotation)return!1;var a=r(n.ey-o.y,n.ex-o.x),h=r(e-o.y,t-o.x),c=i(h-a+n.theta),l=!0;if(s.snapAngle>0){var u=s.snapAngle,f=s.snapThreshold||u,d=Math.ceil(c/u)*u,g=Math.floor(c/u)*u;Math.abs(c-g)<f?c=g:Math.abs(c-d)<f&&(c=d)}return c<0&&(c=360+c),c%=360,s.angle===c?l=!1:(s.angle=c,s.setPositionByOrigin(o,n.originX,n.originY)),l},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,i=e.left,r=e.top,a=n(i),h=n(r);if(this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),a,h)),this.selectionLineWidth&&this.selectionBorderColor)if(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1&&!o){var c=e.ex+.5-(i>0?0:a),l=e.ey+.5-(r>0?0:h);t.beginPath(),s.util.drawDashedLine(t,c,l,c+a,l,this.selectionDashArray),s.util.drawDashedLine(t,c,l+h-1,c+a,l+h-1,this.selectionDashArray),s.util.drawDashedLine(t,c,l,c,l+h,this.selectionDashArray),s.util.drawDashedLine(t,c+a-1,l,c+a-1,l+h,this.selectionDashArray),t.closePath(),t.stroke()}else s.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(e.ex+.5-(i>0?0:a),e.ey+.5-(r>0?0:h),a,h)},findTarget:function(t,e){if(!this.skipTargetFind){var i,r,n=this.getPointer(t,!0),s=this._activeObject,o=this.getActiveObjects();if(this.targets=[],o.length>1&&!e&&s===this._searchPossibleTargets([s],n))return s;if(1===o.length&&s._findTargetCorner(n))return s;if(1===o.length&&s===this._searchPossibleTargets([s],n)){if(!this.preserveObjectStacking)return s;i=s,r=this.targets,this.targets=[]}var a=this._searchPossibleTargets(this._objects,n);return t[this.altSelectionKey]&&a&&i&&a!==i&&(a=i,this.targets=r),a}},_checkTarget:function(t,e){if(e&&e.visible&&e.evented&&this.containsPoint(null,e,t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,t.x,t.y))return!0}},_searchPossibleTargets:function(t,e){for(var i,r,n,o=t.length;o--;)if(this._checkTarget(e,t[o])){(i=t[o]).subTargetCheck&&i instanceof s.Group&&(r=this._normalizePointer(i,e),(n=this._searchPossibleTargets(i._objects,r))&&this.targets.push(n));break}return i},restorePointerVpt:function(t){return s.util.transformPoint(t,s.util.invertTransform(this.viewportTransform))},getPointer:function(e,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var r,n=t(e),s=this.upperCanvasEl,o=s.getBoundingClientRect(),a=o.width||0,h=o.height||0;return a&&h||("top"in o&&"bottom"in o&&(h=Math.abs(o.top-o.bottom)),"right"in o&&"left"in o&&(a=Math.abs(o.right-o.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,i||(n=this.restorePointerVpt(n)),r=0===a||0===h?{width:1,height:1}:{width:s.width/a,height:s.height/h},{x:n.x*r.width,y:n.y*r.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl?this.upperCanvasEl.className="":this.upperCanvasEl=this._createCanvasElement(),s.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=s.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),s.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),s.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,i=this.height||t.height;s.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=i,s.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),this._hoveredTarget===t&&(this._hoveredTarget=null),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var i=!1,r=this.getActiveObjects(),n=[],s=[],o={e:e};t.forEach(function(t){-1===r.indexOf(t)&&(i=!0,t.fire("deselected",o),s.push(t))}),r.forEach(function(e){-1===t.indexOf(e)&&(i=!0,e.fire("selected",o),n.push(e))}),t.length>0&&r.length>0?(o.selected=n,o.deselected=s,o.updated=n[0]||s[0],o.target=this._activeObject,i&&this.fire("selection:updated",o)):r.length>0?(1===r.length&&(o.target=n[0],this.fire("object:selected",o)),o.selected=n,o.target=this._activeObject,this.fire("selection:created",o)):t.length>0&&(o.deselected=s,this.fire("selection:cleared",o))},setActiveObject:function(t,e){var i=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(i,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&(!!this._discardActiveObject(e,t)&&(!t.onSelect({e:e})&&(this._activeObject=t,!0)))},_discardActiveObject:function(t,e){var i=this._activeObject;if(i){if(i.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects();return e.length&&this.fire("before:selection:cleared",{target:e[0],e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){s.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,s.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,i){var r=this._realizeGroupTransformOnObject(t),n=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,r),n},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(i){e[i]=t[i]}),this._activeObject.realizeTransform(t),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var r=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,r)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),s.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),s.StaticCanvas)"prototype"!==a&&(s.Canvas[a]=s.StaticCanvas[a]);s.isTouchSupported&&(s.Canvas.prototype._setCursorFromEvent=function(){})}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=s.util.addListener,i=s.util.removeListener,r={passive:!1};function n(t,e){return"which"in t?t.which===e:t.button===e-1}s.util.object.extend(s.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},addOrRemove:function(t,e){t(s.window,"resize",this._onResize),t(this.upperCanvasEl,"mousedown",this._onMouseDown),t(this.upperCanvasEl,"mousemove",this._onMouseMove,r),t(this.upperCanvasEl,"mouseout",this._onMouseOut),t(this.upperCanvasEl,"mouseenter",this._onMouseEnter),t(this.upperCanvasEl,"wheel",this._onMouseWheel),t(this.upperCanvasEl,"contextmenu",this._onContextMenu),t(this.upperCanvasEl,"dblclick",this._onDoubleClick),t(this.upperCanvasEl,"touchstart",this._onMouseDown,r),t(this.upperCanvasEl,"touchmove",this._onMouseMove,r),t(this.upperCanvasEl,"dragover",this._onDragOver),t(this.upperCanvasEl,"dragenter",this._onDragEnter),t(this.upperCanvasEl,"dragleave",this._onDragLeave),t(this.upperCanvasEl,"drop",this._onDrop),"undefined"!=typeof eventjs&&e in eventjs&&(eventjs[e](this.upperCanvasEl,"gesture",this._onGesture),eventjs[e](this.upperCanvasEl,"drag",this._onDrag),eventjs[e](this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs[e](this.upperCanvasEl,"shake",this._onShake),eventjs[e](this.upperCanvasEl,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(i,"remove"),i(s.document,"mouseup",this._onMouseUp),i(s.document,"touchend",this._onMouseUp,r),i(s.document,"mousemove",this._onMouseMove,r),i(s.document,"touchmove",this._onMouseMove,r)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t}),this._iTextInstances&&this._iTextInstances.forEach(function(t){t.isEditing&&t.hiddenTextarea.focus()})},_onMouseEnter:function(t){this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},_onMouseDown:function(t){this.__onMouseDown(t),this._resetTransformEventData(),e(s.document,"touchend",this._onMouseUp,r),e(s.document,"touchmove",this._onMouseMove,r),i(this.upperCanvasEl,"mousemove",this._onMouseMove,r),i(this.upperCanvasEl,"touchmove",this._onMouseMove,r),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(s.document,"mouseup",this._onMouseUp),e(s.document,"mousemove",this._onMouseMove,r))},_onMouseUp:function(t){if(this.__onMouseUp(t),this._resetTransformEventData(),i(s.document,"mouseup",this._onMouseUp),i(s.document,"touchend",this._onMouseUp,r),i(s.document,"mousemove",this._onMouseMove,r),i(s.document,"touchmove",this._onMouseMove,r),e(this.upperCanvasEl,"mousemove",this._onMouseMove,r),e(this.upperCanvasEl,"touchmove",this._onMouseMove,r),"touchend"===t.type){var n=this;setTimeout(function(){e(n.upperCanvasEl,"mousedown",n._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this._activeObject;return(!i||!i.isEditing||t!==i)&&!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e,i=this._currentTransform,r=this._groupSelector,s=!r||0===r.left&&0===r.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),n(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,s);else{if(n(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,s),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else{i&&this._finalizeCurrentTransform(t);var o=this._shouldRender(e,this._absolutePointer);!e&&s||this._maybeGroupObjects(t),e&&(e.isMoving=!1),this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,s),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),o&&this.requestRenderAll()}}},_simpleEventHandler:function(t,e){var i=this.findTarget(e),r=this.targets,n={e:e,target:i,subTargets:r};if(this.fire(t,n),i&&i.fire(t,n),!r)return i;for(var s=0;s<r.length;s++)r[s].fire(t,n);return i},_handleEvent:function(t,e,i,r){var n=this._target,s=this.targets||[],o={e:t,target:n,subTargets:s,button:i||1,isClick:r||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};this.fire("mouse:"+e,o),n&&n.fire("mouse"+e,o);for(var a=0;a<s.length;a++)s[a].fire("mouse"+e,o)},_finalizeCurrentTransform:function(t){var e,i=this._currentTransform,r=i.target,n={e:t,target:r,transform:i};r._scaling&&(r._scaling=!1),r.setCoords(),(i.actionPerformed||this.stateful&&r.hasStateChanged())&&(i.actionPerformed&&(e=this._addEventOptions(n,i),this._fire(e,n)),this._fire("modified",n))},_addEventOptions:function(t,e){var i,r;switch(e.action){case"scaleX":i="scaled",r="x";break;case"scaleY":i="scaled",r="y";break;case"skewX":i="skewed",r="x";break;case"skewY":i="skewed",r="y";break;case"scale":i="scaled",r="equally";break;case"rotate":i="rotated";break;case"drag":i="moved"}return t.by=r,i},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll(),this.clipTo&&s.util.clipContext(this,this.contextTop);var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e)}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(n(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(n(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(!this._currentTransform){var i=this._pointer;this._previousPointer=i;var r=this._shouldRender(e,i),s=this._shouldGroup(t,e);this._shouldClearSelection(t,e)?this.discardActiveObject(t):s&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0}),e&&(e.selectable&&this.setActiveObject(e,t),e!==this._activeObject||!e.__corner&&s||this._setupCurrentTransform(t,e)),this._handleEvent(t,"down"),r&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e}),e.corner&&this.onBeforeScaleRotate(e.target)},__onMouseMove:function(t){var e,i;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(!(void 0!==t.touches&&t.touches.length>1)){var r=this._groupSelector;r?(i=this._pointer,r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){this.fireSynteticInOutEvents(t,e,{targetName:"_hoveredTarget",canvasEvtOut:"mouse:out",evtOut:"mouseout",canvasEvtIn:"mouse:over",evtIn:"mouseover"})},_fireEnterLeaveEvents:function(t,e){this.fireSynteticInOutEvents(t,e,{targetName:"_draggedoverTarget",evtOut:"dragleave",evtIn:"dragenter"})},fireSynteticInOutEvents:function(t,e,i){var r,n,s,o=this[i.targetName],a=o!==t,h=i.canvasEvtIn,c=i.canvasEvtOut;a&&(r={e:e,target:t,previousTarget:o},n={e:e,target:o,nextTarget:t},this[i.targetName]=t),s=t&&a,o&&a&&(c&&this.fire(c,n),o.fire(i.evtOut,n)),s&&(h&&this.fire(h,r),t.fire(i.evtIn,r))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,i.shiftKey=t.shiftKey,i.altKey=t[this.centeredKey],this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),i.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,i){var r=i.x,n=i.y,s=e.action,o=!1,a={target:e.target,e:t,transform:e,pointer:i};"rotate"===s?(o=this._rotateObject(r,n))&&this._fire("rotating",a):"scale"===s?(o=this._onScale(t,e,r,n))&&this._fire("scaling",a):"scaleX"===s?(o=this._scaleObject(r,n,"x"))&&this._fire("scaling",a):"scaleY"===s?(o=this._scaleObject(r,n,"y"))&&this._fire("scaling",a):"skewX"===s?(o=this._skewObject(r,n,"x"))&&this._fire("skewing",a):"skewY"===s?(o=this._skewObject(r,n,"y"))&&this._fire("skewing",a):(o=this._translateObject(r,n))&&(this._fire("moving",a),this.setCursor(a.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||o},_fire:function(t,e){this.fire("object:"+t,e),e.target.fire(t,e)},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(),e.reset=!0)}},_onScale:function(t,e,i,r){return this._isUniscalePossible(t,e.target)?(e.currentAction="scale",this._scaleObject(i,r)):(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally"))},_isUniscalePossible:function(t,e){return(t[this.uniScaleKey]||this.uniScaleTransform)&&!e.get("lockUniScaling")},_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor,r=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,n=(!r||!r.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));n?this.setCursor(this.getCornerCursor(n,e,t)):this.setCursor(i)},getCornerCursor:function(e,i,r){return this.actionIsDisabled(e,i,r)?this.notAllowedCursor:e in t?this._getRotatedCornerCursor(e,i,r):"mtr"===e&&i.hasRotatingPoint?this.rotationCursor:this.defaultCursor},actionIsDisabled:function(t,e,i){return"mt"===t||"mb"===t?i[this.altActionKey]?e.lockSkewingX:e.lockScalingY:"ml"===t||"mr"===t?i[this.altActionKey]?e.lockSkewingY:e.lockScalingX:"mtr"===t?e.lockRotation:this._isUniscalePossible(i,e)?e.lockScalingX&&e.lockScalingY:e.lockScalingX||e.lockScalingY},_getRotatedCornerCursor:function(e,i,r){var n=Math.round(i.angle%360/45);return n<0&&(n+=8),n+=t[e],r[this.altActionKey]&&t[e]%2==0&&(n+=2),n%=8,this.cursorMap[n]}})}(),function(){var t=Math.min,e=Math.max;s.util.object.extend(s.Canvas.prototype,{_shouldGroup:function(t,e){var i=this._activeObject;return i&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(i!==e||"activeSelection"===i.type)},_handleGrouping:function(t,e){var i=this._activeObject;i.__corner||(e!==i||(e=this.findTarget(t,!0)))&&(i&&"activeSelection"===i.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var i=this._activeObject,r=i._objects.slice(0);i.contains(t)?(i.removeWithUpdate(t),this._hoveredTarget=t,1===i.size()&&this._setActiveObject(i.item(0),e)):(i.addWithUpdate(t),this._hoveredTarget=i),this._fireSelectionEvents(r,e)},_createActiveSelection:function(t,e){var i=this.getActiveObjects(),r=this._createGroup(t);this._hoveredTarget=r,this._setActiveObject(r,e),this._fireSelectionEvents(i,e)},_createGroup:function(t){var e=this._objects,i=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new s.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(t){var e,i=this._collectObjects();1===i.length?this.setActiveObject(i[0],t):i.length>1&&(e=new s.ActiveSelection(i.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(){for(var i,r=[],n=this._groupSelector.ex,o=this._groupSelector.ey,a=n+this._groupSelector.left,h=o+this._groupSelector.top,c=new s.Point(t(n,a),t(o,h)),l=new s.Point(e(n,a),e(o,h)),u=!this.selectionFullyContained,f=n===a&&o===h,d=this._objects.length;d--&&!((i=this._objects[d])&&i.selectable&&i.visible&&(u&&i.intersectsWithRect(c,l)||i.isContainedWithinRect(c,l)||u&&i.containsPoint(c)||u&&i.containsPoint(l))&&(r.push(i),f)););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){var t=s.StaticCanvas.supports("toDataURLWithQuality");s.util.object.extend(s.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=(t.multiplier||1)*(t.enableRetinaScaling?1:1/this.getRetinaScaling()),n={left:t.left||0,top:t.top||0,width:t.width||0,height:t.height||0};return this.__toDataURLWithMultiplier(e,i,n,r)},__toDataURLWithMultiplier:function(t,e,i,r){var n=this.width,s=this.height,o=(i.width||this.width)*r,a=(i.height||this.height)*r,h=this.getZoom()*r,c=this.viewportTransform,l=[h,0,0,h,(c[4]-i.left)*r,(c[5]-i.top)*r],u=this.interactive,f=this.skipOffscreen,d=n!==o||s!==a;this.viewportTransform=l,this.skipOffscreen=!1,this.interactive=!1,d&&this.setDimensions({width:o,height:a},{backstoreOnly:!0}),this.renderAll();var g=this.__toDataURL(t,e,i);return this.interactive=u,this.skipOffscreen=f,this.viewportTransform=c,d&&this.setDimensions({width:n,height:s},{backstoreOnly:!0}),this.renderAll(),g},__toDataURL:function(e,i){var r=this.contextContainer.canvas;return"jpg"===e&&(e="jpeg"),t?r.toDataURL("image/"+e,i):r.toDataURL("image/"+e)}})}(),s.util.object.extend(s.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):s.util.object.clone(t),n=this,o=this.renderOnAddRemove;return this.renderOnAddRemove=!1,this._enlivenObjects(r.objects,function(t){n.clear(),n._setBgOverlay(r,function(){t.forEach(function(t,e){n.insertAt(t,e)}),n.renderOnAddRemove=o,delete r.objects,delete r.backgroundImage,delete r.overlayImage,delete r.background,delete r.overlay,n._setOptions(r),n.renderAll(),e&&e()})},i),this}},_setBgOverlay:function(t,e){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var r=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,i,r),this.__setBgOverlay("overlayImage",t.overlayImage,i,r),this.__setBgOverlay("backgroundColor",t.background,i,r),this.__setBgOverlay("overlayColor",t.overlay,i,r)}else e&&e()},__setBgOverlay:function(t,e,i,r){var n=this;if(!e)return i[t]=!0,void(r&&r());"backgroundImage"===t||"overlayImage"===t?s.util.enlivenObjects([e],function(e){n[t]=e[0],i[t]=!0,r&&r()}):this["set"+s.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})},_enlivenObjects:function(t,e,i){t&&0!==t.length?s.util.enlivenObjects(t,function(t){e&&e(t)},null,i):e&&e([])},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=s.util.createCanvasElement();e.width=this.width,e.height=this.height;var i=new s.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,s=e.util.toFixed,o=e.util.string.capitalize,a=e.util.degreesToRadians,h=e.StaticCanvas.supports("setLineDash"),c=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",borderDashArray:null,cornerColor:"rgba(102,153,255,0.5)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:c,statefullCache:!1,noScaleCache:!0,dirty:!0,__corner:0,paintFirst:"fill",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow clipTo visible backgroundColor skewX skewY fillRule paintFirst".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeLineCap strokeLineJoin strokeMiterLimit backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var i=e.perfLimitSizeTotal,r=t.width,n=t.height,s=e.maxCacheSideLimit,o=e.minCacheSideLimit;if(r<=s&&n<=s&&r*n<=i)return r<o&&(t.width=o),n<o&&(t.height=o),t;var a=r/n,h=e.util.limitDimsByArea(a,i),c=e.util.capValue,l=c(o,h.x,s),u=c(o,h.y,s);return r>l&&(t.zoomX/=r/l,t.width=l,t.capped=!0),n>u&&(t.zoomY/=n/u,t.height=u,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getNonTransformedDimensions(),i=t.scaleX,r=t.scaleY;return{width:e.x*i+2,height:e.y*r+2,zoomX:i,zoomY:r,x:e.x,y:e.y}},_updateCacheCanvas:function(){if(this.noScaleCache&&this.canvas&&this.canvas._currentTransform){var t=this.canvas._currentTransform.target,i=this.canvas._currentTransform.action;if(this===t&&i.slice&&"scale"===i.slice(0,5))return!1}var r,n,s=this._cacheCanvas,o=this._limitCacheSize(this._getCacheCanvasDimensions()),a=e.minCacheSideLimit,h=o.width,c=o.height,l=o.zoomX,u=o.zoomY,f=h!==this.cacheWidth||c!==this.cacheHeight,d=this.zoomX!==l||this.zoomY!==u,g=f||d,p=0,v=0,m=!1;if(f){var _=this._cacheCanvas.width,y=this._cacheCanvas.height,x=h>_||c>y;m=x||(h<.9*_||c<.9*y)&&_>a&&y>a,x&&!o.capped&&(h>a||c>a)&&(p=.1*h,v=.1*c)}return!!g&&(m?(s.width=Math.ceil(h+p),s.height=Math.ceil(c+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,s.width,s.height)),r=o.x*l/2,n=o.y*u/2,this.cacheTranslationX=Math.round(s.width/2-r)+r,this.cacheTranslationY=Math.round(s.height/2-n)+n,this.cacheWidth=h,this.cacheHeight=c,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(l,u),this.zoomX=l,this.zoomY=u,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initClipping(t),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e;e=this.group&&!this.group._transformDone?this.calcTransformMatrix():this.calcOwnMatrix(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,r={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:s(this.left,i),top:s(this.top,i),width:s(this.width,i),height:s(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:s(this.strokeWidth,i),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:s(this.strokeMiterLimit,i),scaleX:s(this.scaleX,i),scaleY:s(this.scaleY,i),angle:s(this.angle,i),flipX:this.flipX,flipY:this.flipY,opacity:s(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,transformMatrix:this.transformMatrix?this.transformMatrix.concat():null,skewX:s(this.skewX,i),skewY:s(this.skewY,i)};return e.util.populateWithProperties(this,r,t),this.includeDefaultValues||(r=this._removeDefaultValues(r)),r},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype;return i.stateProperties.forEach(function(e){t[e]===i[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(i[e])&&0===t[e].length&&0===i[e].length&&delete t[e]}),t},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){var t=this.scaleX,e=this.scaleY;if(this.group){var i=this.group.getObjectScaling();t*=i.scaleX,e*=i.scaleY}return{scaleX:t,scaleY:e}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,i=t.scaleY;if(this.canvas){var r=this.canvas.getZoom(),n=this.canvas.getRetinaScaling();e*=r*n,i*=r*n}return{scaleX:e,scaleY:i}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,i){var r="scaleX"===t||"scaleY"===t,n=this[t]!==i,s=!1;return r&&(i=this._constrainScale(i)),"scaleX"===t&&i<0?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&i<0?(this.flipY=!this.flipY,i*=-1):"shadow"!==t||!i||i instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",i):i=new e.Shadow(i),this[t]=i,n&&(s=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,s&&this.group.set("dirty",!0)):s&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||0===this.width&&0===this.height||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.clipTo&&e.util.clipContext(this,t),this.shouldCache()?(this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext),this.dirty=!1),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),this.clipTo&&t.restore(),t.restore())},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},needsItsOwnCache:function(){return"stroke"===this.paintFirst&&"object"===n(this.shadow)},shouldCache:function(){return this.ownCaching=this.objectCaching&&(!this.group||this.needsItsOwnCache()||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawObject:function(t){this._renderBackground(t),this._setStrokeStyles(t,this),this._setFillStyles(t,this),this._render(t)},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-i/2,e,i)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){e.stroke&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,t.strokeStyle=e.stroke.toLive?e.stroke.toLive(t,this):e.stroke)},_setFillStyles:function(t,e){e.fill&&(t.fillStyle=e.fill.toLive?e.fill.toLive(t,this):e.fill)},_setLineDash:function(t,e,i){e&&(1&e.length&&e.push.apply(e,e),h?t.setLineDash(e):i&&i(t))},_renderControls:function(t,i){var r,n,s,o=this.getViewportTransform(),h=this.calcTransformMatrix();n=void 0!==(i=i||{}).hasBorders?i.hasBorders:this.hasBorders,s=void 0!==i.hasControls?i.hasControls:this.hasControls,h=e.util.multiplyTransformMatrices(o,h),r=e.util.qrDecompose(h),t.save(),t.translate(r.translateX,r.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),i.forActiveSelection?(t.rotate(a(r.angle)),n&&this.drawBordersInGroup(t,r,i)):(t.rotate(a(this.angle)),n&&this.drawBorders(t,i)),s&&this.drawControls(t,i),t.restore()},_setShadow:function(t){if(this.shadow){var i=this.canvas&&this.canvas.viewportTransform[0]||1,r=this.canvas&&this.canvas.viewportTransform[3]||1,n=this.getObjectScaling();this.canvas&&this.canvas._isRetinaScaling()&&(i*=e.devicePixelRatio,r*=e.devicePixelRatio),t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*e.browserShadowBlurConstant*(i+r)*(n.scaleX+n.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*i*n.scaleX,t.shadowOffsetY=this.shadow.offsetY*r*n.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var i=e.gradientTransform||e.patternTransform,r=-this.width/2+e.offsetX||0,n=-this.height/2+e.offsetY||0;return t.translate(r,n),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:r,offsetY:n}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_renderFill:function(t){this.fill&&(t.save(),this._applyPatternGradientTransform(t,this.fill),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){this.stroke&&0!==this.strokeWidth&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray,this._renderDashedStroke),this._applyPatternGradientTransform(t,this.stroke),t.stroke(),t.restore())},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var i=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),i=e.util.transformPoint(i,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,i.x+=t.offsetLeft,i.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(i,"center","center")},clone:function(t,i){var r=this.toObject(i);this.constructor.fromObject?this.constructor.fromObject(r,t):e.Object._fromObject("Object",r,t)},cloneAsImage:function(t,i){var r=this.toDataURL(i);return e.util.loadImage(r,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.saveObjectTransform(this);t.withoutTransform&&e.util.resetObjectTransform(this);var r=e.util.createCanvasElement(),n=this.getBoundingRect(!0,!0);r.width=n.width,r.height=n.height;var s=new e.StaticCanvas(r,{enableRetinaScaling:t.enableRetinaScaling,renderOnAddRemove:!1,skipOffscreen:!1});"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(s.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(s.width/2,s.height/2),"center","center");var o=this.canvas;s.add(this);var a=s.toDataURL(t);return this.set(i).setCoords(),this.canvas=o,s._objects=[],s.dispose(),s=null,a},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};return r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2),r.gradientTransform=i.gradientTransform,e.Gradient.prototype.addColorStop.call(r,i.colorStops),this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t,i){return this.set("fill",new e.Pattern(t,i))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,i){i=i||this.canvas.getPointer(t);var r=new e.Point(i.x,i.y),n=this._getLeftTopCoords();return this.angle&&(r=e.util.rotatePoint(r,n,a(-this.angle))),{x:r.x-n.x,y:r.y-n.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,i,n,s){var o=e[t];i=r(i,!0),e.util.enlivenPatterns([i.fill,i.stroke],function(t){void 0!==t[0]&&(i.fill=t[0]),void 0!==t[1]&&(i.stroke=t[1]);var e=s?new o(i[s],i):new o(i);n&&n(e)})},e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=s.util.degreesToRadians,e={left:-.5,center:0,right:.5},i={top:-.5,center:0,bottom:.5};s.util.object.extend(s.Object.prototype,{translateToGivenOrigin:function(t,r,n,o,a){var h,c,l,u=t.x,f=t.y;return"string"==typeof r?r=e[r]:r-=.5,"string"==typeof o?o=e[o]:o-=.5,"string"==typeof n?n=i[n]:n-=.5,"string"==typeof a?a=i[a]:a-=.5,c=a-n,((h=o-r)||c)&&(l=this._getTransformedDimensions(),u=t.x+h*l.x,f=t.y+c*l.y),new s.Point(u,f)},translateToCenterPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,i,r,"center","center");return this.angle?s.util.rotatePoint(n,e,t(this.angle)):n},translateToOriginPoint:function(e,i,r){var n=this.translateToGivenOrigin(e,"center","center",i,r);return this.angle?s.util.rotatePoint(n,e,t(this.angle)):n},getCenterPoint:function(){var t=new s.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,r){var n,o,a=this.getCenterPoint();return n=void 0!==i&&void 0!==r?this.translateToGivenOrigin(a,"center","center",i,r):new s.Point(this.left,this.top),o=new s.Point(e.x,e.y),this.angle&&(o=s.util.rotatePoint(o,a,-t(this.angle))),o.subtractEquals(n)},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),n=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(i){var r,n,o=t(this.angle),a=this.getScaledWidth(),h=s.util.cos(o)*a,c=s.util.sin(o)*a;r="string"==typeof this.originX?e[this.originX]:this.originX-.5,n="string"==typeof i?e[i]:i-.5,this.left+=h*(n-r),this.top+=c*(n-r),this.setCoords(),this.originX=i},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var t=s.util.degreesToRadians,e=s.util.multiplyTransformMatrices,i=s.util.transformPoint;s.util.object.extend(s.Object.prototype,{oCoords:null,aCoords:null,ownMatrixCache:null,matrixCache:null,getCoords:function(t,e){this.oCoords||this.setCoords();var i=t?this.aCoords:this.oCoords;return function(t){return[new s.Point(t.tl.x,t.tl.y),new s.Point(t.tr.x,t.tr.y),new s.Point(t.br.x,t.br.y),new s.Point(t.bl.x,t.bl.y)]}(e?this.calcCoords(t):i)},intersectsWithRect:function(t,e,i,r){var n=this.getCoords(i,r);return"Intersection"===s.Intersection.intersectPolygonRectangle(n,t,e).status},intersectsWithObject:function(t,e,i){return"Intersection"===s.Intersection.intersectPolygonPolygon(this.getCoords(e,i),t.getCoords(e,i)).status||t.isContainedWithinObject(this,e,i)||this.isContainedWithinObject(t,e,i)},isContainedWithinObject:function(t,e,i){for(var r=this.getCoords(e,i),n=0,s=t._getImageLines(i?t.calcCoords(e):e?t.aCoords:t.oCoords);n<4;n++)if(!t.containsPoint(r[n],s))return!1;return!0},isContainedWithinRect:function(t,e,i,r){var n=this.getBoundingRect(i,r);return n.left>=t.x&&n.left+n.width<=e.x&&n.top>=t.y&&n.top+n.height<=e.y},containsPoint:function(t,e,i,r){e=e||this._getImageLines(r?this.calcCoords(i):i?this.aCoords:this.oCoords);var n=this._findCrossPoints(t,e);return 0!==n&&n%2==1},isOnScreen:function(t){if(!this.canvas)return!1;for(var e,i=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br,n=this.getCoords(!0,t),s=0;s<4;s++)if((e=n[s]).x<=r.x&&e.x>=i.x&&e.y<=r.y&&e.y>=i.y)return!0;return!!this.intersectsWithRect(i,r,!0,t)||this._containsCenterOfCanvas(i,r,t)},_containsCenterOfCanvas:function(t,e,i){var r={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(r,null,!0,i)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,i,!0,t)||this._containsCenterOfCanvas(e,i,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,n,s=0;for(var o in e)if(!((n=e[o]).o.y<t.y&&n.d.y<t.y||n.o.y>=t.y&&n.d.y>=t.y||(n.o.x===n.d.x&&n.o.x>=t.x?r=n.o.x:(0,i=(n.d.y-n.o.y)/(n.d.x-n.o.x),r=-(t.y-0*t.x-(n.o.y-i*n.o.x))/(0-i)),r>=t.x&&(s+=1),2!==s)))break;return s},getBoundingRect:function(t,e){var i=this.getCoords(t,e);return s.util.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var i=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/i)},scaleToHeight:function(t,e){var i=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/i)},calcCoords:function(r){var n=this._calcRotateMatrix(),o=this._calcTranslateMatrix(),a=e(o,n),h=this.getViewportTransform(),c=r?a:e(h,a),l=this._getTransformedDimensions(),u=l.x/2,f=l.y/2,d=i({x:-u,y:-f},c),g=i({x:u,y:-f},c),p=i({x:-u,y:f},c),v=i({x:u,y:f},c);if(!r){var m=this.padding,_=t(this.angle),y=s.util.cos(_),x=s.util.sin(_),b=y*m,C=x*m,S=b+C,T=b-C;m&&(d.x-=T,d.y-=S,g.x+=S,g.y-=T,p.x-=S,p.y+=T,v.x+=T,v.y+=S);var w=new s.Point((d.x+p.x)/2,(d.y+p.y)/2),O=new s.Point((g.x+d.x)/2,(g.y+d.y)/2),k=new s.Point((v.x+g.x)/2,(v.y+g.y)/2),E=new s.Point((v.x+p.x)/2,(v.y+p.y)/2),D=new s.Point(O.x+x*this.rotatingPointOffset,O.y-y*this.rotatingPointOffset)}var j={tl:d,tr:g,br:v,bl:p};return r||(j.ml=w,j.mt=O,j.mr=k,j.mb=E,j.mtr=D),j},setCoords:function(t,e){return this.oCoords=this.calcCoords(t),e||(this.aCoords=this.calcCoords(!0)),t||this._setCornerCoords&&this._setCornerCoords(),this},_calcRotateMatrix:function(){if(this.angle){var e=t(this.angle),i=s.util.cos(e),r=s.util.sin(e);return[i,r,-r,i,0,0]}return s.iMatrix.concat()},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="";return!t&&this.group&&(e=this.group.transformMatrixKey(t)+"_"),e+this.top+"_"+this.left+"_"+this.scaleX+"_"+this.scaleY+"_"+this.skewX+"_"+this.skewY+"_"+this.angle+"_"+this.originX+"_"+this.originY+"_"+this.width+"_"+this.height+"_"+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){if(t)return this.calcOwnMatrix();var i=this.transformMatrixKey(),r=this.matrixCache||(this.matrixCache={});if(r.key===i)return r.value;var n=this.calcOwnMatrix();return this.group&&(n=e(this.group.calcTransformMatrix(),n)),r.key=i,r.value=n,n},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),i=this.ownMatrixCache||(this.ownMatrixCache={});if(i.key===t)return i.value;var r,n=this._calcTranslateMatrix(),s=this._calcDimensionsTransformMatrix(this.skewX,this.skewY,!0);return this.angle&&(r=this._calcRotateMatrix(),n=e(n,r)),n=e(n,s),i.key=t,i.value=n,n},_calcDimensionsTransformMatrix:function(i,r,n){var s,o=[this.scaleX*(n&&this.flipX?-1:1),0,0,this.scaleY*(n&&this.flipY?-1:1),0,0];return i&&(s=[1,0,Math.tan(t(i)),1],o=e(o,s,!0)),r&&(s=[1,Math.tan(t(r)),0,1],o=e(o,s,!0)),o},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(t,e){void 0===t&&(t=this.skewX),void 0===e&&(e=this.skewY);var i=this._getNonTransformedDimensions();if(0===t&&0===e)return{x:i.x*this.scaleX,y:i.y*this.scaleY};var r,n,o=i.x/2,a=i.y/2,h=[{x:-o,y:-a},{x:o,y:-a},{x:-o,y:a},{x:o,y:a}],c=this._calcDimensionsTransformMatrix(t,e,!1);for(r=0;r<h.length;r++)h[r]=s.util.transformPoint(h[r],c);return{x:(n=s.util.makeBoundingBoxFromPoints(h)).width,y:n.height}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return s.util.transformPoint(e,t,!0).scalarAdd(2*this.padding)}})}(),s.util.object.extend(s.Object.prototype,{sendToBack:function(){return this.group?s.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?s.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?s.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?s.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?s.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new s.Color(e),r=t+": "+i.toRgb()+"; ",n=i.getAlpha();return 1!==n&&(r+=t+"-opacity: "+n.toString()+"; "),r}return t+": none; "}var e=s.util.toFixed;s.util.object.extend(s.Object.prototype,{getSvgStyles:function(e){var i=this.fillRule,r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=void 0!==this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",l=e?"":this.getSvgFilter(),u=t("fill",this.fill);return[t("stroke",this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",s,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ",u,"fill-rule: ",i,"; ","opacity: ",h,";",l,c].join("")},getSvgSpanStyles:function(e,i){var r=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+"; ":"",n=e.strokeWidth?"stroke-width: "+e.strokeWidth+"; ":"",s=(r=r,e.fontSize?"font-size: "+e.fontSize+"px; ":""),o=e.fontStyle?"font-style: "+e.fontStyle+"; ":"",a=e.fontWeight?"font-weight: "+e.fontWeight+"; ":"",h=e.fill?t("fill",e.fill):"",c=e.stroke?t("stroke",e.stroke):"",l=this.getSvgTextDecoration(e);return l&&(l="text-decoration: "+l+"; "),[c,n,r,s,o,a,l,h,e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"",i?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return"overline"in t||"underline"in t||"linethrough"in t?(t.overline?"overline ":"")+(t.underline?"underline ":"")+(t.linethrough?"line-through ":""):""},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgId:function(){return this.id?'id="'+this.id+'" ':""},getSvgTransform:function(){var t=this.angle,i=this.skewX%360,r=this.skewY%360,n=this.getCenterPoint(),o=s.Object.NUM_FRACTION_DIGITS,a="translate("+e(n.x,o)+" "+e(n.y,o)+")",h=0!==t?" rotate("+e(t,o)+")":"",c=1===this.scaleX&&1===this.scaleY?"":" scale("+e(this.scaleX,o)+" "+e(this.scaleY,o)+")",l=0!==i?" skewX("+e(i,o)+")":"",u=0!==r?" skewY("+e(r,o)+")":"";return[a,h,c,this.flipX?" matrix(-1 0 0 1 0 0) ":"",this.flipY?" matrix(1 0 0 -1 0 0)":"",l,u].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_setSVGBg:function(t){if(this.backgroundColor){var i=s.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,i),'" y="',e(-this.height/2,i),'" width="',e(this.width,i),'" height="',e(this.height,i),'"></rect>\n')}},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=s.util.object.extend;function e(e,i,r){var n={};r.forEach(function(t){n[t]=e[t]}),t(e[i],n,!0)}s.util.object.extend(s.Object.prototype,{hasStateChanged:function(t){var e="_"+(t=t||"stateProperties");return Object.keys(this[e]).length<this[t].length||!function t(e,i,r){if(e===i)return!0;if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var s=0,o=e.length;s<o;s++)if(!t(e[s],i[s]))return!1;return!0}if(e&&"object"===(void 0===e?"undefined":n(e))){var a,h=Object.keys(e);if(!i||"object"!==(void 0===i?"undefined":n(i))||!r&&h.length!==Object.keys(i).length)return!1;for(s=0,o=h.length;s<o;s++)if(!t(e[a=h[s]],i[a]))return!1;return!0}}(this[e],this,!0)},saveState:function(t){var i=t&&t.propertySet||"stateProperties",r="_"+i;return this[r]?(e(this,r,this[i]),t&&t.stateProperties&&e(this,r,t.stateProperties),this):this.setupState(t)},setupState:function(t){var e=(t=t||{}).propertySet||"stateProperties";return t.propertySet=e,this["_"+e]={},this.saveState(t),this}})}(),function(){var t=s.util.degreesToRadians;s.util.object.extend(s.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var e,i,r=t.x,n=t.y;for(var s in this.__corner=0,this.oCoords)if(this.isControlVisible(s)&&("mtr"!==s||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==s&&"mr"!==s&&"mb"!==s&&"ml"!==s)&&(i=this._getImageLines(this.oCoords[s].corner),0!==(e=this._findCrossPoints({x:r,y:n},i))&&e%2==1))return this.__corner=s,s;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,n=t(45-this.angle),o=.707106*this.cornerSize,a=o*s.util.cos(n),h=o*s.util.sin(n);for(var c in r)e=r[c].x,i=r[c].y,r[c].corner={tl:{x:e-h,y:i-a},tr:{x:e+a,y:i-h},bl:{x:e-a,y:i+h},br:{x:e+h,y:i+a}}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var i=this.getCenterPoint(),r=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/n[0],1/n[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),r=1/this.borderScaleFactor,n=i.x+r,s=i.y+r,o=void 0!==e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,a=void 0!==e.hasControls?e.hasControls:this.hasControls,h=void 0!==e.rotatingPointOffset?e.rotatingPointOffset:this.rotatingPointOffset;if(t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray,null),t.strokeRect(-n/2,-s/2,n,s),o&&this.isControlVisible("mtr")&&a){var c=-s/2;t.beginPath(),t.moveTo(0,c),t.lineTo(0,c-h),t.stroke()}return t.restore(),this},drawBordersInGroup:function(t,e,i){i=i||{};var r=this._getNonTransformedDimensions(),n=s.util.customTransformMatrix(e.scaleX,e.scaleY,e.skewX),o=s.util.transformPoint(r,n),a=1/this.borderScaleFactor,h=o.x+a,c=o.y+a;return t.save(),this._setLineDash(t,i.borderDashArray||this.borderDashArray,null),t.strokeStyle=i.borderColor||this.borderColor,t.strokeRect(-h/2,-c/2,h,c),t.restore(),this},drawControls:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),r=i.x,n=i.y,s=e.cornerSize||this.cornerSize,o=-(r+s)/2,a=-(n+s)/2,h=void 0!==e.transparentCorners?e.transparentCorners:this.transparentCorners,c=void 0!==e.hasRotatingPoint?e.hasRotatingPoint:this.hasRotatingPoint,l=h?"stroke":"fill";return t.save(),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray,null),this._drawControl("tl",t,l,o,a,e),this._drawControl("tr",t,l,o+r,a,e),this._drawControl("bl",t,l,o,a+n,e),this._drawControl("br",t,l,o+r,a+n,e),this.get("lockUniScaling")||(this._drawControl("mt",t,l,o+r/2,a,e),this._drawControl("mb",t,l,o+r/2,a+n,e),this._drawControl("mr",t,l,o+r,a+n/2,e),this._drawControl("ml",t,l,o,a+n/2,e)),c&&this._drawControl("mtr",t,l,o+r/2,a-this.rotatingPointOffset,e),t.restore(),this},_drawControl:function(t,e,i,r,n,s){if(s=s||{},this.isControlVisible(t)){var o=this.cornerSize,a=!this.transparentCorners&&this.cornerStrokeColor;switch(s.cornerStyle||this.cornerStyle){case"circle":e.beginPath(),e.arc(r+o/2,n+o/2,o/2,0,2*Math.PI,!1),e[i](),a&&e.stroke();break;default:this.transparentCorners||e.clearRect(r,n,o,o),e[i+"Rect"](r,n,o,o),a&&e.strokeRect(r,n,o,o)}}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility},onDeselect:function(){},onSelect:function(){}})}(),s.util.object.extend(s.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var i=function(){},r=(e=e||{}).onComplete||i,n=e.onChange||i,o=this;return s.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),o.requestRenderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxCenterObjectV:function(t,e){var i=function(){},r=(e=e||{}).onComplete||i,n=e.onChange||i,o=this;return s.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),o.requestRenderAll(),n()},onComplete:function(){t.setCoords(),r()}}),this},fxRemove:function(t,e){var i=function(){},r=(e=e||{}).onComplete||i,n=e.onChange||i,o=this;return s.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),o.requestRenderAll(),n()},onComplete:function(){o.remove(t),r()}}),this}}),s.util.object.extend(s.Object.prototype,{animate:function(){if(arguments[0]&&"object"===n(arguments[0])){var t,e,i=[];for(t in arguments[0])i.push(t);for(var r=0,s=i.length;r<s;r++)t=i[r],e=r!==s-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,r){var n,o=this;e=e.toString(),i=i?s.util.object.clone(i):{},~t.indexOf(".")&&(n=t.split("."));var a=n?this.get(n[0])[n[1]]:this.get(t);"from"in i||(i.from=a),e=~e.indexOf("=")?a+parseFloat(e.replace("=","")):parseFloat(e),s.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(o)},onChange:function(e,s,a){n?o[n[0]][n[1]]=e:o.set(t,e),r||i.onChange&&i.onChange(e,s,a)},onComplete:function(t,e,n){r||(o.setCoords(),i.onComplete&&i.onComplete(t,e,n))}})}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,n={x1:1,x2:1,y1:1,y2:1},s=e.StaticCanvas.supports("setLineDash");function o(t,e){var i=t.origin,r=t.axis1,n=t.axis2,s=t.dimension,o=e.nearest,a=e.center,h=e.farthest;return function(){switch(this.get(i)){case o:return Math.min(this.get(r),this.get(n));case a:return Math.min(this.get(r),this.get(n))+.5*this.get(s);case h:return Math.max(this.get(r),this.get(n))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==n[t]&&this._setWidthHeight(),this},_getLeftToOriginX:o({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:o({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){if(t.beginPath(),!this.strokeDashArray||this.strokeDashArray&&s){var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2)}t.lineWidth=this.strokeWidth;var i=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i},_renderDashedStroke:function(t){var i=this.calcLinePoints();t.beginPath(),e.util.drawDashedLine(t,i.x1,i.y1,i.x2,i.y2,this.strokeDashArray),t.closePath()},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return i(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,r=e*this.height*.5;return{x1:i,x2:t*this.width*-.5,y1:r,y2:e*this.height*-.5}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.calcLinePoints();return e.push("<line ",this.getSvgId(),'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,r,n){n=n||{};var s=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),o=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];r(new e.Line(o,i(s,n)))},e.Line.fromObject=function(t,i){var n=r(t,!0);n.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",n,function(t){delete t.points,i&&i(t)},"points")})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.PI;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*i,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},toSVG:function(t){var r=this._createBaseSVGMarkup(),n=(this.endAngle-this.startAngle)%(2*i);if(0===n)r.push("<circle ",this.getSvgId(),'cx="0" cy="0" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n");else{var s=e.util.cos(this.startAngle)*this.radius,o=e.util.sin(this.startAngle)*this.radius,a=e.util.cos(this.endAngle)*this.radius,h=e.util.sin(this.endAngle)*this.radius,c=n>i?"1":"0";r.push('<path d="M '+s+" "+o," A "+this.radius+" "+this.radius," 0 ",+c+" 1"," "+a+" "+h,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n")}return t?t(r.join("")):r.join("")},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,i){var r,n=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!("radius"in(r=n)&&r.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");n.left=(n.left||0)-n.radius,n.top=(n.top||0)-n.radius,i(new e.Circle(n))},e.Circle.fromObject=function(t,i){return e.Object._fromObject("Circle",t,i)})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2,n=[-i+" "+r,"0 "+-r,i+" "+r].join(",");return e.push("<polygon ",this.getSvgId(),'points="',n,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"',this.addPaintOrder(),"/>"),t?t(e.join("")):e.join("")}}),e.Triangle.fromObject=function(t,i){return e.Object._fromObject("Triangle",t,i)})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup();return e.push("<ellipse ",this.getSvgId(),'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(e.join("")):e.join("")},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,i,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){var r=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,i(new e.Ellipse(r))},e.Ellipse.fromObject=function(t,i){return e.Object._fromObject("Ellipse",t,i)})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){if(1!==this.width||1!==this.height){var e=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,n=this.height,s=-this.width/2,o=-this.height/2,a=0!==e||0!==i,h=.4477152502;t.beginPath(),t.moveTo(s+e,o),t.lineTo(s+r-e,o),a&&t.bezierCurveTo(s+r-h*e,o,s+r,o+h*i,s+r,o+i),t.lineTo(s+r,o+n-i),a&&t.bezierCurveTo(s+r,o+n-h*i,s+r-h*e,o+n,s+r-e,o+n),t.lineTo(s+e,o+n),a&&t.bezierCurveTo(s+h*e,o+n,s,o+n-h*i,s,o+n-i),t.lineTo(s,o+i),a&&t.bezierCurveTo(s,o+h*i,s+h*e,o,s+e,o),t.closePath(),this._renderPaintInOrder(t)}else t.fillRect(-.5,-.5,1,1)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,n=this.width,s=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+n,r,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r,i+n,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r+s,i,r+s,this.strokeDashArray),e.util.drawDashedLine(t,i,r+s,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=-this.width/2,r=-this.height/2;return e.push("<rect ",this.getSvgId(),'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(e.join("")):e.join("")}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r,n){if(!t)return r(null);n=n||{};var s=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);s.left=s.left||0,s.top=s.top||0;var o=new e.Rect(i(n?e.util.object.clone(n):{},s));o.visible=o.visible&&o.width>0&&o.height>0,r(o)},e.Rect.fromObject=function(t,i){return e.Object._fromObject("Rect",t,i)})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,s=e.util.toFixed;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e);var i=this._calcDimensions();void 0===e.left&&(this.left=i.left),void 0===e.top&&(this.top=i.top),this.width=i.width,this.height=i.height,this.pathOffset={x:i.left+this.width/2,y:i.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=r(t,"x")||0,i=r(t,"y")||0;return{left:e,top:i,width:(n(t,"x")||0)-e,height:(n(t,"y")||0)-i}},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var i=[],r=this.pathOffset.x,n=this.pathOffset.y,o=this._createBaseSVGMarkup(),a=e.Object.NUM_FRACTION_DIGITS,h=0,c=this.points.length;h<c;h++)i.push(s(this.points[h].x-r,a),",",s(this.points[h].y-n,a)," ");return o.push("<",this.type," ",this.getSvgId(),'points="',i.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"',this.addPaintOrder(),"/>\n"),t?t(o.join("")):o.join("")},commonRender:function(t){var e,i=this.points.length,r=this.pathOffset.x,n=this.pathOffset.y;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-n);for(var s=0;s<i;s++)e=this.points[s],t.lineTo(e.x-r,e.y-n);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var n=0,s=this.points.length;n<s;n++)i=this.points[n],r=this.points[n+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i,r){if(!t)return i(null);r||(r={});var n=e.parsePointsAttribute(t.getAttribute("points")),s=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);i(new e.Polyline(n,e.util.object.extend(s,r)))},e.Polyline.fromObject=function(t,i){return e.Object._fromObject("Polyline",t,i,"points")})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))},_renderDashedStroke:function(t){this.callSuper("_renderDashedStroke",t),t.closePath()}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r,n){if(!t)return r(null);n||(n={});var s=e.parsePointsAttribute(t.getAttribute("points")),o=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);r(new e.Polygon(s,i(o,n)))},e.Polygon.fromObject=function(t,i){return e.Object._fromObject("Polygon",t,i,"points")})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,n=e.util.object.extend,s=Object.prototype.toString,o=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,e){e=e||{},this.callSuper("initialize",e),t||(t=[]);var i="[object Array]"===s.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._setPositionDimensions(e))},_setPositionDimensions:function(t){var e=this._parseDimensions();this.width=e.width,this.height=e.height,void 0===t.left&&(this.left=e.left),void 0===t.top&&(this.top=e.top),this.pathOffset=this.pathOffset||{x:e.left+this.width/2,y:e.top+this.height/2}},_renderPathCommands:function(t){var e,i,r,n=null,s=0,a=0,h=0,c=0,l=0,u=0,f=-this.pathOffset.x,d=-this.pathOffset.y;t.beginPath();for(var g=0,p=this.path.length;g<p;++g){switch((e=this.path[g])[0]){case"l":h+=e[1],c+=e[2],t.lineTo(h+f,c+d);break;case"L":h=e[1],c=e[2],t.lineTo(h+f,c+d);break;case"h":h+=e[1],t.lineTo(h+f,c+d);break;case"H":h=e[1],t.lineTo(h+f,c+d);break;case"v":c+=e[1],t.lineTo(h+f,c+d);break;case"V":c=e[1],t.lineTo(h+f,c+d);break;case"m":s=h+=e[1],a=c+=e[2],t.moveTo(h+f,c+d);break;case"M":s=h=e[1],a=c=e[2],t.moveTo(h+f,c+d);break;case"c":i=h+e[5],r=c+e[6],l=h+e[3],u=c+e[4],t.bezierCurveTo(h+e[1]+f,c+e[2]+d,l+f,u+d,i+f,r+d),h=i,c=r;break;case"C":h=e[5],c=e[6],l=e[3],u=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,l+f,u+d,h+f,c+d);break;case"s":i=h+e[3],r=c+e[4],null===n[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,h+e[1]+f,c+e[2]+d,i+f,r+d),l=h+e[1],u=c+e[2],h=i,c=r;break;case"S":i=e[3],r=e[4],null===n[0].match(/[CcSs]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.bezierCurveTo(l+f,u+d,e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"q":i=h+e[3],r=c+e[4],l=h+e[1],u=c+e[2],t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),h=i,c=r,l=e[1],u=e[2];break;case"t":i=h+e[1],r=c+e[2],null===n[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"T":i=e[1],r=e[2],null===n[0].match(/[QqTt]/)?(l=h,u=c):(l=2*h-l,u=2*c-u),t.quadraticCurveTo(l+f,u+d,i+f,r+d),h=i,c=r;break;case"a":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+h+f,e[7]+c+d]),h+=e[6],c+=e[7];break;case"A":o(t,h+f,c+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),h=e[6],c=e[7];break;case"z":case"Z":h=s,c=a,t.closePath()}n=e}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return n(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),top:this.top,left:this.left})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},toSVG:function(t){for(var e,i=[],r=this._createBaseSVGMarkup(),n=0,s=this.path.length;n<s;n++)i.push(this.path[n].join(" "));var o=i.join(" ");return e=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ",r.push("<path ",this.getSvgId(),'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),e,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',this.addPaintOrder(),"/>\n"),t?t(r.join("")):r.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,n,s=[],o=[],c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;l<u;l++){for(r=(t=this.path[l]).slice(1).trim(),o.length=0;i=c.exec(r);)o.push(i[0]);n=[t.charAt(0)];for(var f=0,d=o.length;f<d;f++)e=parseFloat(o[f]),isNaN(e)||n.push(e);var g=n[0],p=a[g.toLowerCase()],v=h[g]||g;if(n.length-1>p)for(var m=1,_=n.length;m<_;m+=p)s.push([g].concat(n.slice(m,m+p))),g=v;else s.push(n)}return s},_parseDimensions:function(){for(var t,n,s,o,a=[],h=[],c=null,l=0,u=0,f=0,d=0,g=0,p=0,v=0,m=this.path.length;v<m;++v){switch((t=this.path[v])[0]){case"l":f+=t[1],d+=t[2],o=[];break;case"L":f=t[1],d=t[2],o=[];break;case"h":f+=t[1],o=[];break;case"H":f=t[1],o=[];break;case"v":d+=t[1],o=[];break;case"V":d=t[1],o=[];break;case"m":l=f+=t[1],u=d+=t[2],o=[];break;case"M":l=f=t[1],u=d=t[2],o=[];break;case"c":n=f+t[5],s=d+t[6],g=f+t[3],p=d+t[4],o=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],g,p,n,s),f=n,d=s;break;case"C":g=t[3],p=t[4],o=e.util.getBoundsOfCurve(f,d,t[1],t[2],g,p,t[5],t[6]),f=t[5],d=t[6];break;case"s":n=f+t[3],s=d+t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,f+t[1],d+t[2],n,s),g=f+t[1],p=d+t[2],f=n,d=s;break;case"S":n=t[3],s=t[4],null===c[0].match(/[CcSs]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,t[1],t[2],n,s),f=n,d=s,g=t[1],p=t[2];break;case"q":n=f+t[3],s=d+t[4],g=f+t[1],p=d+t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"Q":g=t[1],p=t[2],o=e.util.getBoundsOfCurve(f,d,g,p,g,p,t[3],t[4]),f=t[3],d=t[4];break;case"t":n=f+t[1],s=d+t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"T":n=t[1],s=t[2],null===c[0].match(/[QqTt]/)?(g=f,p=d):(g=2*f-g,p=2*d-p),o=e.util.getBoundsOfCurve(f,d,g,p,g,p,n,s),f=n,d=s;break;case"a":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":o=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=l,d=u}c=t,o.forEach(function(t){a.push(t.x),h.push(t.y)}),a.push(f),h.push(d)}var _=i(a)||0,y=i(h)||0;return{left:_,top:y,width:(r(a)||0)-_,height:(r(h)||0)-y}}}),e.Path.fromObject=function(t,i){if("string"==typeof t.sourcePath){var r=t.sourcePath;e.loadSVGFromURL(r,function(e){var r=e[0];r.setOptions(t),i&&i(r)})}else e.Object._fromObject("Path",t,i,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var s=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i(new e.Path(s.d,n(s,r)))})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;if(i)this._updateObjectsACoords();else{var n=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),n||this._calcBounds(),this._updateObjectsCoords(n),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0,!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var i=t.left,r=t.top;t.set({left:i-e.x,top:r-e.y}),t.group=this,t.setCoords(!0,!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,i){var r=this._objects.length;if(this.useSetOnGroup)for(;r--;)this._objects[r].setOnGroup(t,i);if("canvas"===t)for(;r--;)this._objects[r]._set(t,i);e.Object.prototype._set.call(this,t,i)},toObject:function(t){var i=this._objects.map(function(e){var i=e.includeDefaultValues;e.includeDefaultValues=e.group.includeDefaultValues;var r=e.toObject(t);return e.includeDefaultValues=i,r}),r=e.Object.prototype.toObject.call(this,t);return r.objects=i,r},toDatalessObject:function(t){var i,r=this.sourcePath;i=r||this._objects.map(function(e){var i=e.includeDefaultValues;e.includeDefaultValues=e.group.includeDefaultValues;var r=e.toDatalessObject(t);return e.includeDefaultValues=i,r});var n=e.Object.prototype.toDatalessObject.call(this,t);return n.objects=i,n},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=this.objectCaching&&(!this.group||this.needsItsOwnCache()||!this.group.isOnACache());if(this.ownCaching=t,t)for(var e=0,i=this._objects.length;e<i;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(this.shadow)return e.Object.prototype.willDrawShadow.call(this);for(var t=0,i=this._objects.length;t<i;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,i=this._objects.length;e<i;e++)this._objects[e].render(t)},isCacheDirty:function(){if(this.callSuper("isCacheDirty"))return!0;if(!this.statefullCache)return!1;for(var t=0,e=this._objects.length;t<e;t++)if(this._objects[t].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){var i=t.calcTransformMatrix(),r=e.util.qrDecompose(i),n=new e.Point(r.translateX,r.translateY);return t.flipX=!1,t.flipY=!1,t.set("scaleX",r.scaleX),t.set("scaleY",r.scaleY),t.skewX=r.skewX,t.skewY=r.skewY,t.angle=r.angle,t.setPositionByOrigin(n,"center","center"),t},_restoreObjectState:function(t){return this.realizeTransform(t),t.setCoords(),delete t.group,this},destroy:function(){return this._objects.forEach(function(t){t.set("dirty",!0)}),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,i=this.canvas;this._objects=[];var r=this.toObject();delete r.objects;var n=new e.ActiveSelection([]);return n.set(r),n.type="activeSelection",i.remove(this),t.forEach(function(t){t.group=n,t.dirty=!0,i.add(t)}),n.canvas=i,n._objects=t,i._activeObject=n,n.setCoords(),n}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords(!0,!0)}),this},_calcBounds:function(t){for(var e,i,r,n=[],s=[],o=["tr","br","bl","tl"],a=0,h=this._objects.length,c=o.length;a<h;++a)for((e=this._objects[a]).setCoords(!0),r=0;r<c;r++)i=o[r],n.push(e.oCoords[i].x),s.push(e.oCoords[i].y);this._getBounds(n,s,t)},_getBounds:function(t,n,s){var o=new e.Point(i(t),i(n)),a=new e.Point(r(t),r(n)),h=o.y||0,c=o.x||0,l=a.x-o.x||0,u=a.y-o.y||0;this.width=l,this.height=u,s||this.setPositionByOrigin({x:c,y:h},"left","top")},toSVG:function(t){var e=this._createBaseSVGMarkup();e.push("<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'" style="',this.getSvgFilter(),'">\n');for(var i=0,r=this._objects.length;i<r;i++)e.push("\t",this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){var n=e.util.object.clone(t,!0);delete n.objects,i&&i(new e.Group(r,n,!0))})})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,i){i=i||{},this._objects=t||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;i.originX&&(this.originX=i.originX),i.originY&&(this.originY=i.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,i),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var i=e.Object.prototype.toObject.call(this),r=new e.Group([]);if(delete i.type,r.set(i),t.forEach(function(t){t.canvas.remove(t),t.group=r}),r._objects=t,!this.canvas)return r;var n=this.canvas;return n.add(r),n._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(i=i||{}).hasControls&&(i.hasControls=!1),void 0===i.hasRotatingPoint&&(i.hasRotatingPoint=!1),i.forActiveSelection=!0;for(var r=0,n=this._objects.length;r<n;r++)this._objects[r]._renderControls(t,i);t.restore()}}),e.ActiveSelection.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.ActiveSelection(r,t,!0))})})}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=s.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?s.warn("fabric.Image is already defined."):(s.Image=s.util.createClass(s.Object,{type:"image",crossOrigin:"",strokeWidth:0,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:s.Object.prototype.stateProperties.concat("cropX","cropY"),objectCaching:!1,cacheKey:"",cropX:0,cropY:0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+s.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),this.resizeFilter&&this.applyResizeFilters(),0!==this.filters.length&&this.applyFilters(),this},removeTexture:function(t){var e=s.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){s.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,n=this.height;t.save(),this._setStrokeStyles(t,this),t.beginPath(),s.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),s.util.drawDashedLine(t,e+r,i,e+r,i+n,this.strokeDashArray),s.util.drawDashedLine(t,e+r,i+n,e,i+n,this.strokeDashArray),s.util.drawDashedLine(t,e,i+n,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){var i=[];this.filters.forEach(function(t){t&&i.push(t.toObject())});var r=e(this.callSuper("toObject",["crossOrigin","cropX","cropY"].concat(t)),{src:this.getSrc(),filters:i});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=-this.width/2,r=-this.height/2,n="";if(this.hasCrop()){var o=s.Object.__uid++;e.push('<clipPath id="imageCrop_'+o+'">\n','\t<rect x="'+i+'" y="'+r+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),n=' clip-path="url(#imageCrop_'+o+')" '}e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n');var a=["\t<image ",this.getSvgId(),'xlink:href="',this.getSvgSrc(!0),'" x="',i-this.cropX,'" y="',r-this.cropY,'" style="',this.getSvgStyles(),'" width="',this._element.width||this._element.naturalWidth,'" height="',this._element.height||this._element.height,'"',n,"></image>\n"];if("fill"===this.paintFirst&&Array.prototype.push.apply(e,a),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,e.push("\t<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=h}return"fill"!==this.paintFirst&&Array.prototype.push.apply(e,a),e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():e.src:this.src||""},setSrc:function(t,e,i){return s.util.loadImage(t,function(t){this.setElement(t,i),this._setWidthHeight(),e(this)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),r=i.scaleX,n=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||r>e&&n>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=n);s.filterBackend||(s.filterBackend=s.initFilterBackend());var a=s.util.createCanvasElement(),h=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,c=o.width,l=o.height;a.width=c,a.height=l,this._element=a,this._lastScaleX=t.scaleX=r,this._lastScaleY=t.scaleY=n,s.filterBackend.applyFilters([t],o,c,l,this._element,h),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter(function(t){return t&&!t.isNeutralState()}),this.group&&this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,i=e.naturalWidth||e.width,r=e.naturalHeight||e.height;if(this._element===this._originalElement){var n=s.util.createCanvasElement();n.width=i,n.height=r,this._element=n,this._filteredEl=n}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,r),this._lastScaleX=1,this._lastScaleY=1;return s.filterBackend||(s.filterBackend=s.initFilterBackend()),s.filterBackend.applyFilters(t,this._originalElement,i,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},_renderFill:function(t){var e=this.width,i=this.height,r=e*this._filterScalingX,n=i*this._filterScalingY,s=-e/2,o=-i/2,a=this._element;a&&t.drawImage(a,this.cropX*this._filterScalingX,this.cropY*this._filterScalingY,r,n,s,o,e,i)},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(s.util.getById(t),e),s.util.addClass(this.getElement(),s.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t&&t.length?s.util.enlivenObjects(t,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=s.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,r=this._element.height,n=1,o=1,a=0,h=0,c=0,l=0,u=this.width,f=this.height,d={width:u,height:f};return!e||"none"===e.alignX&&"none"===e.alignY?(n=u/i,o=f/r):("meet"===e.meetOrSlice&&(t=(u-i*(n=o=s.util.findScaleToFit(this._element,d)))/2,"Min"===e.alignX&&(a=-t),"Max"===e.alignX&&(a=t),t=(f-r*o)/2,"Min"===e.alignY&&(h=-t),"Max"===e.alignY&&(h=t)),"slice"===e.meetOrSlice&&(t=i-u/(n=o=s.util.findScaleToCover(this._element,d)),"Mid"===e.alignX&&(c=t/2),"Max"===e.alignX&&(c=t),t=r-f/o,"Mid"===e.alignY&&(l=t/2),"Max"===e.alignY&&(l=t),i=u/n,r=f/o)),{width:i,height:r,scaleX:n,scaleY:o,offsetLeft:a,offsetTop:h,cropX:c,cropY:l}}}),s.Image.CSS_CANVAS="canvas-img",s.Image.prototype.getSvgSrc=s.Image.prototype.getSrc,s.Image.fromObject=function(t,e){var i=s.util.object.clone(t);s.util.loadImage(i.src,function(t,r){r?e&&e(null,r):s.Image.prototype._initFilters.call(i,i.filters,function(r){i.filters=r||[],s.Image.prototype._initFilters.call(i,[i.resizeFilter],function(r){i.resizeFilter=r[0];var n=new s.Image(t,i);e(n)})})},null,i.crossOrigin)},s.Image.fromURL=function(t,e,i){s.util.loadImage(t,function(t){e&&e(new s.Image(t,i))},null,i&&i.crossOrigin)},s.Image.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin".split(" ")),s.Image.fromElement=function(t,i,r){var n=s.parseAttributes(t,s.Image.ATTRIBUTE_NAMES);s.Image.fromURL(n["xlink:href"],i,e(r?s.util.object.clone(r):{},n))})}("undefined"!=typeof exports?exports:this),s.util.object.extend(s.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){var e=function(){},i=(t=t||{}).onComplete||e,r=t.onChange||e,n=this;return s.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){n.rotate(t),r()},onComplete:function(){n.setCoords(),i()}}),this}}),s.util.object.extend(s.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";function t(t,e){var i="precision "+e+" float;\nvoid main(){}",r=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,i),t.compileShader(r),!!t.getShaderParameter(r,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}s.isWebglSupported=function(e){if(s.isLikelyNode)return!1;e=e||s.WebglFilterBackend.prototype.tileSize;var i=document.createElement("canvas"),r=i.getContext("webgl")||i.getContext("experimental-webgl"),n=!1;if(r){s.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),n=s.maxTextureSize>=e;for(var o=["highp","mediump","lowp"],a=0;a<3;a++)if(t(r,o[a])){s.webGlPrecision=o[a];break}}return this.isSupported=n,n},s.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var i,r=void 0!==window.performance;try{new ImageData(1,1),i=!0}catch(t){i=!1}var n="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(r&&i&&n&&o){var c,l,u=s.util.createCanvasElement(),f=new ArrayBuffer(t*e*4),d={imageBuffer:f,destinationWidth:t,destinationHeight:e,targetCanvas:u};u.width=t,u.height=e,c=window.performance.now(),a.call(d,this.gl,d),l=window.performance.now()-c,c=window.performance.now(),h.call(d,this.gl,d),l>window.performance.now()-c?(this.imageBuffer=f,this.copyGLTo2D=h):this.copyGLTo2D=a}},createWebGLCanvas:function(t,e){var i=s.util.createCanvasElement();i.width=t,i.height=e;var r={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},n=i.getContext("webgl",r);n||(n=i.getContext("experimental-webgl",r)),n&&(n.clearColor(0,0,0,0),this.canvas=i,this.gl=n)},applyFilters:function(t,e,i,r,n,s){var a,h=this.gl;s&&(a=this.getCachedTexture(s,e));var c={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:h,sourceTexture:this.createTexture(h,i,r,!a&&e),targetTexture:this.createTexture(h,i,r),originalTexture:a||this.createTexture(h,i,r,!a&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},l=h.createFramebuffer();return h.bindFramebuffer(h.FRAMEBUFFER,l),t.forEach(function(t){t&&t.applyTo(c)}),o(c),this.copyGLTo2D(h,c),h.bindTexture(h.TEXTURE_2D,null),h.deleteTexture(c.sourceTexture),h.deleteTexture(c.targetTexture),h.deleteFramebuffer(l),n.getContext("2d").setTransform(1,0,0,1,0,0),c},applyFiltersDebug:function(t,e,i,r,n,s){var o=this.gl,a=this.applyFilters(t,e,i,r,n,s),h=o.getError();if(h!==o.NO_ERROR){var c=this.glErrorToString(o,h),l=new Error("WebGL Error "+c);throw l.glErrorCode=h,l}return a},glErrorToString:function(t,e){if(!t)return"Context undefined for error code: "+e;if("number"!=typeof e)return"Error code is not a number";switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"UNKNOWN_ERROR"}},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,i,r){var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),n},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var i=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=i,i},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:a,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e=t.getExtension("WEBGL_debug_renderer_info"),i={renderer:"",vendor:""};if(e){var r=t.getParameter(e.UNMASKED_RENDERER_WEBGL),n=t.getParameter(e.UNMASKED_VENDOR_WEBGL);r&&(i.renderer=r.toLowerCase()),n&&(i.vendor=n.toLowerCase())}return this.gpuInfo=i,i}}}(),function(){"use strict";var t=function(){};function e(){}s.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,i,r,n){var s=n.getContext("2d");s.drawImage(e,0,0,i,r);var o={sourceWidth:i,sourceHeight:r,imageData:s.getImageData(0,0,i,r),originalEl:e,originalImageData:s.getImageData(0,0,i,r),canvasEl:n,ctx:s,filterBackend:this};return t.forEach(function(t){t.applyTo(o)}),o.imageData.width===i&&o.imageData.height===r||(n.width=o.imageData.width,n.height=o.imageData.height),s.putImageData(o.imageData,0,0),o}}}(),s.Image.filters=s.Image.filters||{},s.Image.filters.BaseFilter=s.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,i){e=e||this.fragmentSource,i=i||this.vertexSource,"highp"!==s.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+s.webGlPrecision+" float"));var r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r,i),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var n=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var o=t.createProgram();if(t.attachShader(o,r),t.attachShader(o,n),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(o));var a=this.getAttributeLocations(t,o),h=this.getUniformLocations(t,o)||{};return h.uStepW=t.getUniformLocation(o,"uStepW"),h.uStepH=t.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:a,uniformLocations:h}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,i){var r=e.aPosition,n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,i,r=t.context;t.passes>1?(e=t.destinationWidth,i=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===i||(r.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(r,e,i)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=s.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var i=e[t].length;i--;)if(this[t][i]!==e[t][i])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,i=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),s.Image.filters.BaseFilter.fromObject=function(t,e){var i=new s.Image.filters[t.type](t);return e&&e(i),i},function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.ColorMatrix=r(i.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,i,r,n,s,o=t.imageData.data,a=o.length,h=this.matrix,c=this.colorsOnly;for(s=0;s<a;s+=4)e=o[s],i=o[s+1],r=o[s+2],c?(o[s]=e*h[0]+i*h[1]+r*h[2]+255*h[4],o[s+1]=e*h[5]+i*h[6]+r*h[7]+255*h[9],o[s+2]=e*h[10]+i*h[11]+r*h[12]+255*h[14]):(n=o[s+3],o[s]=e*h[0]+i*h[1]+r*h[2]+n*h[3]+255*h[4],o[s+1]=e*h[5]+i*h[6]+r*h[7]+n*h[8]+255*h[9],o[s+2]=e*h[10]+i*h[11]+r*h[12]+n*h[13]+255*h[14],o[s+3]=e*h[15]+i*h[16]+r*h[17]+n*h[18]+255*h[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var i=this.matrix,r=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],n=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,r),t.uniform4fv(e.uConstants,n)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Brightness=r(i.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,i=t.imageData.data,r=i.length,n=Math.round(255*this.brightness);for(e=0;e<r;e+=4)i[e]=i[e]+n,i[e+1]=i[e+1]+n,i[e+2]=i[e+2]+n}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Convolute=n(r.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),i=this.type+"_"+e+"_"+(this.opaque?1:0),r=this.fragmentSource[i];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,r)),t.programCache[i]},applyTo2d:function(t){var e,i,r,n,s,o,a,h,c,l,u,f,d,g=t.imageData,p=g.data,v=this.matrix,m=Math.round(Math.sqrt(v.length)),_=Math.floor(m/2),y=g.width,x=g.height,b=t.ctx.createImageData(y,x),C=b.data,S=this.opaque?1:0;for(u=0;u<x;u++)for(l=0;l<y;l++){for(s=4*(u*y+l),e=0,i=0,r=0,n=0,d=0;d<m;d++)for(f=0;f<m;f++)o=l+f-_,(a=u+d-_)<0||a>x||o<0||o>y||(h=4*(a*y+o),c=v[d*m+f],e+=p[h]*c,i+=p[h+1]*c,r+=p[h+2]*c,S||(n+=p[h+3]*c));C[s]=e,C[s+1]=i,C[s+2]=r,C[s+3]=S?p[s+3]:n}t.imageData=b},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Grayscale=r(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,i,r=t.imageData.data,n=r.length,s=this.mode;for(e=0;e<n;e+=4)"average"===s?i=(r[e]+r[e+1]+r[e+2])/3:"lightness"===s?i=(Math.min(r[e],r[e+1],r[e+2])+Math.max(r[e],r[e+1],r[e+2]))/2:"luminosity"===s&&(i=.21*r[e]+.72*r[e+1]+.07*r[e+2]),r[e]=i,r[e+1]=i,r[e+2]=i},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var i=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,i)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Invert=r(i.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,i=t.imageData.data,r=i.length;for(e=0;e<r;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.Noise=n(r.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,i,r=t.imageData.data,n=r.length,s=this.noise;for(e=0,n=r.length;e<n;e+=4)i=(.5-Math.random())*s,r[e]+=i,r[e+1]+=i,r[e+2]+=i}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Pixelate=r(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,i,r,n,s,o,a,h,c,l,u,f=t.imageData,d=f.data,g=f.height,p=f.width;for(i=0;i<g;i+=this.blocksize)for(r=0;r<p;r+=this.blocksize)for(n=d[e=4*i*p+4*r],s=d[e+1],o=d[e+2],a=d[e+3],l=Math.min(i+this.blocksize,g),u=Math.min(r+this.blocksize,p),h=i;h<l;h++)for(c=r;c<u;c++)d[e=4*h*p+4*c]=n,d[e+1]=s,d[e+2]=o,d[e+3]=a},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.Image.filters,n=e.util.createClass;r.RemoveColor=n(r.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var i,r,n,s,o=t.imageData.data,a=255*this.distance,h=new e.Color(this.color).getSource(),c=[h[0]-a,h[1]-a,h[2]-a],l=[h[0]+a,h[1]+a,h[2]+a];for(i=0;i<o.length;i+=4)r=o[i],n=o[i+1],s=o[i+2],r>c[0]&&n>c[1]&&s>c[2]&&r<l[0]&&n<l[1]&&s<l[2]&&(o[i+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,i){var r=new e.Color(this.color).getSource(),n=parseFloat(this.distance),s=[0+r[0]/255-n,0+r[1]/255-n,0+r[2]/255-n,1],o=[r[0]/255+n,r[1]/255+n,r[2]/255+n,1];t.uniform4fv(i.uLow,s),t.uniform4fv(i.uHigh,o)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)i[s]=r(i.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),e.Image.filters[s].fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric,i=e.Image.filters,r=e.util.createClass;i.BlendColor=r(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,i=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(i)||(e=this.buildSource(this.mode),t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},applyTo2d:function(t){var i,r,n,s,o,a,h,c=t.imageData.data,l=c.length,u=1-this.alpha;i=(h=new e.Color(this.color).getSource())[0]*this.alpha,r=h[1]*this.alpha,n=h[2]*this.alpha;for(var f=0;f<l;f+=4)switch(s=c[f],o=c[f+1],a=c[f+2],this.mode){case"multiply":c[f]=s*i/255,c[f+1]=o*r/255,c[f+2]=a*n/255;break;case"screen":c[f]=255-(255-s)*(255-i)/255,c[f+1]=255-(255-o)*(255-r)/255,c[f+2]=255-(255-a)*(255-n)/255;break;case"add":c[f]=s+i,c[f+1]=o+r,c[f+2]=a+n;break;case"diff":case"difference":c[f]=Math.abs(s-i),c[f+1]=Math.abs(o-r),c[f+2]=Math.abs(a-n);break;case"subtract":c[f]=s-i,c[f+1]=o-r,c[f+2]=a-n;break;case"darken":c[f]=Math.min(s,i),c[f+1]=Math.min(o,r),c[f+2]=Math.min(a,n);break;case"lighten":c[f]=Math.max(s,i),c[f+1]=Math.max(o,r),c[f+2]=Math.max(a,n);break;case"overlay":c[f]=i<128?2*s*i/255:255-2*(255-s)*(255-i)/255,c[f+1]=r<128?2*o*r/255:255-2*(255-o)*(255-r)/255,c[f+2]=n<128?2*a*n/255:255-2*(255-a)*(255-n)/255;break;case"exclusion":c[f]=i+s-2*i*s/255,c[f+1]=r+o-2*r*o/255,c[f+2]=n+a-2*n*a/255;break;case"tint":c[f]=i+s*u,c[f+1]=r+o*u,c[f+2]=n+a*u}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,i){var r=new e.Color(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(i.uColor,r)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric,i=e.Image.filters,r=e.util.createClass;i.BlendImage=r(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,i)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,i=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]},applyTo2d:function(t){var i,r,n,s,o,a,h,c,l,u,f,d=t.imageData,g=t.filterBackend.resources,p=d.data,v=p.length,m=d.width,_=d.height,y=this.image;g.blendImage||(g.blendImage=e.util.createCanvasElement()),u=(l=g.blendImage).getContext("2d"),l.width!==m||l.height!==_?(l.width=m,l.height=_):u.clearRect(0,0,m,_),u.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),u.drawImage(y._element,0,0,m,_),f=u.getImageData(0,0,m,_).data;for(var x=0;x<v;x+=4)switch(o=p[x],a=p[x+1],h=p[x+2],c=p[x+3],i=f[x],r=f[x+1],n=f[x+2],s=f[x+3],this.mode){case"multiply":p[x]=o*i/255,p[x+1]=a*r/255,p[x+2]=h*n/255,p[x+3]=c*s/255;break;case"mask":p[x+3]=s}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,i){e.Image.fromObject(t.image,function(r){var n=e.util.object.clone(t);n.image=r,i(new e.Image.filters.BlendImage(n))})}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,n=Math.sqrt,s=Math.abs,o=Math.round,a=Math.sin,h=Math.ceil,c=e.Image.filters,l=e.util.createClass;c.Resize=l(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),i=this.type+"_"+e;if(!t.programCache.hasOwnProperty(i)){var r=this.generateShader(e);t.programCache[i]=this.createProgram(t.context,r)}return t.programCache[i]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),r=new Array(i),n=1;n<=i;n++)r[n-1]=t(n*e);return r},generateShader:function(t){for(var e=new Array(t),i=this.fragmentSourceTOP,r=1;r<=t;r++)e[r-1]=r+".0 * uDelta";return i+="uniform float uTaps["+t+"];\n",i+="void main() {\n",i+="  vec4 color = texture2D(uTexture, vTexCoord);\n",i+="  float sum = 1.0;\n",e.forEach(function(t,e){i+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",i+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",i+="  sum += 2.0 * uTaps["+e+"];\n"}),i+="  gl_FragColor = color / sum;\n",i+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;var i=(e*=Math.PI)/t;return a(e)/e*a(i)/i}},applyTo2d:function(t){var e=t.imageData,i=this.scaleX,r=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/r;var n,s=e.width,a=e.height,h=o(s*i),c=o(a*r);"sliceHack"===this.resizeType?n=this.sliceByTwo(t,s,a,h,c):"hermite"===this.resizeType?n=this.hermiteFastResize(t,s,a,h,c):"bilinear"===this.resizeType?n=this.bilinearFiltering(t,s,a,h,c):"lanczos"===this.resizeType&&(n=this.lanczosResize(t,s,a,h,c)),t.imageData=n},sliceByTwo:function(t,i,n,s,o){var a,h,c=t.imageData,l=!1,u=!1,f=.5*i,d=.5*n,g=e.filterBackend.resources,p=0,v=0,m=i,_=0;for(g.sliceByTwo||(g.sliceByTwo=document.createElement("canvas")),((a=g.sliceByTwo).width<1.5*i||a.height<n)&&(a.width=1.5*i,a.height=n),(h=a.getContext("2d")).clearRect(0,0,1.5*i,n),h.putImageData(c,0,0),s=r(s),o=r(o);!l||!u;)i=f,n=d,s<r(.5*f)?f=r(.5*f):(f=s,l=!0),o<r(.5*d)?d=r(.5*d):(d=o,u=!0),h.drawImage(a,p,v,i,n,m,_,f,d),p=m,v=_,_+=d;return h.getImageData(p,v,s,o)},lanczosResize:function(t,e,o,a,c){var l=t.imageData.data,u=t.ctx.createImageData(a,c),f=u.data,d=this.lanczosCreate(this.lanczosLobes),g=this.rcpScaleX,p=this.rcpScaleY,v=2/this.rcpScaleX,m=2/this.rcpScaleY,_=h(g*this.lanczosLobes/2),y=h(p*this.lanczosLobes/2),x={},b={},C={};return function t(h){var S,T,w,O,k,E,D,j,A,P,F;for(b.x=(h+.5)*g,C.x=r(b.x),S=0;S<c;S++){for(b.y=(S+.5)*p,C.y=r(b.y),k=0,E=0,D=0,j=0,A=0,T=C.x-_;T<=C.x+_;T++)if(!(T<0||T>=e)){P=r(1e3*s(T-b.x)),x[P]||(x[P]={});for(var M=C.y-y;M<=C.y+y;M++)M<0||M>=o||(F=r(1e3*s(M-b.y)),x[P][F]||(x[P][F]=d(n(i(P*v,2)+i(F*m,2))/1e3)),(w=x[P][F])>0&&(k+=w,E+=w*l[O=4*(M*e+T)],D+=w*l[O+1],j+=w*l[O+2],A+=w*l[O+3]))}f[O=4*(S*a+h)]=E/k,f[O+1]=D/k,f[O+2]=j/k,f[O+3]=A/k}return++h<a?t(h):u}(0)},bilinearFiltering:function(t,e,i,n,s){var o,a,h,c,l,u,f,d,g,p=0,v=this.rcpScaleX,m=this.rcpScaleY,_=4*(e-1),y=t.imageData.data,x=t.ctx.createImageData(n,s),b=x.data;for(h=0;h<s;h++)for(c=0;c<n;c++)for(l=v*c-(o=r(v*c)),u=m*h-(a=r(m*h)),g=4*(a*e+o),f=0;f<4;f++)d=y[g+f]*(1-l)*(1-u)+y[g+4+f]*l*(1-u)+y[g+_+f]*u*(1-l)+y[g+_+4+f]*l*u,b[p++]=d;return x},hermiteFastResize:function(t,e,i,o,a){for(var c=this.rcpScaleX,l=this.rcpScaleY,u=h(c/2),f=h(l/2),d=t.imageData.data,g=t.ctx.createImageData(o,a),p=g.data,v=0;v<a;v++)for(var m=0;m<o;m++){for(var _=4*(m+v*o),y=0,x=0,b=0,C=0,S=0,T=0,w=0,O=(v+.5)*l,k=r(v*l);k<(v+1)*l;k++)for(var E=s(O-(k+.5))/f,D=(m+.5)*c,j=E*E,A=r(m*c);A<(m+1)*c;A++){var P=s(D-(A+.5))/u,F=n(j+P*P);F>1&&F<-1||(y=2*F*F*F-3*F*F+1)>0&&(w+=y*d[(P=4*(A+k*e))+3],b+=y,d[P+3]<255&&(y=y*d[P+3]/250),C+=y*d[P],S+=y*d[P+1],T+=y*d[P+2],x+=y)}p[_]=C/x,p[_+1]=S/x,p[_+2]=T/x,p[_+3]=w/b}return g},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Contrast=r(i.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,i=t.imageData.data,r=i.length,n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(e=0;e<r;e+=4)i[e]=s*(i[e]-128)+128,i[e+1]=s*(i[e+1]-128)+128,i[e+2]=s*(i[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Saturation=r(i.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,i,r=t.imageData.data,n=r.length,s=-this.saturation;for(e=0;e<n;e+=4)i=Math.max(r[e],r[e+1],r[e+2]),r[e]+=i!==r[e]?(i-r[e])*s:0,r[e+1]+=i!==r[e+1]?(i-r[e+1])*s:0,r[e+2]+=i!==r[e+2]?(i-r[e+2])*s:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Blur=r(i.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var i,r,n=t.filterBackend.resources,s=t.imageData.width,o=t.imageData.height;n.blurLayer1||(n.blurLayer1=e.util.createCanvasElement(),n.blurLayer2=e.util.createCanvasElement()),i=n.blurLayer1,r=n.blurLayer2,i.width===s&&i.height===o||(r.width=i.width=s,r.height=i.height=o);var a,h,c,l,u=i.getContext("2d"),f=r.getContext("2d"),d=.06*this.blur*.5;for(u.putImageData(t.imageData,0,0),f.clearRect(0,0,s,o),l=-15;l<=15;l++)c=d*(h=l/15)*s+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(h),f.drawImage(i,c,a),u.drawImage(r,0,0),f.globalAlpha=1,f.clearRect(0,0,r.width,r.height);for(l=-15;l<=15;l++)c=d*(h=l/15)*o+(a=(Math.random()-.5)/4),f.globalAlpha=1-Math.abs(h),f.drawImage(i,a,c),u.drawImage(r,0,0),f.globalAlpha=1,f.clearRect(0,0,r.width,r.height);t.ctx.drawImage(i,0,0);var g=t.ctx.getImageData(0,0,i.width,i.height);return u.globalAlpha=1,u.clearRect(0,0,i.width,i.height),g},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var i=this.chooseRightDelta();t.uniform2fv(e.delta,i)},chooseRightDelta:function(){var t,e=1,i=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?i[0]=t:i[1]=t,i}}),i.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Gamma=r(i.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,i=t.imageData.data,r=this.gamma,n=i.length,s=1/r[0],o=1/r[1],a=1/r[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,n=256;e<n;e++)this.rVals[e]=255*Math.pow(e/255,s),this.gVals[e]=255*Math.pow(e/255,o),this.bVals[e]=255*Math.pow(e/255,a);for(e=0,n=i.length;e<n;e+=4)i[e]=this.rVals[i[e]],i[e+1]=this.gVals[i[e+1]],i[e+2]=this.bVals[i[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.Composed=r(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach(function(e){e.applyTo(t)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(t){return t.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(t){return!t.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(t,i){var r=(t.subFilters||[]).map(function(t){return new e.Image.filters[t.type](t)}),n=new e.Image.filters.Composed({subFilters:r});return i&&i(n),n}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,r=e.util.createClass;i.HueRotation=r(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,i=e.util.cos(t),r=e.util.sin(t),n=Math.sqrt(1/3)*r,s=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+s/3,this.matrix[1]=1/3*s-n,this.matrix[2]=1/3*s+n,this.matrix[5]=1/3*s+n,this.matrix[6]=i+1/3*s,this.matrix[7]=1/3*s-n,this.matrix[10]=1/3*s-n,this.matrix[11]=1/3*s+n,this.matrix[12]=i+1/3*s},isNeutralState:function(t){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone;e.Text?e.warn("fabric.Text is already defined"):(e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),cacheProperties:e.Object.prototype.cacheProperties.concat("fontFamily","fontWeight","fontSize","text","underline","overline","linethrough","textAlign","fontStyle","lineHeight","textBackgroundColor","charSpacing","styles"),stroke:null,shadow:null,_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,i,r,n,s,o,a=0,h=this._textLines.length;a<h;a++)if(("justify"===this.textAlign||a!==h-1&&!this.isEndOfWrapping(a))&&(r=0,n=this._textLines[a],(e=this.getLineWidth(a))<this.width&&(o=this.textLines[a].match(this._reSpacesAndTabs)))){i=o.length,t=(this.width-e)/i;for(var c=0,l=n.length;c<=l;c++)s=this.__charBounds[a][c],this._reSpaceAndTab.test(n[c])?(s.width+=t,s.kernedWidth+=t,s.left+=r,r+=t):s.left+=r}},isEndOfWrapping:function(t){return t===this._textLines.length-1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,i){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,i)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,i=this._textLines.length;e<i;e++){var r=this.getLineWidth(e);r>t&&(t=r)}return t},_renderTextLine:function(t,e,i,r,n,s){this._renderChars(t,e,i,r,n,s)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,i,r,n,s,o,a=0,h=t.fillStyle,c=this._getLeftOffset(),l=this._getTopOffset(),u=0,f=0,d=0,g=this._textLines.length;d<g;d++)if(e=this.getHeightOfLine(d),this.textBackgroundColor||this.styleHas("textBackgroundColor",d)){r=this._textLines[d],i=this._getLineLeftOffset(d),f=0,u=0,n=this.getValueOfPropertyAt(d,0,"textBackgroundColor");for(var p=0,v=r.length;p<v;p++)s=this.__charBounds[d][p],(o=this.getValueOfPropertyAt(d,p,"textBackgroundColor"))!==n?(t.fillStyle=n,n&&t.fillRect(c+i+u,l+a,f,e/this.lineHeight),u=s.left,f=s.width,n=o):f+=s.kernedWidth;o&&(t.fillStyle=o,t.fillRect(c+i+u,l+a,f,e/this.lineHeight)),a+=e}else a+=e;t.fillStyle=h,this._removeShadow(t)}},getFontCache:function(t){var i=t.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var r=e.charWidthsCache[i],n=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return r[n]||(r[n]={}),r[n]},_applyCharStyles:function(t,e,i,r,n){this._setFillStyles(e,n),this._setStrokeStyles(e,n),e.font=this._getFontDeclaration(n)},_measureChar:function(t,e,i,r){var n,s,o,a,h=this.getFontCache(e),c=i+t,l=this._getFontDeclaration(e)===this._getFontDeclaration(r),u=e.fontSize/this.CACHE_FONT_SIZE;if(i&&void 0!==h[i]&&(o=h[i]),void 0!==h[t]&&(a=n=h[t]),l&&void 0!==h[c]&&(a=(s=h[c])-o),void 0===n||void 0===o||void 0===s){var f=this.getMeasuringContext();this._setTextStyles(f,e,!0)}return void 0===n&&(a=n=f.measureText(t).width,h[t]=n),void 0===o&&l&&i&&(o=f.measureText(i).width,h[i]=o),l&&void 0===s&&(s=f.measureText(c).width,h[c]=s,a=s-o),{width:n*u,kernedWidth:a*u}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var e,i,r,n,s=0,o=this._textLines[t],a=new Array(o.length);for(this.__charBounds[t]=a,e=0;e<o.length;e++)i=o[e],n=this._getGraphemeBox(i,t,e,r),a[e]=n,s+=n.kernedWidth,r=i;return a[e]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize},{width:s,numOfSpaces:0}},_getGraphemeBox:function(t,e,i,r,n){var s,o=this.getCompleteStyleDeclaration(e,i),a=r?this.getCompleteStyleDeclaration(e,i-1):{},h=this._measureChar(t,o,r,a),c=h.kernedWidth,l=h.width;0!==this.charSpacing&&(l+=s=this._getWidthOfCharSpacing(),c+=s);var u={width:l,left:0,height:o.fontSize,kernedWidth:c,deltaY:o.deltaY};if(i>0&&!n){var f=this.__charBounds[e][i-1];u.left=f.left+f.width+h.kernedWidth-h.width}return u},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],i=this.getHeightOfChar(t,0),r=1,n=e.length;r<n;r++)i=Math.max(this.getHeightOfChar(t,r),i);return this.__lineHeights[t]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,i=0,r=this._textLines.length;i<r;i++)t=this.getHeightOfLine(i),e+=i===r-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var i=0,r=this._getLeftOffset(),n=this._getTopOffset(),s=this._applyPatternGradientTransform(t,"fillText"===e?this.fill:this.stroke),o=0,a=this._textLines.length;o<a;o++){var h=this.getHeightOfLine(o),c=h/this.lineHeight,l=this._getLineLeftOffset(o);this._renderTextLine(e,t,this._textLines[o],r+l-s.offsetX,n+i+c-s.offsetY,o),i+=h}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,i,r,n,s){var o,a,h,c,l=this.getHeightOfLine(s),u=-1!==this.textAlign.indexOf("justify"),f="",d=0,g=!u&&0===this.charSpacing&&this.isEmptyStyles(s);if(e.save(),n-=l*this._fontSizeFraction/this.lineHeight,g)return this._renderChar(t,e,s,0,this.textLines[s],r,n,l),void e.restore();for(var p=0,v=i.length-1;p<=v;p++)c=p===v||this.charSpacing,f+=i[p],h=this.__charBounds[s][p],0===d?(r+=h.kernedWidth-h.width,d+=h.width):d+=h.kernedWidth,u&&!c&&this._reSpaceAndTab.test(i[p])&&(c=!0),c||(o=o||this.getCompleteStyleDeclaration(s,p),a=this.getCompleteStyleDeclaration(s,p+1),c=this._hasStyleChanged(o,a)),c&&(this._renderChar(t,e,s,p,f,r,n,l),f="",o=a,r+=d,d=0);e.restore()},_renderChar:function(t,e,i,r,n,s,o){var a=this._getStyleDeclaration(i,r),h=this.getCompleteStyleDeclaration(i,r),c="fillText"===t&&h.fill,l="strokeText"===t&&h.stroke&&h.strokeWidth;(l||c)&&(a&&e.save(),this._applyCharStyles(t,e,i,r,h),a&&a.textBackgroundColor&&this._removeShadow(e),a&&a.deltaY&&(o+=a.deltaY),c&&e.fillText(n,s,o),l&&e.strokeText(n,s,o),a&&e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,i){var r=this.get2DCursorLocation(t,!0),n=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),o={fontSize:n*i.size,deltaY:s+n*i.baseline};return this.setSelectionStyles(o,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t);return"center"===this.textAlign?(this.width-e)/2:"right"===this.textAlign?this.width-e:"justify-center"===this.textAlign&&this.isEndOfWrapping(t)?(this.width-e)/2:"justify-right"===this.textAlign&&this.isEndOfWrapping(t)?this.width-e:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]?this.__lineWidths[t]:(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e,e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,i){var r=this._getStyleDeclaration(t,e);return r&&void 0!==r[i]?r[i]:this[i]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var i,r,n,s,o,a,h,c,l,u,f,d,g,p,v,m,_=this._getLeftOffset(),y=this._getTopOffset(),x=this._getWidthOfCharSpacing(),b=0,C=this._textLines.length;b<C;b++)if(i=this.getHeightOfLine(b),this[e]||this.styleHas(e,b)){h=this._textLines[b],p=i/this.lineHeight,s=this._getLineLeftOffset(b),u=0,f=0,c=this.getValueOfPropertyAt(b,0,e),m=this.getValueOfPropertyAt(b,0,"fill"),l=y+p*(1-this._fontSizeFraction),r=this.getHeightOfChar(b,0),o=this.getValueOfPropertyAt(b,0,"deltaY");for(var S=0,T=h.length;S<T;S++)d=this.__charBounds[b][S],g=this.getValueOfPropertyAt(b,S,e),v=this.getValueOfPropertyAt(b,S,"fill"),n=this.getHeightOfChar(b,S),a=this.getValueOfPropertyAt(b,S,"deltaY"),(g!==c||v!==m||n!==r||a!==o)&&f>0?(t.fillStyle=m,c&&m&&t.fillRect(_+s+u,l+this.offsets[e]*r+o,f,this.fontSize/15),u=d.left,f=d.width,c=g,m=v,r=n,o=a):f+=d.kernedWidth;t.fillStyle=v,g&&v&&t.fillRect(_+s+u,l+this.offsets[e]*r+o,f-x,this.fontSize/15),y+=i}else y+=i;this._removeShadow(t)}},_getFontDeclaration:function(t,i){var r=t||this,n=this.fontFamily,s=e.Text.genericFonts.indexOf(n.toLowerCase())>-1,o=void 0===n||n.indexOf("'")>-1||n.indexOf('"')>-1||s?r.fontFamily:'"'+r.fontFamily+'"';return[e.isLikelyNode?r.fontWeight:r.fontStyle,e.isLikelyNode?r.fontStyle:r.fontWeight,i?this.CACHE_FONT_SIZE+"px":r.fontSize+"px",o].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var i=t.split(this._reNewline),r=new Array(i.length),n=["\n"],s=[],o=0;o<i.length;o++)r[o]=e.util.string.graphemeSplit(i[o]),s=s.concat(r[o],n);return s.pop(),{_unwrappedLines:r,lines:i,graphemeText:s,graphemeLines:r}},toObject:function(t){var e=["text","fontSize","fontWeight","fontFamily","fontStyle","lineHeight","underline","overline","linethrough","textAlign","textBackgroundColor","charSpacing"].concat(t),r=this.callSuper("toObject",e);return r.styles=i(this.styles,!0),r},set:function(t,e){this.callSuper("set",t,e);var i=!1;if("object"===(void 0===t?"undefined":n(t)))for(var r in t)i=i||-1!==this._dimensionAffectingProps.indexOf(r);else i=-1!==this._dimensionAffectingProps.indexOf(t);return i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,r,n){if(!t)return r(null);var s=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),o=s.textAnchor||"left";if((n=e.util.object.extend(n?i(n):{},s)).top=n.top||0,n.left=n.left||0,s.textDecoration){var a=s.textDecoration;-1!==a.indexOf("underline")&&(n.underline=!0),-1!==a.indexOf("overline")&&(n.overline=!0),-1!==a.indexOf("line-through")&&(n.linethrough=!0),delete n.textDecoration}"dx"in s&&(n.left+=s.dx),"dy"in s&&(n.top+=s.dy),"fontSize"in n||(n.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var h="";"textContent"in t?h=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(h=t.firstChild.data),h=h.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=n.strokeWidth;n.strokeWidth=0;var l=new e.Text(h,n),u=l.getScaledHeight()/l.height,f=((l.height+l.strokeWidth)*l.lineHeight-l.height)*u,d=l.getScaledHeight()+f,g=0;"center"===o&&(g=l.getScaledWidth()/2),"right"===o&&(g=l.getScaledWidth()),l.set({left:l.left-g,top:l.top-(d-l.fontSize*(.07+l._fontSizeFraction))/l.lineHeight,strokeWidth:void 0!==c?c:1}),r(l)},e.Text.fromObject=function(t,i){return e.Object._fromObject("Text",t,i,"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text))}("undefined"!=typeof exports?exports:this),s.util.object.extend(s.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e=void 0===t?this.styles:{line:this.styles[t]};for(var i in e)for(var r in e[i])for(var n in e[i][r])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var i=void 0===e?this.styles:{line:this.styles[e]};for(var r in i)for(var n in i[r])if(void 0!==i[r][n][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,i,r=this.styles,n=0,s=!0,o=0;for(var a in r){for(var h in e=0,r[a]){var c;n++,(c=r[a][h]).hasOwnProperty(t)?(i?c[t]!==i&&(s=!1):i=c[t],c[t]===this[t]&&delete c[t]):s=!1,0!==Object.keys(c).length?e++:delete r[a][h]}0===e&&delete r[a]}for(var l=0;l<this._textLines.length;l++)o+=this._textLines[l].length;s&&n===o&&(this[t]=i,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,i,r,n=this.styles;for(i in n){for(r in e=n[i])delete e[r][t],0===Object.keys(e[r]).length&&delete e[r];0===Object.keys(e).length&&delete n[i]}}},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex,{}),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),s.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var i=e?this._unwrappedTextLines:this._textLines,r=i.length,n=0;n<r;n++){if(t<=i[n].length)return{lineIndex:n,charIndex:t};t-=i[n].length+1}return{lineIndex:n-1,charIndex:i[n-1].length<t?i[n-1].length:t}},getSelectionStyles:function(t,e,i){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var r=[],n=t;n<e;n++)r.push(this.getStyleAtPosition(n,i));return r},getStyleAtPosition:function(t,e){var i=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex))||{}},setSelectionStyles:function(t,e,i){void 0===e&&(e=this.selectionStart||0),void 0===i&&(i=this.selectionEnd||e);for(var r=e;r<i;r++)this._extendStyles(r,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var i=this.styles&&this.styles[t];return i?i[e]:null},getCompleteStyleDeclaration:function(t,e){for(var i,r=this._getStyleDeclaration(t,e)||{},n={},s=0;s<this._styleProperties.length;s++)n[i=this._styleProperties[s]]=void 0===r[i]?this[i]:r[i];return n},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return this.styles[t]},_setLineStyle:function(t,e){this.styles[t]=e},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}s.IText=s.util.createClass(s.Text,s.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,caching:!0,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas){var t,e=this._getCursorBoundaries();this.canvas&&this.canvas.contextTop?(t=this.canvas.contextTop,this.clearContextTop(!0)):(t=this.canvas.contextContainer).save(),this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),t.restore()}},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),i=this._getTopOffset(),r=this._getCursorBoundariesOffsets(t);return{left:e,top:i,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,i,r,n,s=0,o=0,a=this.get2DCursorLocation(t);r=a.charIndex,i=a.lineIndex;for(var h=0;h<i;h++)s+=this.getHeightOfLine(h);e=this._getLineLeftOffset(i);var c=this.__charBounds[i][r];return c&&(o=c.left),0!==this.charSpacing&&r===this._textLines[i].length&&(o-=this._getWidthOfCharSpacing()),n={top:s,left:e+(o>0?o:0)},this.cursorOffsetCache=n,this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),r=i.lineIndex,n=i.charIndex>0?i.charIndex-1:0,s=this.getValueOfPropertyAt(r,n,"fontSize"),o=this.scaleX*this.canvas.getZoom(),a=this.cursorWidth/o,h=t.topOffset,c=this.getValueOfPropertyAt(r,n,"deltaY");h+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-s*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.getValueOfPropertyAt(r,n,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-a/2,h+t.top+c,a,s)},renderSelection:function(t,e){for(var i=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=-1!==this.textAlign.indexOf("justify"),s=this.get2DCursorLocation(i),o=this.get2DCursorLocation(r),a=s.lineIndex,h=o.lineIndex,c=s.charIndex<0?0:s.charIndex,l=o.charIndex<0?0:o.charIndex,u=a;u<=h;u++){var f,d=this._getLineLeftOffset(u)||0,g=this.getHeightOfLine(u),p=0,v=0;if(u===a&&(p=this.__charBounds[a][c].left),u>=a&&u<h)v=n&&!this.isEndOfWrapping(u)?this.width:this.getLineWidth(u)||5;else if(u===h)if(0===l)v=this.__charBounds[h][l].left;else{var m=this._getWidthOfCharSpacing();v=this.__charBounds[h][l-1].left+this.__charBounds[h][l-1].width-m}f=g,(this.lineHeight<1||u===h&&this.lineHeight>1)&&(g/=this.lineHeight),this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",e.fillRect(t.left+d+p,t.top+t.topOffset+g,v-p,1)):(e.fillStyle=this.selectionColor,e.fillRect(t.left+d+p,t.top+t.topOffset,v-p,g)),t.topOffset+=f}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),s.IText.fromObject=function(e,i){if(t(e),e.styles)for(var r in e.styles)for(var n in e.styles[r])t(e.styles[r][n]);s.Object._fromObject("IText",e,i,"text")}}(),function(){var t=s.util.object.clone;s.util.object.extend(s.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))})},initRemovedHandler:function(){var t=this;this.on("removed",function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],s.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))})},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.__isMousedown=!1})},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,r){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){n.isAborted||t[r]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){e._tick()},i)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this._text[i])&&i<this.text.length;)e++,i++;return t+e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,r=this.text.charAt(i),n=/[ \n\.,;!\?\-]/;!n.test(r)&&i>0&&i<this.text.length;)i+=e,r=this.text.charAt(i);return n.test(r)&&"\n"!==r&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,r=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&i!==r||i!==e&&r!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===r||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,i){var r=i.slice(0,t),n=s.util.string.graphemeSplit(r).length;if(t===e)return{selectionStart:n,selectionEnd:n};var o=i.slice(t,e);return{selectionStart:n,selectionEnd:n+s.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(t,e,i){var r=i.slice(0,t).join("").length;return t===e?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+i.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),r=i.lineIndex,n=i.charIndex,o=this.getValueOfPropertyAt(r,n,"fontSize")*this.lineHeight,a=e.leftOffset,h=this.calcTransformMatrix(),c={x:e.left+a,y:e.top+e.topOffset+o},l=this.canvas.upperCanvasEl,u=l.width,f=l.height,d=u-o,g=f-o,p=l.clientWidth/u,v=l.clientHeight/f;return c=s.util.transformPoint(c,h),(c=s.util.transformPoint(c,this.canvas.viewportTransform)).x*=p,c.y*=v,c.x<0&&(c.x=0),c.x>d&&(c.x=d),c.y<0&&(c.y=0),c.y>g&&(c.y=g),c.x+=this.canvas._offset.left,c.y+=this.canvas._offset.top,{left:c.x+"px",top:c.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text;return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&(this.hiddenTextarea.blur&&this.hiddenTextarea.blur(),this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null),this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var i,r,n=this.get2DCursorLocation(t,!0),s=this.get2DCursorLocation(e,!0),o=n.lineIndex,a=n.charIndex,h=s.lineIndex,c=s.charIndex;if(o!==h){if(this.styles[o])for(i=a;i<this._unwrappedTextLines[o].length;i++)delete this.styles[o][i];if(this.styles[h])for(i=c;i<this._unwrappedTextLines[h].length;i++)(r=this.styles[h][i])&&(this.styles[o]||(this.styles[o]={}),this.styles[o][a+i-c]=r);for(i=o+1;i<=h;i++)delete this.styles[i];this.shiftLineStyles(h,o-h)}else if(this.styles[o]){r=this.styles[o];var l,u,f=c-a;for(i=a;i<c;i++)delete r[i];for(u in this.styles[o])(l=parseInt(u,10))>=c&&(r[l-f]=r[u],delete r[u])}},shiftLineStyles:function(e,i){var r=t(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>e&&(this.styles[s+i]=r[s],r[s-i]||delete this.styles[s])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,i,r,n){var s,o={},a=!1;for(var h in r||(r=1),this.shiftLineStyles(e,r),this.styles[e]&&(s=this.styles[e][0===i?i:i-1]),this.styles[e]){var c=parseInt(h,10);c>=i&&(a=!0,o[c-i]=this.styles[e][h],delete this.styles[e][h])}for(a?this.styles[e+r]=o:delete this.styles[e+r];r>1;)r--,n&&n[r]?this.styles[e+r]={0:t(n[r])}:s?this.styles[e+r]={0:t(s)}:delete this.styles[e+r];this._forceClearCache=!0},insertCharStyleObject:function(e,i,r,n){this.styles||(this.styles={});var s=this.styles[e],o=s?t(s):{};for(var a in r||(r=1),o){var h=parseInt(a,10);h>=i&&(s[h+r]=o[h],o[h-r]||delete s[h])}if(this._forceClearCache=!0,n)for(;r--;)Object.keys(n[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][i+r]=t(n[r]));else if(s)for(var c=s[i?i-1:1];c&&r--;)this.styles[e][i+r]=t(c)},insertNewStyleBlock:function(t,e,i){for(var r=this.get2DCursorLocation(e,!0),n=[0],s=0,o=0;o<t.length;o++)"\n"===t[o]?n[++s]=0:n[s]++;n[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,n[0],i),i=i&&i.slice(n[0]+1)),s&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+n[0],s);for(o=1;o<s;o++)n[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,n[o],i):i&&(this.styles[r.lineIndex+o][0]=i[0]),i=i&&i.slice(n[o]+1);n[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,n[o],i)},setSelectionStartEndWithShift:function(t,e,i){i<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),s.util.object.extend(s.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("mousedblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||this===this.canvas._activeObject&&(this.selected=!0)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){this.__isMousedown=!1,!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button||(this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,r=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,r,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),i=0,r=0,n=0,s=0,o=0,a=0,h=this._textLines.length;a<h&&n<=e.y;a++)n+=this.getHeightOfLine(a)*this.scaleY,o=a,a>0&&(s+=this._textLines[a-1].length+1);r=this._getLineLeftOffset(o)*this.scaleX;for(var c=0,l=this._textLines[o].length;c<l&&(i=r,(r+=this.__charBounds[o][c].kernedWidth*this.scaleX)<=e.x);c++)s++;return this._getNewSelectionStartFromOffset(e,i,r,s,l)},_getNewSelectionStartFromOffset:function(t,e,i,r,n){var s=t.x-e,o=i-t.x,a=r+(o>s||o<0?0:1);return this.flipX&&(a=n-a),a>this._text.length&&(a=this._text.length),a}}),s.util.object.extend(s.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=s.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingtop: "+t.fontSize+";",s.document.body.appendChild(this.hiddenTextarea),s.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),s.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),s.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),s.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),s.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),s.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),s.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),s.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),s.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(s.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing&&!this.inCompositionMode){if(t.keyCode in this.keysMap)this[this.keysMap[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey)))return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var i,r,n=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,a=n.length,h=a-o;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var c=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),l=this.selectionStart>c.selectionStart;this.selectionStart!==this.selectionEnd?(i=this._text.slice(this.selectionStart,this.selectionEnd),h+=this.selectionEnd-this.selectionStart):a<o&&(i=l?this._text.slice(this.selectionEnd+h,this.selectionEnd):this._text.slice(this.selectionStart,this.selectionStart-h)),r=n.slice(c.selectionEnd-h,c.selectionEnd),i&&i.length&&(this.selectionStart!==this.selectionEnd?this.removeStyleFromTo(this.selectionStart,this.selectionEnd):l?this.removeStyleFromTo(this.selectionEnd-i.length,this.selectionEnd):this.removeStyleFromTo(this.selectionEnd,this.selectionEnd+i.length)),r.length&&(e&&r.join("")===s.copiedText?this.insertNewStyleBlock(r,this.selectionStart,s.copiedTextStyle):this.insertNewStyleBlock(r,this.selectionStart)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(s.copiedText=this.getSelectedText(),s.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||s.window.clipboardData},_getWidthBeforeCursor:function(t,e){var i,r=this._getLineLeftOffset(t);return e>0&&(r+=(i=this.__charBounds[t][e-1]).left+i.width),r},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(n===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,o);return this._textLines[n].slice(s).length+a+2},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),r=this.get2DCursorLocation(i),n=r.lineIndex;if(0===n||t.metaKey||33===t.keyCode)return-i;var s=r.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,o),h=this._textLines[n].slice(0,s);return-this._textLines[n-1].length+a-h.length},_getIndexOnLine:function(t,e){for(var i,r,n=this._textLines[t],s=this._getLineLeftOffset(t),o=0,a=0,h=n.length;a<h;a++)if((s+=i=this.__charBounds[t][a].width)>e){r=!0;var c=s-i,l=s,u=Math.abs(c-e);o=Math.abs(l-e)<u?a:a-1;break}return r||(o=n.length-1),o},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var i=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),0!==i&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var r;if(t.altKey)r=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;r=this["findLineBoundary"+i](this[e])}if(void 0!==(void 0===r?"undefined":n(r))&&this[e]!==r)return this[e]=r,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var i="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?i+="Shift":i+="outShift",this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){void 0===e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,i,r){void 0===r&&(r=i),r>i&&this.removeStyleFromTo(i,r);var n=s.util.string.graphemeSplit(t);this.insertNewStyleBlock(n,i,e),this._text=[].concat(this._text.slice(0,i),n,this._text.slice(r)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var t=s.util.toFixed,e=/  +/g;s.util.object.extend(s.Text.prototype,{toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(),r=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e,r),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t,e){var i=this.getSvgFilter(),r=""===i?"":' style="'+i+'"',n=this.getSvgTextDecoration(this);t.push("\t<g ",this.getSvgId(),'transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"',r,">\n",e.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(t,e){var i,r=[],n=[],s=t;this._setSVGBg(n);for(var o=0,a=this._textLines.length;o<a;o++)i=this._getLineLeftOffset(o),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+i,s),this._setSVGTextLineText(r,o,e+i,s),s+=this.getHeightOfLine(o);return{textSpans:r,textBgRects:n}},_createTextCharSpan:function(i,r,n,o){var a=i!==i.trim()||i.match(e),h=this.getSvgSpanStyles(r,a),c=h?'style="'+h+'"':"",l=r.deltaY,u="",f=s.Object.NUM_FRACTION_DIGITS;return l&&(u=' dy="'+t(l,f)+'" '),['<tspan x="',t(n,f),'" y="',t(o,f),'" ',u,c,">",s.util.string.escapeXml(i),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,i,r){var n,s,o,a,h,c=this.getHeightOfLine(e),l=-1!==this.textAlign.indexOf("justify"),u="",f=0,d=this._textLines[e];r+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var g=0,p=d.length-1;g<=p;g++)h=g===p||this.charSpacing,u+=d[g],o=this.__charBounds[e][g],0===f?(i+=o.kernedWidth-o.width,f+=o.width):f+=o.kernedWidth,l&&!h&&this._reSpaceAndTab.test(d[g])&&(h=!0),h||(n=n||this.getCompleteStyleDeclaration(e,g),s=this.getCompleteStyleDeclaration(e,g+1),h=this._hasStyleChangedForSvg(n,s)),h&&(a=this._getStyleDeclaration(e,g)||{},t.push(this._createTextCharSpan(u,a,i,r)),u="",n=s,i+=f,f=0)},_pushTextBgRect:function(e,i,r,n,o,a){var h=s.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(i),' x="',t(r,h),'" y="',t(n,h),'" width="',t(o,h),'" height="',t(a,h),'"></rect>\n')},_setSVGTextLineBg:function(t,e,i,r){for(var n,s,o=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight,h=0,c=0,l=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),u=0,f=o.length;u<f;u++)n=this.__charBounds[e][u],(s=this.getValueOfPropertyAt(e,u,"textBackgroundColor"))!==l?(l&&this._pushTextBgRect(t,l,i+c,r,h,a),c=n.left,h=n.width,l=s):h+=n.kernedWidth;s&&this._pushTextBgRect(t,s,i+c,r,h,a)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new s.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,i=0,r=0;r<t;r++)i+=this.getHeightOfLine(r);return e=this.getHeightOfLine(r),{lineTop:i,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return s.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,i=0,r=0,n={},s=0;s<t.graphemeLines.length;s++)"\n"===t.graphemeText[r]&&s>0?(i=0,r++,e++):this._reSpaceAndTab.test(t.graphemeText[r])&&s>0&&(i++,r++),n[s]={line:e,offset:i},r+=t.graphemeLines[s].length,i+=t.graphemeLines[s].length;return n},styleHas:function(t,i){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[i];r&&(i=r.line)}return e.Text.prototype.styleHas.call(this,t,i)},isEmptyStyles:function(t){var e,i,r=0,n=!1,s=this._styleMap[t],o=this._styleMap[t+1];for(var a in s&&(t=s.line,r=s.offset),o&&(n=o.line===t,e=o.offset),i=void 0===t?this.styles:{line:this.styles[t]})for(var h in i[a])if(h>=r&&(!n||h<e))for(var c in i[a][h])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[t];if(!i)return null;t=i.line,e=i.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,i){var r=this._styleMap[t];t=r.line,e=r.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return this.styles[e.line]},_setLineStyle:function(t,e){var i=this._styleMap[t];this.styles[i.line]=e},_deleteLineStyle:function(t){var e=this._styleMap[t];delete this.styles[e.line]},_wrapText:function(t,e){var i,r=[];for(this.isWrapping=!0,i=0;i<t.length;i++)r=r.concat(this._wrapLine(t[i],i,e));return this.isWrapping=!1,r},_measureWord:function(t,e,i){var r,n=0;i=i||0;for(var s=0,o=t.length;s<o;s++){n+=this._getGraphemeBox(t[s],e,s+i,r,!0).kernedWidth,r=t[s]}return n},_wrapLine:function(t,i,r,n){var s=0,o=[],a=[],h=t.split(this._reSpaceAndTab),c="",l=0,u=0,f=0,d=0,g=!0,p=this._getWidthOfCharSpacing();r-=n=n||0;for(var v=0;v<h.length;v++)c=e.util.string.graphemeSplit(h[v]),u=this._measureWord(c,i,l),l+=c.length,(s+=f+u-p)>=r&&!g?(o.push(a),a=[],s=u,g=!0):s+=p,g||a.push(" "),a=a.concat(c),f=this._measureWord([" "],i,l),l++,g=!1,u>d&&(d=u);return v&&o.push(a),d+n>this.dynamicMinWidth&&(this.dynamicMinWidth=d-p+n),o},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},_splitTextIntoLines:function(t){for(var i=e.Text.prototype._splitTextIntoLines.call(this,t),r=this._wrapText(i.lines,this.width),n=new Array(r.length),s=0;s<r.length;s++)n[s]=r[s].join("");return i.lines=n,i.graphemeLines=r,i},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},toObject:function(t){return this.callSuper("toObject",["minWidth"].concat(t))}}),e.Textbox.fromObject=function(t,i){return e.Object._fromObject("Textbox",t,i,"text")}}("undefined"!=typeof exports?exports:this),function(){var t=s.Canvas.prototype._setObjectScale;s.Canvas.prototype._setObjectScale=function(e,i,r,n,o,a,h){var c=i.target;if(!("x"===o&&c instanceof s.Textbox))return t.call(s.Canvas.prototype,e,i,r,n,o,a,h);var l=c._getTransformedDimensions().x,u=c.width*(e.x/l);return u>=c.getMinWidth()?(c.set("width",u),!0):void 0},s.util.object.extend(s.Textbox.prototype,{_removeExtraneousStyles:function(){for(var t in this._styleMap)this._textLines[t]||delete this.styles[this._styleMap[t].line]}})}();
},{"jsdom":"VUpU","jsdom/lib/jsdom/living/generated/utils":"VUpU","jsdom/lib/jsdom/utils":"VUpU","xmldom":"VUpU","buffer":"iFYY","process":"oJsy"}],"7aRT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=u,exports.__awaiter=i,exports.__generator=c,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__await=y,exports.__asyncGenerator=_,exports.__asyncDelegator=h,exports.__asyncValues=b,exports.__makeTemplateObject=v,exports.__importStar=d,exports.__importDefault=w;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=exports.__assign=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,u=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(u=(a<3?o(u):a>3?o(e,r,u):o(e,r))||u);return a>3&&u&&Object.defineProperty(e,r,u),u}function a(t,e){return function(r,n){e(r,n,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function i(t,e,r,n){return new(r||(r=Promise))(function(o,a){function u(t){try{c(n.next(t))}catch(t){a(t)}}function i(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,i)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,n=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(t,u)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return u}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function _(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||i(t,e)})})}function i(t,e){try{(r=o[t](e)).value instanceof y?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(t){l(a[0][3],t)}var r}function c(t){i("next",t)}function f(t){i("throw",t)}function l(t,e){t(e),a.shift(),a.length&&i(a[0][0],a[0][1])}}function h(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:y(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof l?l(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function v(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}
},{}],"gOFo":[function(require,module,exports) {
"use strict";function e(e){return"function"==typeof e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFunction=e;
},{}],"QqL1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=!1,r=exports.config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){r&&(new Error).stack;e=r},get useDeprecatedSynchronousErrorHandling(){return e}};
},{}],"xwYc":[function(require,module,exports) {
"use strict";function e(e){setTimeout(function(){throw e})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.hostReportError=e;
},{}],"wJ/5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.empty=void 0;var e=require("./config"),r=require("./util/hostReportError"),o=exports.empty={closed:!0,next:function(e){},error:function(o){if(e.config.useDeprecatedSynchronousErrorHandling)throw o;(0,r.hostReportError)(o)},complete:function(){}};
},{"./config":"QqL1","./util/hostReportError":"xwYc"}],"xunG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=exports.isArray=Array.isArray||function(r){return r&&"number"==typeof r.length};
},{}],"e4je":[function(require,module,exports) {
"use strict";function e(e){return null!=e&&"object"==typeof e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObject=e;
},{}],"IhTn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.errorObject={e:{}};
},{}],"BwKY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tryCatch=c;var r,e=require("./errorObject");function t(){try{return r.apply(this,arguments)}catch(r){return e.errorObject.e=r,e.errorObject}}function c(e){return r=e,t}
},{"./errorObject":"IhTn"}],"IbVU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnsubscriptionError=void 0;var r=require("tslib"),t=e(r);function e(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}var n=function(r){function e(t){var n=r.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(r,t){return t+1+") "+r.toString()}).join("\n  "):"")||this;return n.errors=t,n.name="UnsubscriptionError",Object.setPrototypeOf(n,e.prototype),n}return t.__extends(e,r),e}(Error);exports.UnsubscriptionError=n;
},{"tslib":"7aRT"}],"mK8y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subscription=void 0;var r=require("./util/isArray"),t=require("./util/isObject"),i=require("./util/isFunction"),e=require("./util/tryCatch"),s=require("./util/errorObject"),n=require("./util/UnsubscriptionError"),o=function(){function o(r){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,r&&(this._unsubscribe=r)}var c;return o.prototype.unsubscribe=function(){var o,c=!1;if(!this.closed){var a=this._parent,p=this._parents,b=this._unsubscribe,h=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var l=-1,f=p?p.length:0;a;)a.remove(this),a=++l<f&&p[l]||null;if((0,i.isFunction)(b))(0,e.tryCatch)(b).call(this)===s.errorObject&&(c=!0,o=o||(s.errorObject.e instanceof n.UnsubscriptionError?u(s.errorObject.e.errors):[s.errorObject.e]));if((0,r.isArray)(h))for(l=-1,f=h.length;++l<f;){var d=h[l];if((0,t.isObject)(d))if((0,e.tryCatch)(d.unsubscribe).call(d)===s.errorObject){c=!0,o=o||[];var _=s.errorObject.e;_ instanceof n.UnsubscriptionError?o=o.concat(u(_.errors)):o.push(_)}}if(c)throw new n.UnsubscriptionError(o)}},o.prototype.add=function(r){if(!r||r===o.EMPTY)return o.EMPTY;if(r===this)return this;var t=r;switch(typeof r){case"function":t=new o(r);case"object":if(t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if("function"!=typeof t._addParent){var i=t;(t=new o)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(t),t._addParent(this),t},o.prototype.remove=function(r){var t=this._subscriptions;if(t){var i=t.indexOf(r);-1!==i&&t.splice(i,1)}},o.prototype._addParent=function(r){var t=this._parent,i=this._parents;t&&t!==r?i?-1===i.indexOf(r)&&i.push(r):this._parents=[r]:this._parent=r},o.EMPTY=((c=new o).closed=!0,c),o}();function u(r){return r.reduce(function(r,t){return r.concat(t instanceof n.UnsubscriptionError?t.errors:t)},[])}exports.Subscription=o;
},{"./util/isArray":"xunG","./util/isObject":"e4je","./util/isFunction":"gOFo","./util/tryCatch":"BwKY","./util/errorObject":"IhTn","./util/UnsubscriptionError":"IbVU"}],"Y6DT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=exports.rxSubscriber="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("rxSubscriber"):"@@rxSubscriber",e=exports.$$rxSubscriber=r;
},{}],"Qs1E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subscriber=void 0;var r=require("tslib"),t=u(r),e=require("./util/isFunction"),n=require("./Observer"),s=require("./Subscription"),i=require("../internal/symbol/rxSubscriber"),o=require("./config"),c=require("./util/hostReportError");function u(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}var p=function(r){function e(t,e,s){var o=r.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=n.empty;break;case 1:if(!t){o.destination=n.empty;break}if("object"==typeof t){if(b(t)){var c=t[i.rxSubscriber]();o.syncErrorThrowable=c.syncErrorThrowable,o.destination=c,c.add(o)}else o.syncErrorThrowable=!0,o.destination=new h(o,t);break}default:o.syncErrorThrowable=!0,o.destination=new h(o,t,e,s)}return o}return t.__extends(e,r),e.prototype[i.rxSubscriber]=function(){return this},e.create=function(r,t,n){var s=new e(r,t,n);return s.syncErrorThrowable=!1,s},e.prototype.next=function(r){this.isStopped||this._next(r)},e.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){this.destination.error(r),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var r=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=r,this._parents=t,this},e}(s.Subscription);exports.Subscriber=p;var h=function(r){function s(t,s,i,o){var c,u=r.call(this)||this;u._parentSubscriber=t;var p=u;return(0,e.isFunction)(s)?c=s:s&&(c=s.next,i=s.error,o=s.complete,s!==n.empty&&(p=Object.create(s),(0,e.isFunction)(p.unsubscribe)&&u.add(p.unsubscribe.bind(p)),p.unsubscribe=u.unsubscribe.bind(u))),u._context=p,u._next=c,u._error=i,u._complete=o,u}return t.__extends(s,r),s.prototype.next=function(r){if(!this.isStopped&&this._next){var t=this._parentSubscriber;o.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,r)&&this.unsubscribe():this.__tryOrUnsub(this._next,r)}},s.prototype.error=function(r){if(!this.isStopped){var t=this._parentSubscriber,e=o.config.useDeprecatedSynchronousErrorHandling;if(this._error)e&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,r),this.unsubscribe()):(this.__tryOrUnsub(this._error,r),this.unsubscribe());else if(t.syncErrorThrowable)e?(t.syncErrorValue=r,t.syncErrorThrown=!0):(0,c.hostReportError)(r),this.unsubscribe();else{if(this.unsubscribe(),e)throw r;(0,c.hostReportError)(r)}}},s.prototype.complete=function(){var r=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var e=function(){return r._complete.call(r._context)};o.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},s.prototype.__tryOrUnsub=function(r,t){try{r.call(this._context,t)}catch(r){if(this.unsubscribe(),o.config.useDeprecatedSynchronousErrorHandling)throw r;(0,c.hostReportError)(r)}},s.prototype.__tryOrSetError=function(r,t,e){if(!o.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,e)}catch(t){return o.config.useDeprecatedSynchronousErrorHandling?(r.syncErrorValue=t,r.syncErrorThrown=!0,!0):((0,c.hostReportError)(t),!0)}return!1},s.prototype._unsubscribe=function(){var r=this._parentSubscriber;this._context=null,this._parentSubscriber=null,r.unsubscribe()},s}(p);function b(r){return r instanceof p||"syncErrorThrowable"in r&&r[i.rxSubscriber]}
},{"tslib":"7aRT","./util/isFunction":"gOFo","./Observer":"wJ/5","./Subscription":"mK8y","../internal/symbol/rxSubscriber":"Y6DT","./config":"QqL1","./util/hostReportError":"xwYc"}],"wi6F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toSubscriber=i;var r=require("../Subscriber"),e=require("../symbol/rxSubscriber"),b=require("../Observer");function i(i,u,s){if(i){if(i instanceof r.Subscriber)return i;if(i[e.rxSubscriber])return i[e.rxSubscriber]()}return i||u||s?new r.Subscriber(i,u,s):new r.Subscriber(b.empty)}
},{"../Subscriber":"Qs1E","../symbol/rxSubscriber":"Y6DT","../Observer":"wJ/5"}],"xulG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.observable="function"==typeof Symbol&&Symbol.observable||"@@observable";
},{}],"BUGg":[function(require,module,exports) {
"use strict";function e(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.noop=e;
},{}],"RCIL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pipe=r,exports.pipeFromArray=n;var e=require("./noop");function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(e)}function n(r){return r?1===r.length?r[0]:function(e){return r.reduce(function(e,r){return r(e)},e)}:e.noop}
},{"./noop":"BUGg"}],"B88x":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Observable=void 0;var r=require("./util/toSubscriber"),e=require("../internal/symbol/observable"),o=require("./util/pipe"),t=require("./config"),n=function(){function n(r){this._isScalar=!1,r&&(this._subscribe=r)}return n.prototype.lift=function(r){var e=new n;return e.source=this,e.operator=r,e},n.prototype.subscribe=function(e,o,n){var i=this.operator,s=(0,r.toSubscriber)(e,o,n);if(i?i.call(s,this.source):s.add(this.source||t.config.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),t.config.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},n.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(e){t.config.useDeprecatedSynchronousErrorHandling&&(r.syncErrorThrown=!0,r.syncErrorValue=e),r.error(e)}},n.prototype.forEach=function(r,e){var o=this;return new(e=i(e))(function(e,t){var n;n=o.subscribe(function(e){try{r(e)}catch(r){t(r),n&&n.unsubscribe()}},t,e)})},n.prototype._subscribe=function(r){var e=this.source;return e&&e.subscribe(r)},n.prototype[e.observable]=function(){return this},n.prototype.pipe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return 0===r.length?this:(0,o.pipeFromArray)(r)(this)},n.prototype.toPromise=function(r){var e=this;return new(r=i(r))(function(r,o){var t;e.subscribe(function(r){return t=r},function(r){return o(r)},function(){return r(t)})})},n.create=function(r){return new n(r)},n}();function i(r){if(r||(r=t.config.Promise||Promise),!r)throw new Error("no Promise impl found");return r}exports.Observable=n;
},{"./util/toSubscriber":"wi6F","../internal/symbol/observable":"xulG","./util/pipe":"RCIL","./config":"QqL1"}],"6hpt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectUnsubscribedError=void 0;var r=require("tslib"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var o=function(r){function t(){var e=r.call(this,"object unsubscribed")||this;return e.name="ObjectUnsubscribedError",Object.setPrototypeOf(e,t.prototype),e}return e.__extends(t,r),t}(Error);exports.ObjectUnsubscribedError=o;
},{"tslib":"7aRT"}],"+m/+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectSubscription=void 0;var e=require("tslib"),t=s(e),r=require("./Subscription");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var i=function(e){function r(t,r){var s=e.call(this)||this;return s.subject=t,s.subscriber=r,s.closed=!1,s}return t.__extends(r,e),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},r}(r.Subscription);exports.SubjectSubscription=i;
},{"tslib":"7aRT","./Subscription":"mK8y"}],"NfWW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnonymousSubject=exports.Subject=exports.SubjectSubscriber=void 0;var r=require("tslib"),t=c(r),e=require("./Observable"),s=require("./Subscriber"),o=require("./Subscription"),i=require("./util/ObjectUnsubscribedError"),n=require("./SubjectSubscription"),u=require("../internal/symbol/rxSubscriber");function c(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}var b=function(r){function e(t){var e=r.call(this,t)||this;return e.destination=t,e}return t.__extends(e,r),e}(s.Subscriber);exports.SubjectSubscriber=b;var p=function(r){function s(){var t=r.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return t.__extends(s,r),s.prototype[u.rxSubscriber]=function(){return new b(this)},s.prototype.lift=function(r){var t=new h(this,this);return t.operator=r,t},s.prototype.next=function(r){if(this.closed)throw new i.ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,e=t.length,s=t.slice(),o=0;o<e;o++)s[o].next(r)},s.prototype.error=function(r){if(this.closed)throw new i.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=r,this.isStopped=!0;for(var t=this.observers,e=t.length,s=t.slice(),o=0;o<e;o++)s[o].error(r);this.observers.length=0},s.prototype.complete=function(){if(this.closed)throw new i.ObjectUnsubscribedError;this.isStopped=!0;for(var r=this.observers,t=r.length,e=r.slice(),s=0;s<t;s++)e[s].complete();this.observers.length=0},s.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},s.prototype._trySubscribe=function(t){if(this.closed)throw new i.ObjectUnsubscribedError;return r.prototype._trySubscribe.call(this,t)},s.prototype._subscribe=function(r){if(this.closed)throw new i.ObjectUnsubscribedError;return this.hasError?(r.error(this.thrownError),o.Subscription.EMPTY):this.isStopped?(r.complete(),o.Subscription.EMPTY):(this.observers.push(r),new n.SubjectSubscription(this,r))},s.prototype.asObservable=function(){var r=new e.Observable;return r.source=this,r},s.create=function(r,t){return new h(r,t)},s}(e.Observable);exports.Subject=p;var h=function(r){function e(t,e){var s=r.call(this)||this;return s.destination=t,s.source=e,s}return t.__extends(e,r),e.prototype.next=function(r){var t=this.destination;t&&t.next&&t.next(r)},e.prototype.error=function(r){var t=this.destination;t&&t.error&&this.destination.error(r)},e.prototype.complete=function(){var r=this.destination;r&&r.complete&&this.destination.complete()},e.prototype._subscribe=function(r){return this.source?this.source.subscribe(r):o.Subscription.EMPTY},e}(p);exports.AnonymousSubject=h;
},{"tslib":"7aRT","./Observable":"B88x","./Subscriber":"Qs1E","./Subscription":"mK8y","./util/ObjectUnsubscribedError":"6hpt","./SubjectSubscription":"+m/+","../internal/symbol/rxSubscriber":"Y6DT"}],"bnAO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.refCount=c;var n=require("tslib"),e=r(n),t=require("../Subscriber");function r(n){if(n&&n.__esModule)return n;var e={};if(null!=n)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function c(){return function(n){return n.lift(new o(n))}}var o=function(){function n(n){this.connectable=n}return n.prototype.call=function(n,e){var t=this.connectable;t._refCount++;var r=new i(n,t),c=e.subscribe(r);return r.closed||(r.connection=t.connect()),c},n}(),i=function(n){function t(e,t){var r=n.call(this,e)||this;return r.connectable=t,r}return e.__extends(t,n),t.prototype._unsubscribe=function(){var n=this.connectable;if(n){this.connectable=null;var e=n._refCount;if(e<=0)this.connection=null;else if(n._refCount=e-1,e>1)this.connection=null;else{var t=this.connection,r=n._connection;this.connection=null,!r||t&&r!==t||r.unsubscribe()}}else this.connection=null},t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"GCtA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.connectableObservableDescriptor=exports.ConnectableObservable=void 0;var e=require("tslib"),t=u(e),n=require("../Subject"),r=require("../Observable"),o=require("../Subscriber"),c=require("../Subscription"),i=require("../operators/refCount");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var s=function(e){function n(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return t.__extends(n,e),n.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},n.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new c.Subscription).add(this.source.subscribe(new a(this.getSubject(),this))),e.closed?(this._connection=null,e=c.Subscription.EMPTY):this._connection=e),e},n.prototype.refCount=function(){return(0,i.refCount)()(this)},n}(r.Observable);exports.ConnectableObservable=s;var l=s.prototype,b=exports.connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:l._subscribe},_isComplete:{value:l._isComplete,writable:!0},getSubject:{value:l.getSubject},connect:{value:l.connect},refCount:{value:l.refCount}},a=function(e){function n(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return t.__extends(n,e),n.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},n}(n.SubjectSubscriber),p=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new _(e,n),o=t.subscribe(r);return r.closed||(r.connection=n.connect()),o},e}(),_=function(e){function n(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return t.__extends(n,e),n.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},n}(o.Subscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../Observable":"B88x","../Subscriber":"Qs1E","../Subscription":"mK8y","../operators/refCount":"bnAO"}],"pn8u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GroupedObservable=void 0,exports.groupBy=u;var t=require("tslib"),e=s(t),r=require("../Subscriber"),o=require("../Subscription"),i=require("../Observable"),n=require("../Subject");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t,e,r,o){return function(i){return i.lift(new c(t,e,r,o))}}var c=function(){function t(t,e,r,o){this.keySelector=t,this.elementSelector=e,this.durationSelector=r,this.subjectSelector=o}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),l=function(t){function r(e,r,o,i,n){var s=t.call(this,e)||this;return s.keySelector=r,s.elementSelector=o,s.durationSelector=i,s.subjectSelector=n,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return e.__extends(r,t),r.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},r.prototype._group=function(t,e){var r=this.groups;r||(r=this.groups=new Map);var o,i=r.get(e);if(this.elementSelector)try{o=this.elementSelector(t)}catch(t){this.error(t)}else o=t;if(!i){i=this.subjectSelector?this.subjectSelector():new n.Subject,r.set(e,i);var s=new a(e,i,this);if(this.destination.next(s),this.durationSelector){var u=void 0;try{u=this.durationSelector(new a(e,i))}catch(t){return void this.error(t)}this.add(u.subscribe(new p(e,i,this)))}}i.closed||i.next(o)},r.prototype._error=function(t){var e=this.groups;e&&(e.forEach(function(e,r){e.error(t)}),e.clear()),this.destination.error(t)},r.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(t,e){t.complete()}),t.clear()),this.destination.complete()},r.prototype.removeGroup=function(t){this.groups.delete(t)},r.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},r}(r.Subscriber),p=function(t){function r(e,r,o){var i=t.call(this,r)||this;return i.key=e,i.group=r,i.parent=o,i}return e.__extends(r,t),r.prototype._next=function(t){this.complete()},r.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},r}(r.Subscriber),a=function(t){function r(e,r,o){var i=t.call(this)||this;return i.key=e,i.groupSubject=r,i.refCountSubscription=o,i}return e.__extends(r,t),r.prototype._subscribe=function(t){var e=new o.Subscription,r=this.refCountSubscription,i=this.groupSubject;return r&&!r.closed&&e.add(new h(r)),e.add(i.subscribe(t)),e},r}(i.Observable);exports.GroupedObservable=a;var h=function(t){function r(e){var r=t.call(this)||this;return r.parent=e,e.count++,r}return e.__extends(r,t),r.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},r}(o.Subscription);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Subscription":"mK8y","../Observable":"B88x","../Subject":"NfWW"}],"VGg9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BehaviorSubject=void 0;var e=require("tslib"),t=u(e),r=require("./Subject"),o=require("./util/ObjectUnsubscribedError");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var i=function(e){function r(t){var r=e.call(this)||this;return r._value=t,r}return t.__extends(r,e),Object.defineProperty(r.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),r.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r&&!r.closed&&t.next(this._value),r},r.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.ObjectUnsubscribedError;return this._value},r.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},r}(r.Subject);exports.BehaviorSubject=i;
},{"tslib":"7aRT","./Subject":"NfWW","./util/ObjectUnsubscribedError":"6hpt"}],"VFVk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;var t=require("tslib"),e=i(t),r=require("../Subscription");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var n=function(t){function r(e,r){return t.call(this)||this}return e.__extends(r,t),r.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},r}(r.Subscription);exports.Action=n;
},{"tslib":"7aRT","../Subscription":"mK8y"}],"oNn0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncAction=void 0;var t=require("tslib"),e=n(t),i=require("./Action");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var s=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.scheduler=e,n.work=i,n.pending=!1,n}return e.__extends(i,t),i.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},i.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),setInterval(t.flush.bind(t,this),i)},i.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)},i.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(t,e){var i=!1,n=void 0;try{this.work(t)}catch(t){i=!0,n=!!t&&t||new Error(t)}if(i)return this.unsubscribe(),n},i.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},i}(i.Action);exports.AsyncAction=s;
},{"tslib":"7aRT","./Action":"VFVk"}],"IOFl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueueAction=void 0;var e=require("tslib"),t=s(e),r=require("./AsyncAction");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var u=function(e){function r(t,r){var s=e.call(this,t,r)||this;return s.scheduler=t,s.work=r,s}return t.__extends(r,e),r.prototype.schedule=function(t,r){return void 0===r&&(r=0),r>0?e.prototype.schedule.call(this,t,r):(this.delay=r,this.state=t,this.scheduler.flush(this),this)},r.prototype.execute=function(t,r){return r>0||this.closed?e.prototype.execute.call(this,t,r):this._execute(t,r)},r.prototype.requestAsyncId=function(t,r,s){return void 0===s&&(s=0),null!==s&&s>0||null===s&&this.delay>0?e.prototype.requestAsyncId.call(this,t,r,s):t.flush(this)},r}(r.AsyncAction);exports.QueueAction=u;
},{"tslib":"7aRT","./AsyncAction":"oNn0"}],"aJUP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}();exports.Scheduler=e;
},{}],"c54y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncScheduler=void 0;var e=require("tslib"),t=i(e),r=require("../Scheduler");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var s=function(e){function i(t,s){void 0===s&&(s=r.Scheduler.now);var u=e.call(this,t,function(){return i.delegate&&i.delegate!==u?i.delegate.now():s()})||this;return u.actions=[],u.active=!1,u.scheduled=void 0,u}return t.__extends(i,e),i.prototype.schedule=function(t,r,s){return void 0===r&&(r=0),i.delegate&&i.delegate!==this?i.delegate.schedule(t,r,s):e.prototype.schedule.call(this,t,r,s)},i.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},i}(r.Scheduler);exports.AsyncScheduler=s;
},{"tslib":"7aRT","../Scheduler":"aJUP"}],"zOBX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueueScheduler=void 0;var e=require("tslib"),r=t(e),u=require("./AsyncScheduler");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&(r[u]=e[u]);return r.default=e,r}var n=function(e){function u(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(u,e),u}(u.AsyncScheduler);exports.QueueScheduler=n;
},{"tslib":"7aRT","./AsyncScheduler":"c54y"}],"ZPI1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.queue=void 0;var e=require("./QueueAction"),u=require("./QueueScheduler"),r=exports.queue=new u.QueueScheduler(e.QueueAction);
},{"./QueueAction":"IOFl","./QueueScheduler":"zOBX"}],"5BP8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EMPTY=void 0,exports.empty=t,exports.emptyScheduled=n;var e=require("../Observable"),r=exports.EMPTY=new e.Observable(function(e){return e.complete()});function t(e){return e?n(e):r}function n(r){return new e.Observable(function(e){return r.schedule(function(){return e.complete()})})}
},{"../Observable":"B88x"}],"BtYd":[function(require,module,exports) {
"use strict";function e(e){return e&&"function"==typeof e.schedule}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isScheduler=e;
},{}],"ANLd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.subscribeToArray=function(e){return function(r){for(var t=0,o=e.length;t<o&&!r.closed;t++)r.next(e[t]);r.closed||r.complete()}};
},{}],"WFxi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromArray=t;var e=require("../Observable"),r=require("../Subscription"),s=require("../util/subscribeToArray");function t(t,u){return u?new e.Observable(function(e){var s=new r.Subscription,i=0;return s.add(u.schedule(function(){i!==t.length?(e.next(t[i++]),e.closed||s.add(this.schedule())):e.complete()})),s}):new e.Observable((0,s.subscribeToArray)(t))}
},{"../Observable":"B88x","../Subscription":"mK8y","../util/subscribeToArray":"ANLd"}],"q5qz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scalar=r;var e=require("../Observable");function r(r){var t=new e.Observable(function(e){e.next(r),e.complete()});return t._isScalar=!0,t.value=r,t}
},{"../Observable":"B88x"}],"aGxf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.of=a;var r=require("../util/isScheduler"),e=require("./fromArray"),t=require("./empty"),u=require("./scalar");function a(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];var o=a[a.length-1];switch((0,r.isScheduler)(o)?a.pop():o=void 0,a.length){case 0:return(0,t.empty)(o);case 1:return o?(0,e.fromArray)(a,o):(0,u.scalar)(a[0]);default:return(0,e.fromArray)(a,o)}}
},{"../util/isScheduler":"BtYd","./fromArray":"WFxi","./empty":"5BP8","./scalar":"q5qz"}],"BXbb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throwError=e;var r=require("../Observable");function e(e,o){return o?new r.Observable(function(r){return o.schedule(n,0,{error:e,subscriber:r})}):new r.Observable(function(r){return r.error(e)})}function n(r){var e=r.error;r.subscriber.error(e)}
},{"../Observable":"B88x"}],"CJua":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Notification=void 0;var e=require("./observable/empty"),t=require("./observable/of"),r=require("./observable/throwError"),o=function(){function o(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}return o.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},o.prototype.do=function(e,t,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},o.prototype.accept=function(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,r)},o.prototype.toObservable=function(){switch(this.kind){case"N":return(0,t.of)(this.value);case"E":return(0,r.throwError)(this.error);case"C":return(0,e.empty)()}throw new Error("unexpected notification kind value")},o.createNext=function(e){return void 0!==e?new o("N",e):o.undefinedValueNotification},o.createError=function(e){return new o("E",void 0,e)},o.createComplete=function(){return o.completeNotification},o.completeNotification=new o("C"),o.undefinedValueNotification=new o("N",void 0),o}();exports.Notification=o;
},{"./observable/empty":"5BP8","./observable/of":"aGxf","./observable/throwError":"BXbb"}],"fRUF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObserveOnMessage=exports.ObserveOnSubscriber=exports.ObserveOnOperator=void 0,exports.observeOn=n;var e=require("tslib"),t=s(e),r=require("../Subscriber"),i=require("../Notification");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e,t){return void 0===t&&(t=0),function(r){return r.lift(new o(e,t))}}var o=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.scheduler,this.delay))},e}();exports.ObserveOnOperator=o;var u=function(e){function r(t,r,i){void 0===i&&(i=0);var s=e.call(this,t)||this;return s.scheduler=r,s.delay=i,s}return t.__extends(r,e),r.dispatch=function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()},r.prototype.scheduleMessage=function(e){this.add(this.scheduler.schedule(r.dispatch,this.delay,new c(e,this.destination)))},r.prototype._next=function(e){this.scheduleMessage(i.Notification.createNext(e))},r.prototype._error=function(e){this.scheduleMessage(i.Notification.createError(e))},r.prototype._complete=function(){this.scheduleMessage(i.Notification.createComplete())},r}(r.Subscriber);exports.ObserveOnSubscriber=u;var c=function(){return function(e,t){this.notification=e,this.destination=t}}();exports.ObserveOnMessage=c;
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Notification":"CJua"}],"PGZW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaySubject=void 0;var e=require("tslib"),t=h(e),i=require("./Subject"),r=require("./scheduler/queue"),n=require("./Subscription"),s=require("./operators/observeOn"),o=require("./util/ObjectUnsubscribedError"),u=require("./SubjectSubscription");function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}var c=function(e){function i(t,i,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===i&&(i=Number.POSITIVE_INFINITY);var n=e.call(this)||this;return n.scheduler=r,n._events=[],n._infiniteTimeWindow=!1,n._bufferSize=t<1?1:t,n._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(n._infiniteTimeWindow=!0,n.next=n.nextInfiniteTimeWindow):n.next=n.nextTimeWindow,n}return t.__extends(i,e),i.prototype.nextInfiniteTimeWindow=function(t){var i=this._events;i.push(t),i.length>this._bufferSize&&i.shift(),e.prototype.next.call(this,t)},i.prototype.nextTimeWindow=function(t){this._events.push(new f(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},i.prototype._subscribe=function(e){var t,i=this._infiniteTimeWindow,r=i?this._events:this._trimBufferThenGetEvents(),h=this.scheduler,c=r.length;if(this.closed)throw new o.ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=n.Subscription.EMPTY:(this.observers.push(e),t=new u.SubjectSubscription(this,e)),h&&e.add(e=new s.ObserveOnSubscriber(e,h)),i)for(var f=0;f<c&&!e.closed;f++)e.next(r[f]);else for(f=0;f<c&&!e.closed;f++)e.next(r[f].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},i.prototype._getNow=function(){return(this.scheduler||r.queue).now()},i.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,n=r.length,s=0;s<n&&!(e-r[s].time<i);)s++;return n>t&&(s=Math.max(s,n-t)),s>0&&r.splice(0,s),r},i}(i.Subject);exports.ReplaySubject=c;var f=function(){return function(e,t){this.time=e,this.value=t}}();
},{"tslib":"7aRT","./Subject":"NfWW","./scheduler/queue":"ZPI1","./Subscription":"mK8y","./operators/observeOn":"fRUF","./util/ObjectUnsubscribedError":"6hpt","./SubjectSubscription":"+m/+"}],"Yp3O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncSubject=void 0;var t=require("tslib"),e=s(t),r=require("./Subject"),o=require("./Subscription");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var i=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return e.__extends(r,t),r.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),o.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),o.Subscription.EMPTY):t.prototype._subscribe.call(this,e)},r.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},r.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},r.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},r}(r.Subject);exports.AsyncSubject=i;
},{"tslib":"7aRT","./Subject":"NfWW","./Subscription":"mK8y"}],"suBs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=1,t={};function r(e){var r=t[e];r&&r()}var n=exports.Immediate={setImmediate:function(n){var i=e++;return t[i]=n,Promise.resolve().then(function(){return r(i)}),i},clearImmediate:function(e){delete t[e]}};
},{}],"xUp0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsapAction=void 0;var e=require("tslib"),t=i(e),r=require("../util/Immediate"),n=require("./AsyncAction");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var s=function(e){function n(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return t.__extends(n,e),n.prototype.requestAsyncId=function(t,n,i){return void 0===i&&(i=0),null!==i&&i>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.actions.push(this),t.scheduled||(t.scheduled=r.Immediate.setImmediate(t.flush.bind(t,null))))},n.prototype.recycleAsyncId=function(t,n,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,i);0===t.actions.length&&(r.Immediate.clearImmediate(n),t.scheduled=void 0)},n}(n.AsyncAction);exports.AsapAction=s;
},{"tslib":"7aRT","../util/Immediate":"suBs","./AsyncAction":"oNn0"}],"NNlu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsapScheduler=void 0;var e=require("tslib"),t=i(e),r=require("./AsyncScheduler");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,i=-1,s=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<s&&(e=r.shift()));if(this.active=!1,t){for(;++i<s&&(e=r.shift());)e.unsubscribe();throw t}},r}(r.AsyncScheduler);exports.AsapScheduler=s;
},{"tslib":"7aRT","./AsyncScheduler":"c54y"}],"q4Vt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asap=void 0;var e=require("./AsapAction"),r=require("./AsapScheduler"),s=exports.asap=new r.AsapScheduler(e.AsapAction);
},{"./AsapAction":"xUp0","./AsapScheduler":"NNlu"}],"FFCS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.async=void 0;var e=require("./AsyncAction"),r=require("./AsyncScheduler"),c=exports.async=new r.AsyncScheduler(e.AsyncAction);
},{"./AsyncAction":"oNn0","./AsyncScheduler":"c54y"}],"IwiB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimationFrameAction=void 0;var e=require("tslib"),t=r(e),n=require("./AsyncAction");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var i=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return t.__extends(n,e),n.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(function(){return t.flush(null)})))},n.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},n}(n.AsyncAction);exports.AnimationFrameAction=i;
},{"tslib":"7aRT","./AsyncAction":"oNn0"}],"l20J":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimationFrameScheduler=void 0;var e=require("tslib"),t=i(e),r=require("./AsyncScheduler");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var n=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),r.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,i=-1,n=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<n&&(e=r.shift()));if(this.active=!1,t){for(;++i<n&&(e=r.shift());)e.unsubscribe();throw t}},r}(r.AsyncScheduler);exports.AnimationFrameScheduler=n;
},{"tslib":"7aRT","./AsyncScheduler":"c54y"}],"UL2g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.animationFrame=void 0;var e=require("./AnimationFrameAction"),i=require("./AnimationFrameScheduler"),r=exports.animationFrame=new i.AnimationFrameScheduler(e.AnimationFrameAction);
},{"./AnimationFrameAction":"IwiB","./AnimationFrameScheduler":"l20J"}],"0pwH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VirtualAction=exports.VirtualTimeScheduler=void 0;var e=require("tslib"),t=n(e),r=require("./AsyncAction"),i=require("./AsyncScheduler");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var o=function(e){function r(t,r){void 0===t&&(t=s),void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t,function(){return i.frame})||this;return i.maxFrames=r,i.frame=0,i.index=-1,i}return t.__extends(r,e),r.prototype.flush=function(){for(var e,t,r=this.actions,i=this.maxFrames;(t=r.shift())&&(this.frame=t.delay)<=i&&!(e=t.execute(t.state,t.delay)););if(e){for(;t=r.shift();)t.unsubscribe();throw e}},r.frameTimeFactor=10,r}(i.AsyncScheduler);exports.VirtualTimeScheduler=o;var s=function(e){function r(t,r,i){void 0===i&&(i=t.index+=1);var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.index=i,n.active=!0,n.index=t.index=i,n}return t.__extends(r,e),r.prototype.schedule=function(t,i){if(void 0===i&&(i=0),!this.id)return e.prototype.schedule.call(this,t,i);this.active=!1;var n=new r(this.scheduler,this.work);return this.add(n),n.schedule(t,i)},r.prototype.requestAsyncId=function(e,t,i){void 0===i&&(i=0),this.delay=e.frame+i;var n=e.actions;return n.push(this),n.sort(r.sortActions),!0},r.prototype.recycleAsyncId=function(e,t,r){void 0===r&&(r=0)},r.prototype._execute=function(t,r){if(!0===this.active)return e.prototype._execute.call(this,t,r)},r.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},r}(r.AsyncAction);exports.VirtualAction=s;
},{"tslib":"7aRT","./AsyncAction":"oNn0","./AsyncScheduler":"c54y"}],"Xo/Y":[function(require,module,exports) {
"use strict";function e(e){return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.identity=e;
},{}],"TYyN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObservable=r;var e=require("../Observable");function r(r){return!!r&&(r instanceof e.Observable||"function"==typeof r.lift&&"function"==typeof r.subscribe)}
},{"../Observable":"B88x"}],"p9/g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArgumentOutOfRangeError=void 0;var r=require("tslib"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var n=function(r){function t(){var e=r.call(this,"argument out of range")||this;return e.name="ArgumentOutOfRangeError",Object.setPrototypeOf(e,t.prototype),e}return e.__extends(t,r),t}(Error);exports.ArgumentOutOfRangeError=n;
},{"tslib":"7aRT"}],"MbJR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmptyError=void 0;var r=require("tslib"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var o=function(r){function t(){var e=r.call(this,"no elements in sequence")||this;return e.name="EmptyError",Object.setPrototypeOf(e,t.prototype),e}return e.__extends(t,r),t}(Error);exports.EmptyError=o;
},{"tslib":"7aRT"}],"RGBD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeoutError=void 0;var r=require("tslib"),e=t(r);function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var o=function(r){function t(){var e=r.call(this,"Timeout has occurred")||this;return e.name="TimeoutError",Object.setPrototypeOf(e,t.prototype),e}return e.__extends(t,r),t}(Error);exports.TimeoutError=o;
},{"tslib":"7aRT"}],"aORC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MapOperator=void 0,exports.map=o;var t=require("tslib"),r=n(t),e=require("../Subscriber");function n(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r}function o(t,r){return function(e){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new i(t,r))}}var i=function(){function t(t,r){this.project=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new u(t,this.project,this.thisArg))},t}();exports.MapOperator=i;var u=function(t){function e(r,e,n){var o=t.call(this,r)||this;return o.project=e,o.count=0,o.thisArg=n||o,o}return r.__extends(e,t),e.prototype._next=function(t){var r;try{r=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(r)},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"Ux7p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindCallback=n;var e=require("../Observable"),r=require("../AsyncSubject"),t=require("../operators/map"),c=require("../util/isArray"),u=require("../util/isScheduler");function n(s,i,l){if(i){if(!(0,u.isScheduler)(i))return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(s,l).apply(void 0,e).pipe((0,t.map)(function(e){return(0,c.isArray)(e)?i.apply(void 0,e):i(e)}))};l=i}return function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];var u,n=this,i={context:n,subject:u,callbackFunc:s,scheduler:l};return new e.Observable(function(e){if(l){var c={args:t,subscriber:e,params:i};return l.schedule(a,0,c)}if(!u){u=new r.AsyncSubject;try{s.apply(n,t.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];u.next(e.length<=1?e[0]:e),u.complete()}]))}catch(e){u.error(e)}}return u.subscribe(e)})}}function a(e){var t=this,c=e.args,u=e.subscriber,n=e.params,a=n.callbackFunc,i=n.context,l=n.scheduler,o=n.subject;if(!o){o=n.subject=new r.AsyncSubject;try{a.apply(i,c.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var c=e.length<=1?e[0]:e;t.add(l.schedule(s,0,{value:c,subject:o}))}]))}catch(e){o.error(e)}}this.add(o.subscribe(u))}function s(e){var r=e.value,t=e.subject;t.next(r),t.complete()}function i(e){var r=e.err;e.subject.error(r)}
},{"../Observable":"B88x","../AsyncSubject":"Yp3O","../operators/map":"aORC","../util/isArray":"xunG","../util/isScheduler":"BtYd"}],"AdBT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindNodeCallback=n;var e=require("../Observable"),r=require("../AsyncSubject"),t=require("../operators/map"),c=require("../util/isScheduler"),u=require("../util/isArray");function n(a,i,l){if(i){if(!(0,c.isScheduler)(i))return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(a,l).apply(void 0,e).pipe((0,t.map)(function(e){return(0,u.isArray)(e)?i.apply(void 0,e):i(e)}))};l=i}return function(){for(var t=[],c=0;c<arguments.length;c++)t[c]=arguments[c];var u={subject:void 0,args:t,callbackFunc:a,scheduler:l,context:this};return new e.Observable(function(e){var c=u.context,n=u.subject;if(l)return l.schedule(s,0,{params:u,subscriber:e,context:c});if(!n){n=u.subject=new r.AsyncSubject;try{a.apply(c,t.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=e.shift();t?n.error(t):(n.next(e.length<=1?e[0]:e),n.complete())}]))}catch(e){n.error(e)}}return n.subscribe(e)})}}function s(e){var t=this,c=e.params,u=e.subscriber,n=e.context,s=c.callbackFunc,l=c.args,o=c.scheduler,b=c.subject;if(!b){b=c.subject=new r.AsyncSubject;try{s.apply(n,l.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var c=e.shift();if(c)t.add(o.schedule(i,0,{err:c,subject:b}));else{var u=e.length<=1?e[0]:e;t.add(o.schedule(a,0,{value:u,subject:b}))}}]))}catch(e){this.add(o.schedule(i,0,{err:e,subject:b}))}}this.add(b.subscribe(u))}function a(e){var r=e.value,t=e.subject;t.next(r),t.complete()}function i(e){var r=e.err;e.subject.error(r)}
},{"../Observable":"B88x","../AsyncSubject":"Yp3O","../operators/map":"aORC","../util/isScheduler":"BtYd","../util/isArray":"xunG"}],"87n1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OuterSubscriber=void 0;var t=require("tslib"),e=i(t),r=require("./Subscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var o=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.notifyNext=function(t,e,r,i,o){this.destination.next(e)},r.prototype.notifyError=function(t,e){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.destination.complete()},r}(r.Subscriber);exports.OuterSubscriber=o;
},{"tslib":"7aRT","./Subscriber":"Qs1E"}],"9YIl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InnerSubscriber=void 0;var e=require("tslib"),t=i(e),r=require("./Subscriber");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var n=function(e){function r(t,r,i){var n=e.call(this)||this;return n.parent=t,n.outerValue=r,n.outerIndex=i,n.index=0,n}return t.__extends(r,e),r.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},r.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(r.Subscriber);exports.InnerSubscriber=n;
},{"tslib":"7aRT","./Subscriber":"Qs1E"}],"MVnV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToPromise=void 0;var r=require("./hostReportError"),e=exports.subscribeToPromise=function(e){return function(o){return e.then(function(r){o.closed||(o.next(r),o.complete())},function(r){return o.error(r)}).then(null,r.hostReportError),o}};
},{"./hostReportError":"xwYc"}],"OzfQ":[function(require,module,exports) {
"use strict";function t(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSymbolIterator=t;var r=exports.iterator=t(),e=exports.$$iterator=r;
},{}],"hwLY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToIterable=void 0;var e=require("../symbol/iterator"),r=exports.subscribeToIterable=function(r){return function(t){for(var o=r[e.iterator]();;){var n=o.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof o.return&&t.add(function(){o.return&&o.return()}),t}};
},{"../symbol/iterator":"OzfQ"}],"6lnU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToObservable=void 0;var e=require("../symbol/observable"),r=exports.subscribeToObservable=function(r){return function(o){var b=r[e.observable]();if("function"!=typeof b.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return b.subscribe(o)}};
},{"../symbol/observable":"xulG"}],"aqdG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=exports.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};
},{}],"fwFe":[function(require,module,exports) {
"use strict";function e(e){return e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPromise=e;
},{}],"i+6S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeTo=void 0;var e=require("../Observable"),r=require("./subscribeToArray"),i=require("./subscribeToPromise"),s=require("./subscribeToIterable"),b=require("./subscribeToObservable"),o=require("./isArrayLike"),u=require("./isPromise"),t=require("./isObject"),a=require("../symbol/iterator"),c=require("../symbol/observable"),n=exports.subscribeTo=function(n){if(n instanceof e.Observable)return function(e){return n._isScalar?(e.next(n.value),void e.complete()):n.subscribe(e)};if(n&&"function"==typeof n[c.observable])return(0,b.subscribeToObservable)(n);if((0,o.isArrayLike)(n))return(0,r.subscribeToArray)(n);if((0,u.isPromise)(n))return(0,i.subscribeToPromise)(n);if(n&&"function"==typeof n[a.iterator])return(0,s.subscribeToIterable)(n);var l=(0,t.isObject)(n)?"an invalid object":"'"+n+"'";throw new TypeError("You provided "+l+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};
},{"../Observable":"B88x","./subscribeToArray":"ANLd","./subscribeToPromise":"MVnV","./subscribeToIterable":"hwLY","./subscribeToObservable":"6lnU","./isArrayLike":"aqdG","./isPromise":"fwFe","./isObject":"e4je","../symbol/iterator":"OzfQ","../symbol/observable":"xulG"}],"9sHU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToResult=s;var e=require("../InnerSubscriber"),r=require("./subscribeTo");function s(s,u,b,i){var n=new e.InnerSubscriber(s,b,i);return(0,r.subscribeTo)(u)(n)}
},{"../InnerSubscriber":"9YIl","./subscribeTo":"i+6S"}],"vI5W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CombineLatestSubscriber=exports.CombineLatestOperator=void 0,exports.combineLatest=a;var t=require("tslib"),e=u(t),r=require("../util/isScheduler"),i=require("../util/isArray"),s=require("../OuterSubscriber"),o=require("../util/subscribeToResult"),n=require("./fromArray");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}var l={};function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var s=null,o=null;return(0,r.isScheduler)(t[t.length-1])&&(o=t.pop()),"function"==typeof t[t.length-1]&&(s=t.pop()),1===t.length&&(0,i.isArray)(t[0])&&(t=t[0]),(0,n.fromArray)(t,o).lift(new c(s))}var c=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.resultSelector))},t}();exports.CombineLatestOperator=c;var p=function(t){function r(e,r){var i=t.call(this,e)||this;return i.resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return e.__extends(r,t),r.prototype._next=function(t){this.values.push(l),this.observables.push(t)},r.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var i=t[r];this.add((0,o.subscribeToResult)(this,i,i,r))}}},r.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},r.prototype.notifyNext=function(t,e,r,i,s){var o=this.values,n=o[r],u=this.toRespond?n===l?--this.toRespond:this.toRespond:0;o[r]=e,0===u&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},r.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(s.OuterSubscriber);exports.CombineLatestSubscriber=p;
},{"tslib":"7aRT","../util/isScheduler":"BtYd","../util/isArray":"xunG","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU","./fromArray":"WFxi"}],"d3Vk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isInteropObservable=r;var e=require("../symbol/observable");function r(r){return r&&"function"==typeof r[e.observable]}
},{"../symbol/observable":"xulG"}],"6r/k":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isIterable=r;var e=require("../symbol/iterator");function r(r){return r&&"function"==typeof r[e.iterator]}
},{"../symbol/iterator":"OzfQ"}],"uiap":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromPromise=u;var e=require("../Observable"),r=require("../Subscription"),n=require("../util/subscribeToPromise");function u(u,t){return t?new e.Observable(function(e){var n=new r.Subscription;return n.add(t.schedule(function(){return u.then(function(r){n.add(t.schedule(function(){e.next(r),n.add(t.schedule(function(){return e.complete()}))}))},function(r){n.add(t.schedule(function(){return e.error(r)}))})})),n}):new e.Observable((0,n.subscribeToPromise)(u))}
},{"../Observable":"B88x","../Subscription":"mK8y","../util/subscribeToPromise":"MVnV"}],"rPaG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromIterable=u;var e=require("../Observable"),r=require("../Subscription"),t=require("../symbol/iterator"),n=require("../util/subscribeToIterable");function u(u,o){if(!u)throw new Error("Iterable cannot be null");return o?new e.Observable(function(e){var n,i=new r.Subscription;return i.add(function(){n&&"function"==typeof n.return&&n.return()}),i.add(o.schedule(function(){n=u[t.iterator](),i.add(o.schedule(function(){if(!e.closed){var r,t;try{var u=n.next();r=u.value,t=u.done}catch(r){return void e.error(r)}t?e.complete():(e.next(r),this.schedule())}}))})),i}):new e.Observable((0,n.subscribeToIterable)(u))}
},{"../Observable":"B88x","../Subscription":"mK8y","../symbol/iterator":"OzfQ","../util/subscribeToIterable":"hwLY"}],"hmwv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromObservable=t;var e=require("../Observable"),r=require("../Subscription"),n=require("../symbol/observable"),u=require("../util/subscribeToObservable");function t(t,b){return b?new e.Observable(function(e){var u=new r.Subscription;return u.add(b.schedule(function(){var r=t[n.observable]();u.add(r.subscribe({next:function(r){u.add(b.schedule(function(){return e.next(r)}))},error:function(r){u.add(b.schedule(function(){return e.error(r)}))},complete:function(){u.add(b.schedule(function(){return e.complete()}))}}))})),u}):new e.Observable((0,u.subscribeToObservable)(t))}
},{"../Observable":"B88x","../Subscription":"mK8y","../symbol/observable":"xulG","../util/subscribeToObservable":"6lnU"}],"LnUO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.from=a;var r=require("../Observable"),e=require("../util/isPromise"),i=require("../util/isArrayLike"),s=require("../util/isInteropObservable"),o=require("../util/isIterable"),t=require("./fromArray"),u=require("./fromPromise"),b=require("./fromIterable"),l=require("./fromObservable"),f=require("../util/subscribeTo");function a(a,n){if(!n)return a instanceof r.Observable?a:new r.Observable((0,f.subscribeTo)(a));if(null!=a){if((0,s.isInteropObservable)(a))return(0,l.fromObservable)(a,n);if((0,e.isPromise)(a))return(0,u.fromPromise)(a,n);if((0,i.isArrayLike)(a))return(0,t.fromArray)(a,n);if((0,o.isIterable)(a)||"string"==typeof a)return(0,b.fromIterable)(a,n)}throw new TypeError((null!==a&&typeof a||a)+" is not observable")}
},{"../Observable":"B88x","../util/isPromise":"fwFe","../util/isArrayLike":"aqdG","../util/isInteropObservable":"d3Vk","../util/isIterable":"6r/k","./fromArray":"WFxi","./fromPromise":"uiap","./fromIterable":"rPaG","./fromObservable":"hmwv","../util/subscribeTo":"i+6S"}],"I5oK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MergeMapSubscriber=exports.MergeMapOperator=void 0,exports.mergeMap=s;var t=require("tslib"),e=u(t),r=require("../util/subscribeToResult"),i=require("../OuterSubscriber"),n=require("./map"),o=require("../observable/from");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function s(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(i){return i.pipe(s(function(r,i){return(0,o.from)(t(r,i)).pipe((0,n.map)(function(t,n){return e(r,t,i,n)}))},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new c(t,r))})}var c=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.project,this.concurrent))},t}();exports.MergeMapOperator=c;var p=function(t){function i(e,r,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var n=t.call(this,e)||this;return n.project=r,n.concurrent=i,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return e.__extends(i,t),i.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},i.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},i.prototype._innerSub=function(t,e,i){this.add((0,r.subscribeToResult)(this,t,e,i))},i.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},i.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},i.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},i}(i.OuterSubscriber);exports.MergeMapSubscriber=p;
},{"tslib":"7aRT","../util/subscribeToResult":"9sHU","../OuterSubscriber":"87n1","./map":"aORC","../observable/from":"LnUO"}],"yTi9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeAll=t;var e=require("./mergeMap"),r=require("../util/identity");function t(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),(0,e.mergeMap)(r.identity,t)}
},{"./mergeMap":"I5oK","../util/identity":"Xo/Y"}],"gOvZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatAll=r;var e=require("./mergeAll");function r(){return(0,e.mergeAll)(1)}
},{"./mergeAll":"yTi9"}],"g+vB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concat=l;var e=require("../util/isScheduler"),r=require("./of"),o=require("./from"),t=require("../operators/concatAll");function l(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return 1===l.length||2===l.length&&(0,e.isScheduler)(l[1])?(0,o.from)(l[0]):(0,t.concatAll)()(r.of.apply(void 0,l))}
},{"../util/isScheduler":"BtYd","./of":"aGxf","./from":"LnUO","../operators/concatAll":"gOvZ"}],"F9YC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defer=u;var e=require("../Observable"),r=require("./from"),t=require("./empty");function u(u){return new e.Observable(function(e){var o;try{o=u()}catch(r){return void e.error(r)}return(o?(0,r.from)(o):(0,t.empty)()).subscribe(e)})}
},{"../Observable":"B88x","./from":"LnUO","./empty":"5BP8"}],"ev4H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forkJoin=l;var e=require("tslib"),r=a(e),t=require("../Observable"),u=require("../util/isArray"),i=require("./empty"),n=require("../util/subscribeToResult"),o=require("../OuterSubscriber"),s=require("../operators/map");function a(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function l(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return"function"==typeof r[r.length-1]&&(e=r.pop()),1===r.length&&(0,u.isArray)(r[0])&&(r=r[0]),0===r.length?i.EMPTY:e?l(r).pipe((0,s.map)(function(r){return e.apply(void 0,r)})):new t.Observable(function(e){return new p(e,r)})}var p=function(e){function t(r,t){var u=e.call(this,r)||this;u.sources=t,u.completed=0,u.haveValues=0;var i=t.length;u.values=new Array(i);for(var o=0;o<i;o++){var s=t[o],a=(0,n.subscribeToResult)(u,s,null,o);a&&u.add(a)}return u}return r.__extends(t,e),t.prototype.notifyNext=function(e,r,t,u,i){this.values[t]=r,i._hasValue||(i._hasValue=!0,this.haveValues++)},t.prototype.notifyComplete=function(e){var r=this.destination,t=this.haveValues,u=this.values,i=u.length;e._hasValue?(this.completed++,this.completed===i&&(t===i&&r.next(u),r.complete())):r.complete()},t}(o.OuterSubscriber);
},{"tslib":"7aRT","../Observable":"B88x","../util/isArray":"xunG","./empty":"5BP8","../util/subscribeToResult":"9sHU","../OuterSubscriber":"87n1","../operators/map":"aORC"}],"Dv8L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromEvent=i;var e=require("../Observable"),n=require("../util/isArray"),t=require("../util/isFunction"),r=require("../operators/map"),o=Object.prototype.toString;function i(o,f,a,c){return(0,t.isFunction)(a)&&(c=a,a=void 0),c?i(o,f,a).pipe((0,r.map)(function(e){return(0,n.isArray)(e)?c.apply(void 0,e):c(e)})):new e.Observable(function(e){u(o,f,function(n){arguments.length>1?e.next(Array.prototype.slice.call(arguments)):e.next(n)},e,a)})}function u(e,n,t,r,o){var i;if(c(e)){var s=e;e.addEventListener(n,t,o),i=function(){return s.removeEventListener(n,t,o)}}else if(a(e)){var v=e;e.on(n,t),i=function(){return v.off(n,t)}}else if(f(e)){var p=e;e.addListener(n,t),i=function(){return p.removeListener(n,t)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,d=e.length;l<d;l++)u(e[l],n,t,r,o)}r.add(i)}function f(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function a(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function c(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}
},{"../Observable":"B88x","../util/isArray":"xunG","../util/isFunction":"gOFo","../operators/map":"aORC"}],"w0Xq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromEventPattern=i;var r=require("../Observable"),e=require("../util/isArray"),t=require("../util/isFunction"),n=require("../operators/map");function i(u,o,a){return a?i(u,o).pipe((0,n.map)(function(r){return(0,e.isArray)(r)?a.apply(void 0,r):a(r)})):new r.Observable(function(r){var e,n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.next(1===e.length?e[0]:e)};try{e=u(n)}catch(e){return void r.error(e)}if((0,t.isFunction)(o))return function(){return o(n,e)}})}
},{"../Observable":"B88x","../util/isArray":"xunG","../util/isFunction":"gOFo","../operators/map":"aORC"}],"d4wx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generate=i;var e=require("../Observable"),r=require("../util/identity"),t=require("../util/isScheduler");function i(i,c,n,a,s){var u,d;if(1==arguments.length){var l=i;d=l.initialState,c=l.condition,n=l.iterate,u=l.resultSelector||r.identity,s=l.scheduler}else void 0===a||(0,t.isScheduler)(a)?(d=i,u=r.identity,s=a):(d=i,u=a);return new e.Observable(function(e){var r=d;if(s)return s.schedule(o,0,{subscriber:e,iterate:n,condition:c,resultSelector:u,state:r});for(;;){if(c){var t=void 0;try{t=c(r)}catch(r){return void e.error(r)}if(!t){e.complete();break}}var i=void 0;try{i=u(r)}catch(r){return void e.error(r)}if(e.next(i),e.closed)break;try{r=n(r)}catch(r){return void e.error(r)}}})}function o(e){var r=e.subscriber,t=e.condition;if(!r.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void r.error(e)}else e.needIterate=!0;if(t){var i=void 0;try{i=t(e.state)}catch(e){return void r.error(e)}if(!i)return void r.complete();if(r.closed)return}var o;try{o=e.resultSelector(e.state)}catch(e){return void r.error(e)}if(!r.closed&&(r.next(o),!r.closed))return this.schedule(e)}}
},{"../Observable":"B88x","../util/identity":"Xo/Y","../util/isScheduler":"BtYd"}],"p8+r":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.iif=t;var e=require("./defer"),r=require("./empty");function t(t,i,u){return void 0===i&&(i=r.EMPTY),void 0===u&&(u=r.EMPTY),(0,e.defer)(function(){return t()?i:u})}
},{"./defer":"F9YC","./empty":"5BP8"}],"DEZm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNumeric=e;var r=require("./isArray");function e(e){return!(0,r.isArray)(e)&&e-parseFloat(e)+1>=0}
},{"./isArray":"xunG"}],"SmEM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interval=i;var e=require("../Observable"),r=require("../scheduler/async"),u=require("../util/isNumeric");function i(i,c){return void 0===i&&(i=0),void 0===c&&(c=r.async),(!(0,u.isNumeric)(i)||i<0)&&(i=0),c&&"function"==typeof c.schedule||(c=r.async),new e.Observable(function(e){return e.add(c.schedule(s,i,{subscriber:e,counter:0,period:i})),e})}function s(e){var r=e.subscriber,u=e.counter,i=e.period;r.next(u),this.schedule({subscriber:r,counter:u+1,period:i},i)}
},{"../Observable":"B88x","../scheduler/async":"FFCS","../util/isNumeric":"DEZm"}],"sLBY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=u;var e=require("../Observable"),r=require("../util/isScheduler"),l=require("../operators/mergeAll"),t=require("./fromArray");function u(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];var n=Number.POSITIVE_INFINITY,p=null,i=u[u.length-1];return(0,r.isScheduler)(i)?(p=u.pop(),u.length>1&&"number"==typeof u[u.length-1]&&(n=u.pop())):"number"==typeof i&&(n=u.pop()),null===p&&1===u.length&&u[0]instanceof e.Observable?u[0]:(0,l.mergeAll)(n)((0,t.fromArray)(u,p))}
},{"../Observable":"B88x","../util/isScheduler":"BtYd","../operators/mergeAll":"yTi9","./fromArray":"WFxi"}],"ZnUi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NEVER=void 0,exports.never=t;var e=require("../Observable"),r=require("../util/noop"),o=exports.NEVER=new e.Observable(r.noop);function t(){return o}
},{"../Observable":"B88x","../util/noop":"BUGg"}],"8V3l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onErrorResumeNext=i;var e=require("../Observable"),r=require("./from"),t=require("../util/isArray"),n=require("./empty");function i(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];if(0===u.length)return n.EMPTY;var s=u[0],a=u.slice(1);return 1===u.length&&(0,t.isArray)(s)?i.apply(void 0,s):new e.Observable(function(e){var t=function(){return e.add(i.apply(void 0,a).subscribe(e))};return(0,r.from)(s).subscribe({next:function(r){e.next(r)},error:t,complete:t})})}
},{"../Observable":"B88x","./from":"LnUO","../util/isArray":"xunG","./empty":"5BP8"}],"Q/xt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pairs=s,exports.dispatch=i;var e=require("../Observable"),r=require("../Subscription");function s(s,t){return t?new e.Observable(function(e){var n=Object.keys(s),b=new r.Subscription;return b.add(t.schedule(i,0,{keys:n,index:0,subscriber:e,subscription:b,obj:s})),b}):new e.Observable(function(e){for(var r=Object.keys(s),i=0;i<r.length&&!e.closed;i++){var t=r[i];s.hasOwnProperty(t)&&e.next([t,s[t]])}e.complete()})}function i(e){var r=e.keys,s=e.index,i=e.subscriber,t=e.subscription,n=e.obj;if(!i.closed)if(s<r.length){var b=r[s];i.next([b,n[b]]),t.add(this.schedule({keys:r,index:s+1,subscriber:i,subscription:t,obj:n}))}else i.complete()}
},{"../Observable":"B88x","../Subscription":"mK8y"}],"0Naf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RaceSubscriber=exports.RaceOperator=void 0,exports.race=u;var r=require("tslib"),t=n(r),e=require("../util/isArray"),s=require("./fromArray"),i=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function n(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function u(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(1===r.length){if(!(0,e.isArray)(r[0]))return r[0];r=r[0]}return(0,s.fromArray)(r,void 0).lift(new a)}var a=function(){function r(){}return r.prototype.call=function(r,t){return t.subscribe(new c(r))},r}();exports.RaceOperator=a;var c=function(r){function e(t){var e=r.call(this,t)||this;return e.hasFirst=!1,e.observables=[],e.subscriptions=[],e}return t.__extends(e,r),e.prototype._next=function(r){this.observables.push(r)},e.prototype._complete=function(){var r=this.observables,t=r.length;if(0===t)this.destination.complete();else{for(var e=0;e<t&&!this.hasFirst;e++){var s=r[e],i=(0,o.subscribeToResult)(this,s,s,e);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},e.prototype.notifyNext=function(r,t,e,s,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==e){var n=this.subscriptions[o];n.unsubscribe(),this.remove(n)}this.subscriptions=null}this.destination.next(t)},e}(i.OuterSubscriber);exports.RaceSubscriber=c;
},{"tslib":"7aRT","../util/isArray":"xunG","./fromArray":"WFxi","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"L6WQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.range=r,exports.dispatch=t;var e=require("../Observable");function r(r,s,i){return void 0===r&&(r=0),void 0===s&&(s=0),new e.Observable(function(e){var n=0,o=r;if(i)return i.schedule(t,0,{index:n,count:s,start:r,subscriber:e});for(;;){if(n++>=s){e.complete();break}if(e.next(o++),e.closed)break}})}function t(e){var r=e.start,t=e.index,s=e.count,i=e.subscriber;t>=s?i.complete():(i.next(r),i.closed||(e.index=t+1,e.start=r+1,this.schedule(e)))}
},{"../Observable":"B88x"}],"pk5i":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timer=s;var e=require("../Observable"),r=require("../scheduler/async"),i=require("../util/isNumeric"),u=require("../util/isScheduler");function s(s,n,t){void 0===s&&(s=0);var d=-1;return(0,i.isNumeric)(n)?d=Number(n)<1?1:Number(n):(0,u.isScheduler)(n)&&(t=n),(0,u.isScheduler)(t)||(t=r.async),new e.Observable(function(e){var r=(0,i.isNumeric)(s)?s:+s-t.now();return t.schedule(c,r,{index:0,period:d,subscriber:e})})}function c(e){var r=e.index,i=e.period,u=e.subscriber;if(u.next(r),!u.closed){if(-1===i)return u.complete();e.index=r+1,this.schedule(e,i)}}
},{"../Observable":"B88x","../scheduler/async":"FFCS","../util/isNumeric":"DEZm","../util/isScheduler":"BtYd"}],"dcFY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.using=t;var r=require("../Observable"),e=require("./from"),u=require("./empty");function t(t,n){return new r.Observable(function(r){var i,s;try{i=t()}catch(e){return void r.error(e)}try{s=n(i)}catch(e){return void r.error(e)}var o=(s?(0,e.from)(s):u.EMPTY).subscribe(r);return function(){o.unsubscribe(),i&&i.unsubscribe()}})}
},{"../Observable":"B88x","./from":"LnUO","./empty":"5BP8"}],"12fO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ZipSubscriber=exports.ZipOperator=void 0,exports.zip=l;var t=require("tslib"),e=a(t),r=require("./fromArray"),i=require("../util/isArray"),n=require("../Subscriber"),o=require("../OuterSubscriber"),s=require("../util/subscribeToResult"),u=require("../../internal/symbol/iterator");function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[t.length-1];return"function"==typeof i&&t.pop(),(0,r.fromArray)(t,void 0).lift(new h(i))}var h=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.resultSelector))},t}();exports.ZipOperator=h;var p=function(t){function r(e,r,i){void 0===i&&(i=Object.create(null));var n=t.call(this,e)||this;return n.iterators=[],n.active=0,n.resultSelector="function"==typeof r?r:null,n.values=i,n}return e.__extends(r,t),r.prototype._next=function(t){var e=this.iterators;(0,i.isArray)(t)?e.push(new f(t)):"function"==typeof t[u.iterator]?e.push(new c(t[u.iterator]())):e.push(new y(this.destination,this,t))},r.prototype._complete=function(){var t=this.iterators,e=t.length;if(0!==e){this.active=e;for(var r=0;r<e;r++){var i=t[r];i.stillUnsubscribed?this.add(i.subscribe(i,r)):this.active--}}else this.destination.complete()},r.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},r.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,i=0;i<e;i++){if("function"==typeof(s=t[i]).hasValue&&!s.hasValue())return}var n=!1,o=[];for(i=0;i<e;i++){var s,u=(s=t[i]).next();if(s.hasCompleted()&&(n=!0),u.done)return void r.complete();o.push(u.value)}this.resultSelector?this._tryresultSelector(o):r.next(o),n&&r.complete()},r.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(n.Subscriber);exports.ZipSubscriber=p;var c=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),f=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[u.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),y=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.parent=r,n.observable=i,n.stillUnsubscribed=!0,n.buffer=[],n.isComplete=!1,n}return e.__extends(r,t),r.prototype[u.iterator]=function(){return this},r.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},r.prototype.hasValue=function(){return this.buffer.length>0},r.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},r.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},r.prototype.notifyNext=function(t,e,r,i,n){this.buffer.push(e),this.parent.checkIterators()},r.prototype.subscribe=function(t,e){return(0,s.subscribeToResult)(this,this.observable,this,e)},r}(o.OuterSubscriber);
},{"tslib":"7aRT","./fromArray":"WFxi","../util/isArray":"xunG","../Subscriber":"Qs1E","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU","../../internal/symbol/iterator":"OzfQ"}],"G8aM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./internal/Observable");Object.defineProperty(exports,"Observable",{enumerable:!0,get:function(){return e.Observable}});var r=require("./internal/observable/ConnectableObservable");Object.defineProperty(exports,"ConnectableObservable",{enumerable:!0,get:function(){return r.ConnectableObservable}});var t=require("./internal/operators/groupBy");Object.defineProperty(exports,"GroupedObservable",{enumerable:!0,get:function(){return t.GroupedObservable}});var n=require("./internal/symbol/observable");Object.defineProperty(exports,"observable",{enumerable:!0,get:function(){return n.observable}});var i=require("./internal/Subject");Object.defineProperty(exports,"Subject",{enumerable:!0,get:function(){return i.Subject}});var u=require("./internal/BehaviorSubject");Object.defineProperty(exports,"BehaviorSubject",{enumerable:!0,get:function(){return u.BehaviorSubject}});var o=require("./internal/ReplaySubject");Object.defineProperty(exports,"ReplaySubject",{enumerable:!0,get:function(){return o.ReplaySubject}});var a=require("./internal/AsyncSubject");Object.defineProperty(exports,"AsyncSubject",{enumerable:!0,get:function(){return a.AsyncSubject}});var b=require("./internal/scheduler/asap");Object.defineProperty(exports,"asapScheduler",{enumerable:!0,get:function(){return b.asap}});var l=require("./internal/scheduler/async");Object.defineProperty(exports,"asyncScheduler",{enumerable:!0,get:function(){return l.async}});var c=require("./internal/scheduler/queue");Object.defineProperty(exports,"queueScheduler",{enumerable:!0,get:function(){return c.queue}});var p=require("./internal/scheduler/animationFrame");Object.defineProperty(exports,"animationFrameScheduler",{enumerable:!0,get:function(){return p.animationFrame}});var s=require("./internal/scheduler/VirtualTimeScheduler");Object.defineProperty(exports,"VirtualTimeScheduler",{enumerable:!0,get:function(){return s.VirtualTimeScheduler}}),Object.defineProperty(exports,"VirtualAction",{enumerable:!0,get:function(){return s.VirtualAction}});var f=require("./internal/Scheduler");Object.defineProperty(exports,"Scheduler",{enumerable:!0,get:function(){return f.Scheduler}});var v=require("./internal/Subscription");Object.defineProperty(exports,"Subscription",{enumerable:!0,get:function(){return v.Subscription}});var m=require("./internal/Subscriber");Object.defineProperty(exports,"Subscriber",{enumerable:!0,get:function(){return m.Subscriber}});var d=require("./internal/Notification");Object.defineProperty(exports,"Notification",{enumerable:!0,get:function(){return d.Notification}});var g=require("./internal/util/pipe");Object.defineProperty(exports,"pipe",{enumerable:!0,get:function(){return g.pipe}});var y=require("./internal/util/noop");Object.defineProperty(exports,"noop",{enumerable:!0,get:function(){return y.noop}});var O=require("./internal/util/identity");Object.defineProperty(exports,"identity",{enumerable:!0,get:function(){return O.identity}});var j=require("./internal/util/isObservable");Object.defineProperty(exports,"isObservable",{enumerable:!0,get:function(){return j.isObservable}});var P=require("./internal/util/ArgumentOutOfRangeError");Object.defineProperty(exports,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return P.ArgumentOutOfRangeError}});var x=require("./internal/util/EmptyError");Object.defineProperty(exports,"EmptyError",{enumerable:!0,get:function(){return x.EmptyError}});var q=require("./internal/util/ObjectUnsubscribedError");Object.defineProperty(exports,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return q.ObjectUnsubscribedError}});var E=require("./internal/util/UnsubscriptionError");Object.defineProperty(exports,"UnsubscriptionError",{enumerable:!0,get:function(){return E.UnsubscriptionError}});var S=require("./internal/util/TimeoutError");Object.defineProperty(exports,"TimeoutError",{enumerable:!0,get:function(){return S.TimeoutError}});var h=require("./internal/observable/bindCallback");Object.defineProperty(exports,"bindCallback",{enumerable:!0,get:function(){return h.bindCallback}});var N=require("./internal/observable/bindNodeCallback");Object.defineProperty(exports,"bindNodeCallback",{enumerable:!0,get:function(){return N.bindNodeCallback}});var R=require("./internal/observable/combineLatest");Object.defineProperty(exports,"combineLatest",{enumerable:!0,get:function(){return R.combineLatest}});var k=require("./internal/observable/concat");Object.defineProperty(exports,"concat",{enumerable:!0,get:function(){return k.concat}});var C=require("./internal/observable/defer");Object.defineProperty(exports,"defer",{enumerable:!0,get:function(){return C.defer}});var A=require("./internal/observable/empty");Object.defineProperty(exports,"empty",{enumerable:!0,get:function(){return A.empty}});var T=require("./internal/observable/forkJoin");Object.defineProperty(exports,"forkJoin",{enumerable:!0,get:function(){return T.forkJoin}});var V=require("./internal/observable/from");Object.defineProperty(exports,"from",{enumerable:!0,get:function(){return V.from}});var U=require("./internal/observable/fromEvent");Object.defineProperty(exports,"fromEvent",{enumerable:!0,get:function(){return U.fromEvent}});var B=require("./internal/observable/fromEventPattern");Object.defineProperty(exports,"fromEventPattern",{enumerable:!0,get:function(){return B.fromEventPattern}});var w=require("./internal/observable/generate");Object.defineProperty(exports,"generate",{enumerable:!0,get:function(){return w.generate}});var z=require("./internal/observable/iif");Object.defineProperty(exports,"iif",{enumerable:!0,get:function(){return z.iif}});var F=require("./internal/observable/interval");Object.defineProperty(exports,"interval",{enumerable:!0,get:function(){return F.interval}});var J=require("./internal/observable/merge");Object.defineProperty(exports,"merge",{enumerable:!0,get:function(){return J.merge}});var L=require("./internal/observable/never");Object.defineProperty(exports,"never",{enumerable:!0,get:function(){return L.never}});var M=require("./internal/observable/of");Object.defineProperty(exports,"of",{enumerable:!0,get:function(){return M.of}});var G=require("./internal/observable/onErrorResumeNext");Object.defineProperty(exports,"onErrorResumeNext",{enumerable:!0,get:function(){return G.onErrorResumeNext}});var Y=require("./internal/observable/pairs");Object.defineProperty(exports,"pairs",{enumerable:!0,get:function(){return Y.pairs}});var _=require("./internal/observable/race");Object.defineProperty(exports,"race",{enumerable:!0,get:function(){return _.race}});var D=require("./internal/observable/range");Object.defineProperty(exports,"range",{enumerable:!0,get:function(){return D.range}});var H=require("./internal/observable/throwError");Object.defineProperty(exports,"throwError",{enumerable:!0,get:function(){return H.throwError}});var I=require("./internal/observable/timer");Object.defineProperty(exports,"timer",{enumerable:!0,get:function(){return I.timer}});var K=require("./internal/observable/using");Object.defineProperty(exports,"using",{enumerable:!0,get:function(){return K.using}});var Q=require("./internal/observable/zip");Object.defineProperty(exports,"zip",{enumerable:!0,get:function(){return Q.zip}}),Object.defineProperty(exports,"EMPTY",{enumerable:!0,get:function(){return A.EMPTY}}),Object.defineProperty(exports,"NEVER",{enumerable:!0,get:function(){return L.NEVER}});var W=require("./internal/config");Object.defineProperty(exports,"config",{enumerable:!0,get:function(){return W.config}});
},{"./internal/Observable":"B88x","./internal/observable/ConnectableObservable":"GCtA","./internal/operators/groupBy":"pn8u","./internal/symbol/observable":"xulG","./internal/Subject":"NfWW","./internal/BehaviorSubject":"VGg9","./internal/ReplaySubject":"PGZW","./internal/AsyncSubject":"Yp3O","./internal/scheduler/asap":"q4Vt","./internal/scheduler/async":"FFCS","./internal/scheduler/queue":"ZPI1","./internal/scheduler/animationFrame":"UL2g","./internal/scheduler/VirtualTimeScheduler":"0pwH","./internal/Scheduler":"aJUP","./internal/Subscription":"mK8y","./internal/Subscriber":"Qs1E","./internal/Notification":"CJua","./internal/util/pipe":"RCIL","./internal/util/noop":"BUGg","./internal/util/identity":"Xo/Y","./internal/util/isObservable":"TYyN","./internal/util/ArgumentOutOfRangeError":"p9/g","./internal/util/EmptyError":"MbJR","./internal/util/ObjectUnsubscribedError":"6hpt","./internal/util/UnsubscriptionError":"IbVU","./internal/util/TimeoutError":"RGBD","./internal/observable/bindCallback":"Ux7p","./internal/observable/bindNodeCallback":"AdBT","./internal/observable/combineLatest":"vI5W","./internal/observable/concat":"g+vB","./internal/observable/defer":"F9YC","./internal/observable/empty":"5BP8","./internal/observable/forkJoin":"ev4H","./internal/observable/from":"LnUO","./internal/observable/fromEvent":"Dv8L","./internal/observable/fromEventPattern":"w0Xq","./internal/observable/generate":"d4wx","./internal/observable/iif":"p8+r","./internal/observable/interval":"SmEM","./internal/observable/merge":"sLBY","./internal/observable/never":"ZnUi","./internal/observable/of":"aGxf","./internal/observable/onErrorResumeNext":"8V3l","./internal/observable/pairs":"Q/xt","./internal/observable/race":"0Naf","./internal/observable/range":"L6WQ","./internal/observable/throwError":"BXbb","./internal/observable/timer":"pk5i","./internal/observable/using":"dcFY","./internal/observable/zip":"12fO","./internal/config":"QqL1"}],"zK9S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SETTINGS={color:{white:"#d6d6d6",red:"#be3e2b",blue:"#34738f",yellow:"#f6de6c"},strokeWidth:{point:11,line:3,circle:3}};
},{}],"b6yI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./settings");exports.FABRIC_SETTINGS={canvas:{selection:!1,backgroundColor:e.SETTINGS.color.white},point:{strokeWidth:1,radius:e.SETTINGS.strokeWidth.point/2,fill:e.SETTINGS.color.red,stroke:e.SETTINGS.color.red,hoverCursor:"default",selectable:!1,hasControls:!1,hasBorders:!1},line:{fill:e.SETTINGS.color.blue,stroke:e.SETTINGS.color.blue,strokeWidth:e.SETTINGS.strokeWidth.line,hoverCursor:"default",selectable:!1},circle:{strokeWidth:e.SETTINGS.strokeWidth.circle,stroke:e.SETTINGS.color.yellow,fill:"transparent",hoverCursor:"default",selectable:!1,hasControls:!1,hasBorders:!1}};
},{"./settings":"zK9S"}],"Ewqz":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function r(){n(this,r)}return e(r,null,[{key:"identifier",value:function(){return String((new Date).getTime())+Math.round(1e6*Math.random())}}]),r}();exports.RandomGenerator=r;
},{}],"/6Wx":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(n,s){t(this,e),this.x=n,this.y=s};exports.Delta=e;
},{}],"P0zd":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var u=t[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}return function(t,n,u){return n&&e(t.prototype,n),u&&e(t,u),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("rxjs"),u=function(){function u(){t(this,u),this.updateSubject=new n.Subject,this.subscriptions=[]}return e(u,[{key:"whenUpdated",value:function(e){var t=this.updateSubject.subscribe(function(t){return e(t)});this.subscriptions.push(t)}},{key:"destroySubscriptions",value:function(){this.subscriptions.forEach(function(e){e.unsubscribe()})}},{key:"notifyUpdate",value:function(e){this.updateSubject.next(e)}}]),u}();exports.Updatable=u;
},{"rxjs":"G8aM"}],"bg89":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=require("../service/util/random-generator"),i=require("./delta"),u=require("./updatable"),a=function(a){function s(e,n){t(this,s);var i=r(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return i._x=e,i._y=n,i.id=o.RandomGenerator.identifier(),i}return n(s,u.Updatable),e(s,[{key:"isEqualTo",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"getDistanceTo",value:function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}},{key:"updateTo",value:function(e,t){if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){var r=new i.Delta(this.x-e,this.y-t);this.notifyUpdate(r)}this._x=e,this._y=t}},{key:"toString",value:function(){return"("+this.x.toFixed(0)+", "+this.y.toFixed(0)+")"}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),s}();exports.Point=a;
},{"../service/util/random-generator":"Ewqz","./delta":"/6Wx","./updatable":"P0zd"}],"d8cR":[function(require,module,exports) {
"use strict";var e=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();function r(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function t(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(){t(this,n),this.points=new Map,this.parallelogram=[]}return e(n,[{key:"storePoint",value:function(e,r){this.points.set(e.id,r)}},{key:"storeParallelogram",value:function(e){var t;(t=this.parallelogram).splice.apply(t,[0,this.parallelogram.length].concat(r(e)))}},{key:"storeCircle",value:function(e){this.circle=e}},{key:"forCanvasPoint",value:function(e,r){r(this.points.get(e.id))}},{key:"forEachPoint",value:function(e){this.points.forEach(function(r){return e(r)})}},{key:"forEachParallelogramLine",value:function(e){this.parallelogram.forEach(function(r){return e(r)})}},{key:"forCircle",value:function(e){e(this.circle)}},{key:"clear",value:function(){this.points.clear(),this.parallelogram.splice(0,this.parallelogram.length),this.circle=null}}]),n}();exports.CanvasStore=n;
},{}],"ar8D":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("fabric"),i=require("rxjs"),a=require("../../config/fabric-settings"),r=require("../../domain/point"),o=require("./canvas-store"),s=function(){function s(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new o.CanvasStore;n(this,s),this.store=i,this.canvas=new t.fabric.Canvas(e,Object.assign({},a.FABRIC_SETTINGS.canvas,{height:window.innerHeight,width:window.innerWidth})),this.configureCanvasAdditionalSettings(),this.updateCanvasDimensionOnWindowResize()}return e(s,[{key:"onCanvasClicked",value:function(){var e=this;return new i.Observable(function(n){e.canvas.on("mouse:up",function(e){var t=e.e;n.next(new r.Point(t.x,t.y))})})}},{key:"paintPoint",value:function(e){var n=new t.fabric.Circle(Object.assign({},a.FABRIC_SETTINGS.point,{left:e.x,top:e.y}));return n.on("moving",function(n){var t=n.e;e.updateTo(t.x,t.y)}),this.addToCanvas(n),this.store.storePoint(e,n),n}},{key:"paintParallelogram",value:function(e){var n=[];n.push(this.paintLineSegment(e.point1,e.point2)),n.push(this.paintLineSegment(e.point1,e.point3)),n.push(this.paintLineSegment(e.point2,e.point4)),n.push(this.paintLineSegment(e.point3,e.point4)),this.store.storeParallelogram(n)}},{key:"paintCircle",value:function(e){var n=new t.fabric.Circle(Object.assign({},a.FABRIC_SETTINGS.circle,{left:e.center.x,top:e.center.y,radius:e.radius}));this.addToCanvas(n),n.sendToBack(),this.store.storeCircle(n)}},{key:"movePoint",value:function(e){var n=this;this.store.forCanvasPoint(e,function(e){n.canvas.remove(e)});var t=this.paintPoint(e);this.makeSelectable(t)}},{key:"moveParallelogram",value:function(e){var n=this;this.store.forEachParallelogramLine(function(e){return n.canvas.remove(e)}),this.paintParallelogram(e)}},{key:"moveCircle",value:function(e){isNaN(e.radius)||this.store.forCircle(function(n){n.set({radius:e.radius,top:e.center.y,left:e.center.x})})}},{key:"makePointsSelectable",value:function(){var e=this;this.store.forEachPoint(function(n){e.makeSelectable(n)})}},{key:"clear",value:function(){var e=this;this.store.clear(),this.canvas.getObjects().forEach(function(n){e.canvas.remove(n)}),this.canvas.renderAll()}},{key:"paintLineSegment",value:function(e,n){var i=[e.x,e.y,n.x,n.y],r=new t.fabric.Line(i,Object.assign({},a.FABRIC_SETTINGS.line));return this.addToCanvas(r),r.sendToBack(),r}},{key:"addToCanvas",value:function(e){this.canvas.add(e)}},{key:"makeSelectable",value:function(e){e.set({selectable:!0,hoverCursor:"move"})}},{key:"updateCanvasDimensionOnWindowResize",value:function(){var e=this;window.addEventListener("resize",function(){e.canvas.setDimensions({width:window.innerWidth,height:window.innerHeight})})}},{key:"configureCanvasAdditionalSettings",value:function(){t.fabric.Object.prototype.originX=t.fabric.Object.prototype.originY="center"}}]),s}();exports.Painter=s;
},{"fabric":"jphU","rxjs":"G8aM","../../config/fabric-settings":"b6yI","../../domain/point":"bg89","./canvas-store":"d8cR"}],"+SsL":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(){t(this,n),this.pointRows=new Map}return e(n,[{key:"savePointRow",value:function(e,t){this.pointRows.set(e.id,t)}},{key:"getRowForPoint",value:function(e){return this.pointRows.get(e.id)}},{key:"clear",value:function(){this.pointRows.clear()}}]),n}();exports.RowStore=n;
},{}],"BFB5":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("./row-store"),a=function(){function a(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new n.RowStore;t(this,a),this.store=i;var r=document.getElementById(e);this.table=r.getElementsByTagName("table").item(0);var o=r.getElementsByTagName("button");this.restartButton=o.item(0),this.aboutButton=o.item(1)}return e(a,[{key:"displayPointInfo",value:function(e){var t=this,n=this.addRow("Point "+(this.table.children.length+1),e);this.store.savePointRow(e,n),e.whenUpdated(function(){t.updateRowValue(n,e)})}},{key:"displayParallelogramInfo",value:function(e){this.displayCenterOfMassInfo(e),this.displayAreaInfo(e)}},{key:"updatePointInfo",value:function(e){var t=this.store.getRowForPoint(e);this.updateRowValue(t,e)}},{key:"onStartAgainClicked",value:function(e){this.restartButton.addEventListener("click",e)}},{key:"enableStartAgainButton",value:function(){this.restartButton.disabled=!1}},{key:"onAboutClicked",value:function(e){this.aboutButton.addEventListener("click",e)}},{key:"clear",value:function(){this.store.clear(),this.clearTable(),this.restartButton.disabled=!0}},{key:"displayCenterOfMassInfo",value:function(e){var t=this,n=this.addRow("Center of mass",e.centerOfMass);e.whenUpdated(function(){t.updateRowValue(n,e.centerOfMass)})}},{key:"displayAreaInfo",value:function(e){var t=this,n=this.addRow("Area",e.area.toFixed(0));e.whenUpdated(function(){t.updateRowValue(n,e.area.toFixed(0))})}},{key:"addRow",value:function(e,t){var n=this.createElement("th",e),a=this.createElement("td",String(t)),i=this.createElementContaining("tr",[n,a]);return this.table.appendChild(i),i}},{key:"updateRowValue",value:function(e,t){e.children.item(1).innerHTML=String(t)}},{key:"createElement",value:function(e,t){var n=document.createElement(e);return n.innerHTML=t,n}},{key:"createElementContaining",value:function(e,t){var n=document.createElement(e);return t.forEach(function(e){return n.appendChild(e)}),n}},{key:"clearTable",value:function(){for(;this.table.hasChildNodes();)this.table.removeChild(this.table.lastChild)}}]),a}();exports.InfoBar=a;
},{"./row-store":"+SsL"}],"pl75":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.audit=s;var t=require("tslib"),e=n(t),r=require("../util/tryCatch"),i=require("../util/errorObject"),o=require("../OuterSubscriber"),u=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function s(t){return function(e){return e.lift(new l(t))}}var l=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.durationSelector))},t}(),a=function(t){function o(e,r){var i=t.call(this,e)||this;return i.durationSelector=r,i.hasValue=!1,i}return e.__extends(o,t),o.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=(0,r.tryCatch)(this.durationSelector)(t);if(e===i.errorObject)this.destination.error(i.errorObject.e);else{var o=(0,u.subscribeToResult)(this,e);!o||o.closed?this.clearThrottle():this.add(this.throttled=o)}}},o.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},o.prototype.notifyNext=function(t,e,r,i){this.clearThrottle()},o.prototype.notifyComplete=function(){this.clearThrottle()},o}(o.OuterSubscriber);
},{"tslib":"7aRT","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"UsjT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.auditTime=i;var e=require("../scheduler/async"),r=require("./audit"),t=require("../observable/timer");function i(i,u){return void 0===u&&(u=e.async),(0,r.audit)(function(){return(0,t.timer)(i,u)})}
},{"../scheduler/async":"FFCS","./audit":"pl75","../observable/timer":"pk5i"}],"YpQd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=n;var t=require("tslib"),e=u(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.closingNotifier))},t}(),s=function(t){function r(e,r){var u=t.call(this,e)||this;return u.buffer=[],u.add((0,i.subscribeToResult)(u,r)),u}return e.__extends(r,t),r.prototype._next=function(t){this.buffer.push(t)},r.prototype.notifyNext=function(t,e,r,i,u){var n=this.buffer;this.buffer=[],this.destination.next(n)},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"L2rV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferCount=n;var t=require("tslib"),e=i(t),r=require("../Subscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t,e){return void 0===e&&(e=null),function(r){return r.lift(new s(t,e))}}var s=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?f:u}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),u=function(t){function r(e,r){var i=t.call(this,e)||this;return i.bufferSize=r,i.buffer=[],i}return e.__extends(r,t),r.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},r.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},r}(r.Subscriber),f=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.bufferSize=r,n.startBufferEvery=i,n.buffers=[],n.count=0,n}return e.__extends(r,t),r.prototype._next=function(t){var e=this.bufferSize,r=this.startBufferEvery,i=this.buffers,n=this.count;this.count++,n%r==0&&i.push([]);for(var s=i.length;s--;){var u=i[s];u.push(t),u.length===e&&(i.splice(s,1),this.destination.next(u))}},r.prototype._complete=function(){for(var e=this.buffers,r=this.destination;e.length>0;){var i=e.shift();i.length>0&&r.next(i)}t.prototype._complete.call(this)},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"q2KB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferTime=o;var e=require("tslib"),t=s(e),r=require("../scheduler/async"),n=require("../Subscriber"),i=require("../util/isScheduler");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){var t=arguments.length,n=r.async;(0,i.isScheduler)(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],t--);var s=null;t>=2&&(s=arguments[1]);var o=Number.POSITIVE_INFINITY;return t>=3&&(o=arguments[2]),function(t){return t.lift(new u(e,s,o,n))}}var u=function(){function e(e,t,r,n){this.bufferTimeSpan=e,this.bufferCreationInterval=t,this.maxBufferSize=r,this.scheduler=n}return e.prototype.call=function(e,t){return t.subscribe(new f(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},e}(),c=function(){return function(){this.buffer=[]}}(),f=function(e){function r(t,r,n,i,s){var o=e.call(this,t)||this;o.bufferTimeSpan=r,o.bufferCreationInterval=n,o.maxBufferSize=i,o.scheduler=s,o.contexts=[];var u=o.openContext();if(o.timespanOnly=null==n||n<0,o.timespanOnly){var c={subscriber:o,context:u,bufferTimeSpan:r};o.add(u.closeAction=s.schedule(l,r,c))}else{var f={subscriber:o,context:u},b={bufferTimeSpan:r,bufferCreationInterval:n,subscriber:o,scheduler:s};o.add(u.closeAction=s.schedule(h,r,f)),o.add(s.schedule(a,n,b))}return o}return t.__extends(r,e),r.prototype._next=function(e){for(var t,r=this.contexts,n=r.length,i=0;i<n;i++){var s=r[i],o=s.buffer;o.push(e),o.length==this.maxBufferSize&&(t=s)}t&&this.onBufferFull(t)},r.prototype._error=function(t){this.contexts.length=0,e.prototype._error.call(this,t)},r.prototype._complete=function(){for(var t=this.contexts,r=this.destination;t.length>0;){var n=t.shift();r.next(n.buffer)}e.prototype._complete.call(this)},r.prototype._unsubscribe=function(){this.contexts=null},r.prototype.onBufferFull=function(e){this.closeContext(e);var t=e.closeAction;if(t.unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){e=this.openContext();var r=this.bufferTimeSpan,n={subscriber:this,context:e,bufferTimeSpan:r};this.add(e.closeAction=this.scheduler.schedule(l,r,n))}},r.prototype.openContext=function(){var e=new c;return this.contexts.push(e),e},r.prototype.closeContext=function(e){this.destination.next(e.buffer);var t=this.contexts;(t?t.indexOf(e):-1)>=0&&t.splice(t.indexOf(e),1)},r}(n.Subscriber);function l(e){var t=e.subscriber,r=e.context;r&&t.closeContext(r),t.closed||(e.context=t.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function a(e){var t=e.bufferCreationInterval,r=e.bufferTimeSpan,n=e.subscriber,i=e.scheduler,s=n.openContext();n.closed||(n.add(s.closeAction=i.schedule(h,r,{subscriber:n,context:s})),this.schedule(e,t))}function h(e){var t=e.subscriber,r=e.context;t.closeContext(r)}
},{"tslib":"7aRT","../scheduler/async":"FFCS","../Subscriber":"Qs1E","../util/isScheduler":"BtYd"}],"E7G3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferToggle=s;var t=require("tslib"),e=n(t),r=require("../Subscription"),i=require("../util/subscribeToResult"),o=require("../OuterSubscriber");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function s(t,e){return function(r){return r.lift(new u(t,e))}}var u=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.openings,this.closingSelector))},t}(),c=function(t){function o(e,r,o){var n=t.call(this,e)||this;return n.openings=r,n.closingSelector=o,n.contexts=[],n.add((0,i.subscribeToResult)(n,r)),n}return e.__extends(o,t),o.prototype._next=function(t){for(var e=this.contexts,r=e.length,i=0;i<r;i++)e[i].buffer.push(t)},o.prototype._error=function(e){for(var r=this.contexts;r.length>0;){var i=r.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},o.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var r=e.shift();this.destination.next(r.buffer),r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._complete.call(this)},o.prototype.notifyNext=function(t,e,r,i,o){t?this.closeBuffer(t):this.openBuffer(e)},o.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},o.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},o.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var r=t.buffer,i=t.subscription;this.destination.next(r),e.splice(e.indexOf(t),1),this.remove(i),i.unsubscribe()}},o.prototype.trySubscribe=function(t){var e=this.contexts,o=new r.Subscription,n={buffer:[],subscription:o};e.push(n);var s=(0,i.subscribeToResult)(this,t,n);!s||s.closed?this.closeBuffer(n):(s.context=n,this.add(s),o.add(s))},o}(o.OuterSubscriber);
},{"tslib":"7aRT","../Subscription":"mK8y","../util/subscribeToResult":"9sHU","../OuterSubscriber":"87n1"}],"pPew":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferWhen=c;var t=require("tslib"),e=u(t),r=require("../Subscription"),i=require("../util/tryCatch"),n=require("../util/errorObject"),s=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function c(t){return function(e){return e.lift(new f(t))}}var f=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new b(t,this.closingSelector))},t}(),b=function(t){function s(e,r){var i=t.call(this,e)||this;return i.closingSelector=r,i.subscribing=!1,i.openBuffer(),i}return e.__extends(s,t),s.prototype._next=function(t){this.buffer.push(t)},s.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},s.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},s.prototype.notifyNext=function(t,e,r,i,n){this.openBuffer()},s.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},s.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e=this.buffer;this.buffer&&this.destination.next(e),this.buffer=[];var s=(0,i.tryCatch)(this.closingSelector)();s===n.errorObject?this.error(n.errorObject.e):(t=new r.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add((0,o.subscribeToResult)(this,s)),this.subscribing=!1)},s}(s.OuterSubscriber);
},{"tslib":"7aRT","../Subscription":"mK8y","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"TXdn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.catchError=s;var r=require("tslib"),t=i(r),e=require("../OuterSubscriber"),u=require("../util/subscribeToResult");function i(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function s(r){return function(t){var e=new c(r),u=t.lift(e);return e.caught=u}}var c=function(){function r(r){this.selector=r}return r.prototype.call=function(r,t){return t.subscribe(new n(r,this.selector,this.caught))},r}(),n=function(r){function e(t,e,u){var i=r.call(this,t)||this;return i.selector=e,i.caught=u,i}return t.__extends(e,r),e.prototype.error=function(t){if(!this.isStopped){var e=void 0;try{e=this.selector(t,this.caught)}catch(t){return void r.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),this.add((0,u.subscribeToResult)(this,e))}},e}(e.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"7cm5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.combineAll=t;var e=require("../observable/combineLatest");function t(t){return function(r){return r.lift(new e.CombineLatestOperator(t))}}
},{"../observable/combineLatest":"vI5W"}],"CWCf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.combineLatest=n;var e=require("../util/isArray"),r=require("../observable/combineLatest"),t=require("../observable/from"),o={};function n(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var i=null;return"function"==typeof o[o.length-1]&&(i=o.pop()),1===o.length&&(0,e.isArray)(o[0])&&(o=o[0].slice()),function(e){return e.lift.call((0,t.from)([e].concat(o)),new r.CombineLatestOperator(i))}}
},{"../util/isArray":"xunG","../observable/combineLatest":"vI5W","../observable/from":"LnUO"}],"/N1E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concat=t;var e=require("../observable/concat");function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r){return r.lift.call(e.concat.apply(void 0,[r].concat(t)))}}
},{"../observable/concat":"g+vB"}],"wzcJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatMap=r;var e=require("./mergeMap");function r(r,t){return(0,e.mergeMap)(r,t,1)}
},{"./mergeMap":"I5oK"}],"cEOt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatMapTo=t;var e=require("./concatMap");function t(t,r){return(0,e.concatMap)(function(){return t},r)}
},{"./concatMap":"wzcJ"}],"ItUr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.count=n;var t=require("tslib"),e=i(t),r=require("../Subscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t){return function(e){return e.lift(new o(t,e))}}var o=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.predicate,this.source))},t}(),c=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.predicate=r,n.source=i,n.count=0,n.index=0,n}return e.__extends(r,t),r.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},r.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},r.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"xwCK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=n;var t=require("tslib"),e=u(t),i=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.durationSelector))},t}(),s=function(t){function i(e,i){var r=t.call(this,e)||this;return r.durationSelector=i,r.hasValue=!1,r.durationSubscription=null,r}return e.__extends(i,t),i.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},i.prototype._complete=function(){this.emitValue(),this.destination.complete()},i.prototype._tryNext=function(t,e){var i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),(i=(0,r.subscribeToResult)(this,e))&&!i.closed&&this.add(this.durationSubscription=i)},i.prototype.notifyNext=function(t,e,i,r,u){this.emitValue()},i.prototype.notifyComplete=function(){this.emitValue()},i.prototype.emitValue=function(){if(this.hasValue){var e=this.value,i=this.durationSubscription;i&&(this.durationSubscription=null,i.unsubscribe(),this.remove(i)),this.value=null,this.hasValue=!1,t.prototype._next.call(this,e)}},i}(i.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"B6x9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounceTime=r;var e=require("tslib"),t=n(e),u=require("../Subscriber"),i=require("../scheduler/async");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&(t[u]=e[u]);return t.default=e,t}function r(e,t){return void 0===t&&(t=i.async),function(u){return u.lift(new s(e,t))}}var s=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.dueTime,this.scheduler))},e}(),o=function(e){function u(t,u,i){var n=e.call(this,t)||this;return n.dueTime=u,n.scheduler=i,n.debouncedSubscription=null,n.lastValue=null,n.hasValue=!1,n}return t.__extends(u,e),u.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(c,this.dueTime,this))},u.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},u.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},u.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},u}(u.Subscriber);function c(e){e.debouncedNext()}
},{"tslib":"7aRT","../Subscriber":"Qs1E","../scheduler/async":"FFCS"}],"WMek":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultIfEmpty=r;var t=require("tslib"),e=i(t),n=require("../Subscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return void 0===t&&(t=null),function(e){return e.lift(new u(t))}}var u=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.defaultValue))},t}(),o=function(t){function n(e,n){var i=t.call(this,e)||this;return i.defaultValue=n,i.isEmpty=!0,i}return e.__extends(n,t),n.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},n.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},n}(n.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"Rb1P":[function(require,module,exports) {
"use strict";function e(e){return e instanceof Date&&!isNaN(+e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDate=e;
},{}],"wqoi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.delay=u;var e=require("tslib"),t=s(e),i=require("../scheduler/async"),r=require("../util/isDate"),n=require("../Subscriber"),o=require("../Notification");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function u(e,t){void 0===t&&(t=i.async);var n=(0,r.isDate)(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new c(n,t))}}var c=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.delay,this.scheduler))},e}(),a=function(e){function i(t,i,r){var n=e.call(this,t)||this;return n.delay=i,n.scheduler=r,n.queue=[],n.active=!1,n.errored=!1,n}return t.__extends(i,e),i.dispatch=function(e){for(var t=e.source,i=t.queue,r=e.scheduler,n=e.destination;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(n);if(i.length>0){var o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},i.prototype._schedule=function(e){this.active=!0,this.add(e.schedule(i.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},i.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,i=new h(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}},i.prototype._next=function(e){this.scheduleNotification(o.Notification.createNext(e))},i.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e)},i.prototype._complete=function(){this.scheduleNotification(o.Notification.createComplete())},i}(n.Subscriber),h=function(){return function(e,t){this.time=e,this.notification=t}}();
},{"tslib":"7aRT","../scheduler/async":"FFCS","../util/isDate":"Rb1P","../Subscriber":"Qs1E","../Notification":"CJua"}],"EkH9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.delayWhen=u;var t=require("tslib"),e=s(t),r=require("../Subscriber"),i=require("../Observable"),o=require("../OuterSubscriber"),n=require("../util/subscribeToResult");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t,e){return e?function(r){return new l(r,e).lift(new c(t))}:function(e){return e.lift(new c(t))}}var c=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.delayDurationSelector))},t}(),p=function(t){function r(e,r){var i=t.call(this,e)||this;return i.delayDurationSelector=r,i.completed=!1,i.delayNotifierSubscriptions=[],i}return e.__extends(r,t),r.prototype.notifyNext=function(t,e,r,i,o){this.destination.next(t),this.removeSubscription(o),this.tryComplete()},r.prototype.notifyError=function(t,e){this._error(t)},r.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},r.prototype._next=function(t){try{var e=this.delayDurationSelector(t);e&&this.tryDelay(e,t)}catch(t){this.destination.error(t)}},r.prototype._complete=function(){this.completed=!0,this.tryComplete()},r.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},r.prototype.tryDelay=function(t,e){var r=(0,n.subscribeToResult)(this,t,e);r&&!r.closed&&(this.add(r),this.delayNotifierSubscriptions.push(r))},r.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},r}(o.OuterSubscriber),l=function(t){function r(e,r){var i=t.call(this)||this;return i.source=e,i.subscriptionDelay=r,i}return e.__extends(r,t),r.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new b(t,this.source))},r}(i.Observable),b=function(t){function r(e,r){var i=t.call(this)||this;return i.parent=e,i.source=r,i.sourceSubscribed=!1,i}return e.__extends(r,t),r.prototype._next=function(t){this.subscribeToSource()},r.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},r.prototype._complete=function(){this.subscribeToSource()},r.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Observable":"B88x","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"T9UD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dematerialize=i;var e=require("tslib"),r=n(e),t=require("../Subscriber");function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function i(){return function(e){return e.lift(new u)}}var u=function(){function e(){}return e.prototype.call=function(e,r){return r.subscribe(new o(e))},e}(),o=function(e){function t(r){return e.call(this,r)||this}return r.__extends(t,e),t.prototype._next=function(e){e.observe(this.destination)},t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"WOX4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DistinctSubscriber=void 0,exports.distinct=o;var t=require("tslib"),e=n(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function o(t,e){return function(r){return r.lift(new s(t,e))}}var s=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.keySelector,this.flushes))},t}(),u=function(t){function r(e,r,n){var o=t.call(this,e)||this;return o.keySelector=r,o.values=new Set,n&&o.add((0,i.subscribeToResult)(o,n)),o}return e.__extends(r,t),r.prototype.notifyNext=function(t,e,r,i,n){this.values.clear()},r.prototype.notifyError=function(t,e){this._error(t)},r.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},r.prototype._useKeySelector=function(t){var e,r=this.destination;try{e=this.keySelector(t)}catch(t){return void r.error(t)}this._finalizeNext(e,t)},r.prototype._finalizeNext=function(t,e){var r=this.values;r.has(t)||(r.add(t),this.destination.next(e))},r}(r.OuterSubscriber);exports.DistinctSubscriber=u;
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"4g3F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distinctUntilChanged=c;var e=require("tslib"),r=o(e),t=require("../Subscriber"),i=require("../util/tryCatch"),n=require("../util/errorObject");function o(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function c(e,r){return function(t){return t.lift(new s(e,r))}}var s=function(){function e(e,r){this.compare=e,this.keySelector=r}return e.prototype.call=function(e,r){return r.subscribe(new u(e,this.compare,this.keySelector))},e}(),u=function(e){function t(r,t,i){var n=e.call(this,r)||this;return n.keySelector=i,n.hasKey=!1,"function"==typeof t&&(n.compare=t),n}return r.__extends(t,e),t.prototype.compare=function(e,r){return e===r},t.prototype._next=function(e){var r=e;if(this.keySelector&&(r=(0,i.tryCatch)(this.keySelector)(e))===n.errorObject)return this.destination.error(n.errorObject.e);var t=!1;if(this.hasKey){if((t=(0,i.tryCatch)(this.compare)(this.key,r))===n.errorObject)return this.destination.error(n.errorObject.e)}else this.hasKey=!0;!1===Boolean(t)&&(this.key=r,this.destination.next(e))},t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/tryCatch":"BwKY","../util/errorObject":"IhTn"}],"PHGZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distinctUntilKeyChanged=e;var t=require("./distinctUntilChanged");function e(e,n){return(0,t.distinctUntilChanged)(function(t,i){return n?n(t[e],i[e]):t[e]===i[e]})}
},{"./distinctUntilChanged":"4g3F"}],"2Z4q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.filter=n;var t=require("tslib"),r=i(t),e=require("../Subscriber");function i(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r}function n(t,r){return function(e){return e.lift(new u(t,r))}}var u=function(){function t(t,r){this.predicate=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new s(t,this.predicate,this.thisArg))},t}(),s=function(t){function e(r,e,i){var n=t.call(this,r)||this;return n.predicate=e,n.thisArg=i,n.count=0,n}return r.__extends(e,t),e.prototype._next=function(t){var r;try{r=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}r&&this.destination.next(t)},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"5+df":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tap=p;var t=require("tslib"),r=i(t),e=require("../Subscriber"),o=require("../util/noop"),n=require("../util/isFunction");function i(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r}function p(t,r,e){return function(o){return o.lift(new s(t,r,e))}}var s=function(){function t(t,r,e){this.nextOrObserver=t,this.error=r,this.complete=e}return t.prototype.call=function(t,r){return r.subscribe(new c(t,this.nextOrObserver,this.error,this.complete))},t}(),c=function(t){function e(r,e,i,p){var s=t.call(this,r)||this;return s._tapNext=o.noop,s._tapError=o.noop,s._tapComplete=o.noop,s._tapError=i||o.noop,s._tapComplete=p||o.noop,(0,n.isFunction)(e)?(s._context=s,s._tapNext=e):e&&(s._context=e,s._tapNext=e.next||o.noop,s._tapError=e.error||o.noop,s._tapComplete=e.complete||o.noop),s}return r.__extends(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/noop":"BUGg","../util/isFunction":"gOFo"}],"hlGy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throwIfEmpty=void 0;var t=require("./tap"),e=require("../util/EmptyError"),r=exports.throwIfEmpty=function(e){return void 0===e&&(e=o),(0,t.tap)({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw e()}})};function o(){return new e.EmptyError}
},{"./tap":"5+df","../util/EmptyError":"MbJR"}],"95nX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.take=o;var t=require("tslib"),e=u(t),r=require("../Subscriber"),n=require("../util/ArgumentOutOfRangeError"),i=require("../observable/empty");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function o(t){return function(e){return 0===t?(0,i.empty)():e.lift(new s(t))}}var s=function(){function t(t){if(this.total=t,this.total<0)throw new n.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.total))},t}(),a=function(t){function r(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return e.__extends(r,t),r.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/ArgumentOutOfRangeError":"p9/g","../observable/empty":"5BP8"}],"3YiC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.elementAt=f;var e=require("../util/ArgumentOutOfRangeError"),r=require("./filter"),t=require("./throwIfEmpty"),u=require("./defaultIfEmpty"),n=require("./take");function f(f,i){if(f<0)throw new e.ArgumentOutOfRangeError;var o=arguments.length>=2;return function(a){return a.pipe((0,r.filter)(function(e,r){return r===f}),(0,n.take)(1),o?(0,u.defaultIfEmpty)(i):(0,t.throwIfEmpty)(function(){return new e.ArgumentOutOfRangeError}))}}
},{"../util/ArgumentOutOfRangeError":"p9/g","./filter":"2Z4q","./throwIfEmpty":"hlGy","./defaultIfEmpty":"WMek","./take":"95nX"}],"4eHk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.endWith=c;var e=require("../observable/fromArray"),r=require("../observable/scalar"),t=require("../observable/empty"),a=require("../observable/concat"),o=require("../util/isScheduler");function c(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return function(l){var n=c[c.length-1];(0,o.isScheduler)(n)?c.pop():n=null;var u=c.length;return 1!==u||n?u>0?(0,a.concat)(l,(0,e.fromArray)(c,n)):(0,a.concat)(l,(0,t.empty)(n)):(0,a.concat)(l,(0,r.scalar)(c[0]))}}
},{"../observable/fromArray":"WFxi","../observable/scalar":"q5qz","../observable/empty":"5BP8","../observable/concat":"g+vB","../util/isScheduler":"BtYd"}],"s+tD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.every=n;var t=require("tslib"),e=i(t),r=require("../Subscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t,e){return function(r){return r.lift(new o(t,e,r))}}var o=function(){function t(t,e,r){this.predicate=t,this.thisArg=e,this.source=r}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.predicate,this.thisArg,this.source))},t}(),s=function(t){function r(e,r,i,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=i,o.source=n,o.index=0,o.thisArg=i||o,o}return e.__extends(r,t),r.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},r.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},r.prototype._complete=function(){this.notifyComplete(!0)},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"6L1O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.exhaust=s;var t=require("tslib"),e=n(t),i=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function s(){return function(t){return t.lift(new o)}}var o=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new u(t))},t}(),u=function(t){function i(e){var i=t.call(this,e)||this;return i.hasCompleted=!1,i.hasSubscription=!1,i}return e.__extends(i,t),i.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add((0,r.subscribeToResult)(this,t)))},i.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},i.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},i}(i.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"dh+N":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.exhaustMap=u;var t=require("tslib"),e=s(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult"),n=require("./map"),o=require("../observable/from");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t,e){return e?function(r){return r.pipe(u(function(r,i){return(0,o.from)(t(r,i)).pipe((0,n.map)(function(t,n){return e(r,t,i,n)}))}))}:function(e){return e.lift(new p(t))}}var p=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.project))},t}(),c=function(t){function r(e,r){var i=t.call(this,e)||this;return i.project=r,i.hasSubscription=!1,i.hasCompleted=!1,i.index=0,i}return e.__extends(r,t),r.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},r.prototype.tryNext=function(t){var e=this.index++,r=this.destination;try{var n=this.project(t,e);this.hasSubscription=!0,this.add((0,i.subscribeToResult)(this,n,t,e))}catch(t){r.error(t)}},r.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},r.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},r.prototype.notifyError=function(t){this.destination.error(t)},r.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU","./map":"aORC","../observable/from":"LnUO"}],"xb4A":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExpandSubscriber=exports.ExpandOperator=void 0,exports.expand=u;var e=require("tslib"),t=n(e),r=require("../util/tryCatch"),i=require("../util/errorObject"),s=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function u(e,t,r){return void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===r&&(r=void 0),t=(t||0)<1?Number.POSITIVE_INFINITY:t,function(i){return i.lift(new c(e,t,r))}}var c=function(){function e(e,t,r){this.project=e,this.concurrent=t,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new h(e,this.project,this.concurrent,this.scheduler))},e}();exports.ExpandOperator=c;var h=function(e){function s(t,r,i,s){var o=e.call(this,t)||this;return o.project=r,o.concurrent=i,o.scheduler=s,o.index=0,o.active=0,o.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return t.__extends(s,e),s.dispatch=function(e){var t=e.subscriber,r=e.result,i=e.value,s=e.index;t.subscribeToProjection(r,i,s)},s.prototype._next=function(e){var t=this.destination;if(t.closed)this._complete();else{var o=this.index++;if(this.active<this.concurrent){t.next(e);var n=(0,r.tryCatch)(this.project)(e,o);if(n===i.errorObject)t.error(i.errorObject.e);else if(this.scheduler){var u={subscriber:this,result:n,value:e,index:o};this.add(this.scheduler.schedule(s.dispatch,0,u))}else this.subscribeToProjection(n,e,o)}else this.buffer.push(e)}},s.prototype.subscribeToProjection=function(e,t,r){this.active++,this.add((0,o.subscribeToResult)(this,e,t,r))},s.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete()},s.prototype.notifyNext=function(e,t,r,i,s){this._next(t)},s.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},s}(s.OuterSubscriber);exports.ExpandSubscriber=h;
},{"tslib":"7aRT","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"pwt7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.finalize=u;var r=require("tslib"),e=i(r),t=require("../Subscriber"),n=require("../Subscription");function i(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function u(r){return function(e){return e.lift(new c(r))}}var c=function(){function r(r){this.callback=r}return r.prototype.call=function(r,e){return e.subscribe(new o(r,this.callback))},r}(),o=function(r){function t(e,t){var i=r.call(this,e)||this;return i.add(new n.Subscription(t)),i}return e.__extends(t,r),t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Subscription":"mK8y"}],"NLOD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FindValueSubscriber=exports.FindValueOperator=void 0,exports.find=n;var t=require("tslib"),e=r(t),i=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(i){return i.lift(new o(t,i,!1,e))}}var o=function(){function t(t,e,i,r){this.predicate=t,this.source=e,this.yieldIndex=i,this.thisArg=r}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}();exports.FindValueOperator=o;var s=function(t){function i(e,i,r,n,o){var s=t.call(this,e)||this;return s.predicate=i,s.source=r,s.yieldIndex=n,s.thisArg=o,s.index=0,s}return e.__extends(i,t),i.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},i.prototype._next=function(t){var e=this.predicate,i=this.thisArg,r=this.index++;try{e.call(i||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(t){this.destination.error(t)}},i.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},i}(i.Subscriber);exports.FindValueSubscriber=s;
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"BFxX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.findIndex=r;var e=require("../operators/find");function r(r,t){return function(n){return n.lift(new e.FindValueOperator(r,n,!0,t))}}
},{"../operators/find":"NLOD"}],"/Qph":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.first=f;var r=require("../util/EmptyError"),e=require("./filter"),t=require("./take"),i=require("./defaultIfEmpty"),u=require("./throwIfEmpty"),n=require("../util/identity");function f(f,o){var p=arguments.length>=2;return function(l){return l.pipe(f?(0,e.filter)(function(r,e){return f(r,e,l)}):n.identity,(0,t.take)(1),p?(0,i.defaultIfEmpty)(o):(0,u.throwIfEmpty)(function(){return new r.EmptyError}))}}
},{"../util/EmptyError":"MbJR","./filter":"2Z4q","./take":"95nX","./defaultIfEmpty":"WMek","./throwIfEmpty":"hlGy","../util/identity":"Xo/Y"}],"zoju":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ignoreElements=u;var e=require("tslib"),r=n(e),t=require("../Subscriber");function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function u(){return function(e){return e.lift(new i)}}var i=function(){function e(){}return e.prototype.call=function(e,r){return r.subscribe(new o(e))},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._next=function(e){},t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"9kLc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEmpty=o;var t=require("tslib"),e=r(t),n=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(){return function(t){return t.lift(new i)}}var i=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new u(t))},t}(),u=function(t){function n(e){return t.call(this,e)||this}return e.__extends(n,t),n.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},n.prototype._next=function(t){this.notifyComplete(!1)},n.prototype._complete=function(){this.notifyComplete(!0)},n}(n.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"dknK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeLast=u;var t=require("tslib"),r=o(t),e=require("../Subscriber"),n=require("../util/ArgumentOutOfRangeError"),i=require("../observable/empty");function o(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r}function u(t){return function(r){return 0===t?(0,i.empty)():r.lift(new s(t))}}var s=function(){function t(t){if(this.total=t,this.total<0)throw new n.ArgumentOutOfRangeError}return t.prototype.call=function(t,r){return r.subscribe(new a(t,this.total))},t}(),a=function(t){function e(r,e){var n=t.call(this,r)||this;return n.total=e,n.ring=new Array,n.count=0,n}return r.__extends(e,t),e.prototype._next=function(t){var r=this.ring,e=this.total,n=this.count++;r.length<e?r.push(t):r[n%e]=t},e.prototype._complete=function(){var t=this.destination,r=this.count;if(r>0)for(var e=this.count>=this.total?this.total:this.count,n=this.ring,i=0;i<e;i++){var o=r++%e;t.next(n[o])}t.complete()},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/ArgumentOutOfRangeError":"p9/g","../observable/empty":"5BP8"}],"PDCV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.last=f;var t=require("../util/EmptyError"),e=require("./filter"),r=require("./takeLast"),i=require("./throwIfEmpty"),u=require("./defaultIfEmpty"),n=require("../util/identity");function f(f,o){var p=arguments.length>=2;return function(a){return a.pipe(f?(0,e.filter)(function(t,e){return f(t,e,a)}):n.identity,(0,r.takeLast)(1),p?(0,u.defaultIfEmpty)(o):(0,i.throwIfEmpty)(function(){return new t.EmptyError}))}}
},{"../util/EmptyError":"MbJR","./filter":"2Z4q","./takeLast":"dknK","./throwIfEmpty":"hlGy","./defaultIfEmpty":"WMek","../util/identity":"Xo/Y"}],"ehRT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mapTo=u;var t=require("tslib"),e=n(t),r=require("../Subscriber");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t){return function(e){return e.lift(new i(t))}}var i=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.value))},t}(),o=function(t){function r(e,r){var n=t.call(this,e)||this;return n.value=r,n}return e.__extends(r,t),r.prototype._next=function(t){this.destination.next(this.value)},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"Kvui":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.materialize=o;var t=require("tslib"),e=i(t),r=require("../Subscriber"),n=require("../Notification");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function o(){return function(t){return t.lift(new u)}}var u=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new c(t))},t}(),c=function(t){function r(e){return t.call(this,e)||this}return e.__extends(r,t),r.prototype._next=function(t){this.destination.next(n.Notification.createNext(t))},r.prototype._error=function(t){var e=this.destination;e.next(n.Notification.createError(t)),e.complete()},r.prototype._complete=function(){var t=this.destination;t.next(n.Notification.createComplete()),t.complete()},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Notification":"CJua"}],"0jsb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scan=n;var e=require("tslib"),t=i(e),r=require("../Subscriber");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e,t){var r=!1;return arguments.length>=2&&(r=!0),function(i){return i.lift(new s(e,t,r))}}var s=function(){function e(e,t,r){void 0===r&&(r=!1),this.accumulator=e,this.seed=t,this.hasSeed=r}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.accumulator,this.seed,this.hasSeed))},e}(),u=function(e){function r(t,r,i,n){var s=e.call(this,t)||this;return s.accumulator=r,s._seed=i,s.hasSeed=n,s.index=0,s}return t.__extends(r,e),Object.defineProperty(r.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),r.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},r.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.accumulator(this.seed,e,r)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"mqtm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.reduce=n;var e=require("./scan"),t=require("./takeLast"),r=require("./defaultIfEmpty"),u=require("../util/pipe");function n(n,i){return arguments.length>=2?function(a){return(0,u.pipe)((0,e.scan)(n,i),(0,t.takeLast)(1),(0,r.defaultIfEmpty)(i))(a)}:function(r){return(0,u.pipe)((0,e.scan)(function(e,t,r){return n(e,t,r+1)}),(0,t.takeLast)(1))(r)}}
},{"./scan":"0jsb","./takeLast":"dknK","./defaultIfEmpty":"WMek","../util/pipe":"RCIL"}],"S5cs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.max=r;var e=require("./reduce");function r(r){var t="function"==typeof r?function(e,t){return r(e,t)>0?e:t}:function(e,r){return e>r?e:r};return(0,e.reduce)(t)}
},{"./reduce":"mqtm"}],"Uip8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=r;var e=require("../observable/merge");function r(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(t){return t.lift.call(e.merge.apply(void 0,[t].concat(r)))}}
},{"../observable/merge":"sLBY"}],"VclZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeMapTo=r;var e=require("./mergeMap");function r(r,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?(0,e.mergeMap)(function(){return r},t,n):("number"==typeof t&&(n=t),(0,e.mergeMap)(function(){return r},n))}
},{"./mergeMap":"I5oK"}],"NHaR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MergeScanSubscriber=exports.MergeScanOperator=void 0,exports.mergeScan=c;var t=require("tslib"),e=o(t),r=require("../util/tryCatch"),i=require("../util/errorObject"),s=require("../util/subscribeToResult"),n=require("../OuterSubscriber");function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function c(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),function(i){return i.lift(new u(t,e,r))}}var u=function(){function t(t,e,r){this.accumulator=t,this.seed=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.accumulator,this.seed,this.concurrent))},t}();exports.MergeScanOperator=u;var a=function(t){function n(e,r,i,s){var n=t.call(this,e)||this;return n.accumulator=r,n.acc=i,n.concurrent=s,n.hasValue=!1,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return e.__extends(n,t),n.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,s=(0,r.tryCatch)(this.accumulator)(this.acc,t),n=this.destination;s===i.errorObject?n.error(i.errorObject.e):(this.active++,this._innerSub(s,t,e))}else this.buffer.push(t)},n.prototype._innerSub=function(t,e,r){this.add((0,s.subscribeToResult)(this,t,e,r))},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},n.prototype.notifyNext=function(t,e,r,i,s){var n=this.destination;this.acc=e,this.hasValue=!0,n.next(e)},n.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},n}(n.OuterSubscriber);exports.MergeScanSubscriber=a;
},{"tslib":"7aRT","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../util/subscribeToResult":"9sHU","../OuterSubscriber":"87n1"}],"kHGi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.min=r;var e=require("./reduce");function r(r){var t="function"==typeof r?function(e,t){return r(e,t)<0?e:t}:function(e,r){return e<r?e:r};return(0,e.reduce)(t)}
},{"./reduce":"mqtm"}],"/d/y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MulticastOperator=void 0,exports.multicast=e;var t=require("../observable/ConnectableObservable");function e(e,c){return function(o){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof c)return o.lift(new r(n,c));var s=Object.create(o,t.connectableObservableDescriptor);return s.source=o,s.subjectFactory=n,s}}var r=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,c=this.subjectFactory(),o=r(c).subscribe(t);return o.add(e.subscribe(c)),o},t}();exports.MulticastOperator=r;
},{"../observable/ConnectableObservable":"GCtA"}],"BKBC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onErrorResumeNext=s,exports.onErrorResumeNextStatic=c;var e=require("tslib"),r=u(e),t=require("../observable/from"),o=require("../util/isArray"),i=require("../OuterSubscriber"),n=require("../util/subscribeToResult");function u(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function s(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&(0,o.isArray)(e[0])&&(e=e[0]),function(r){return r.lift(new f(e))}}function c(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i;return 1===e.length&&(0,o.isArray)(e[0])&&(e=e[0]),i=e.shift(),(0,t.from)(i,null).lift(new f(e))}var f=function(){function e(e){this.nextSources=e}return e.prototype.call=function(e,r){return r.subscribe(new l(e,this.nextSources))},e}(),l=function(e){function t(r,t){var o=e.call(this,r)||this;return o.destination=r,o.nextSources=t,o}return r.__extends(t,e),t.prototype.notifyError=function(e,r){this.subscribeToNextSource()},t.prototype.notifyComplete=function(e){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource()},t.prototype._complete=function(){this.subscribeToNextSource()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();e?this.add((0,n.subscribeToResult)(this,e)):this.destination.complete()},t}(i.OuterSubscriber);
},{"tslib":"7aRT","../observable/from":"LnUO","../util/isArray":"xunG","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"NKJ0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pairwise=i;var r=require("tslib"),e=n(r),t=require("../Subscriber");function n(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function i(){return function(r){return r.lift(new u)}}var u=function(){function r(){}return r.prototype.call=function(r,e){return e.subscribe(new s(r))},r}(),s=function(r){function t(e){var t=r.call(this,e)||this;return t.hasPrev=!1,t}return e.__extends(t,r),t.prototype._next=function(r){this.hasPrev?this.destination.next([this.prev,r]):this.hasPrev=!0,this.prev=r},t}(t.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"S2Tg":[function(require,module,exports) {
"use strict";function e(e,r){function t(){return!t.pred.apply(t.thisArg,arguments)}return t.pred=e,t.thisArg=r,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.not=e;
},{}],"Bl4q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.partition=t;var e=require("../util/not"),r=require("./filter");function t(t,i){return function(n){return[(0,r.filter)(t,i)(n),(0,r.filter)((0,e.not)(t,i))(n)]}}
},{"../util/not":"S2Tg","./filter":"2Z4q"}],"4H+/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pluck=e;var r=require("./map");function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=e.length;if(0===o)throw new Error("list of properties cannot be empty.");return function(n){return(0,r.map)(t(e,o))(n)}}function t(r,e){return function(t){for(var n=t,o=0;o<e;o++){var u=n[r[o]];if(void 0===u)return;n=u}return n}}
},{"./map":"aORC"}],"+zvS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publish=u;var e=require("../Subject"),t=require("./multicast");function u(u){return u?(0,t.multicast)(function(){return new e.Subject},u):(0,t.multicast)(new e.Subject)}
},{"../Subject":"NfWW","./multicast":"/d/y"}],"J8x9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishBehavior=t;var e=require("../BehaviorSubject"),r=require("./multicast");function t(t){return function(u){return(0,r.multicast)(new e.BehaviorSubject(t))(u)}}
},{"../BehaviorSubject":"VGg9","./multicast":"/d/y"}],"TvgQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishLast=r;var e=require("../AsyncSubject"),t=require("./multicast");function r(){return function(r){return(0,t.multicast)(new e.AsyncSubject)(r)}}
},{"../AsyncSubject":"Yp3O","./multicast":"/d/y"}],"TS2w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishReplay=u;var e=require("../ReplaySubject"),t=require("./multicast");function u(u,r,n,i){n&&"function"!=typeof n&&(i=n);var o="function"==typeof n?n:void 0,c=new e.ReplaySubject(u,r,i);return function(e){return(0,t.multicast)(function(){return c},o)(e)}}
},{"../ReplaySubject":"PGZW","./multicast":"/d/y"}],"TTEx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.race=t;var r=require("../util/isArray"),e=require("../observable/race");function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return function(a){return 1===t.length&&(0,r.isArray)(t[0])&&(t=t[0]),a.lift.call(e.race.apply(void 0,[a].concat(t)))}}
},{"../util/isArray":"xunG","../observable/race":"0Naf"}],"ZkdK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.repeat=i;var t=require("tslib"),e=u(t),r=require("../Subscriber"),n=require("../observable/empty");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return void 0===t&&(t=-1),function(e){return 0===t?(0,n.empty)():t<0?e.lift(new o(-1,e)):e.lift(new o(t-1,e))}}var o=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.count,this.source))},t}(),s=function(t){function r(e,r,n){var u=t.call(this,e)||this;return u.count=r,u.source=n,u}return e.__extends(r,t),r.prototype.complete=function(){if(!this.isStopped){var e=this.source,r=this.count;if(0===r)return t.prototype.complete.call(this);r>-1&&(this.count=r-1),e.subscribe(this._unsubscribeAndRecycle())}},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../observable/empty":"5BP8"}],"uyiE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.repeatWhen=c;var t=require("tslib"),e=o(t),i=require("../Subject"),r=require("../util/tryCatch"),s=require("../util/errorObject"),u=require("../OuterSubscriber"),n=require("../util/subscribeToResult");function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function c(t){return function(e){return e.lift(new b(t))}}var b=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.notifier,e))},t}(),l=function(t){function u(e,i,r){var s=t.call(this,e)||this;return s.notifier=i,s.source=r,s.sourceIsBeingSubscribedTo=!0,s}return e.__extends(u,t),u.prototype.notifyNext=function(t,e,i,r,s){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},u.prototype.notifyComplete=function(e){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},u.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},u.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},u.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},u.prototype.subscribeToRetries=function(){this.notifications=new i.Subject;var e=(0,r.tryCatch)(this.notifier)(this.notifications);if(e===s.errorObject)return t.prototype.complete.call(this);this.retries=e,this.retriesSubscription=(0,n.subscribeToResult)(this,e)},u}(u.OuterSubscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"IhyQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.retry=u;var r=require("tslib"),t=n(r),e=require("../Subscriber");function n(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.default=r,t}function u(r){return void 0===r&&(r=-1),function(t){return t.lift(new i(r,t))}}var i=function(){function r(r,t){this.count=r,this.source=t}return r.prototype.call=function(r,t){return t.subscribe(new o(r,this.count,this.source))},r}(),o=function(r){function e(t,e,n){var u=r.call(this,t)||this;return u.count=e,u.source=n,u}return t.__extends(e,r),e.prototype.error=function(t){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return r.prototype.error.call(this,t);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"RMyk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.retryWhen=c;var r=require("tslib"),e=o(r),t=require("../Subject"),i=require("../util/tryCatch"),s=require("../util/errorObject"),u=require("../OuterSubscriber"),n=require("../util/subscribeToResult");function o(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function c(r){return function(e){return e.lift(new b(r,e))}}var b=function(){function r(r,e){this.notifier=r,this.source=e}return r.prototype.call=function(r,e){return e.subscribe(new l(r,this.notifier,this.source))},r}(),l=function(r){function u(e,t,i){var s=r.call(this,e)||this;return s.notifier=t,s.source=i,s}return e.__extends(u,r),u.prototype.error=function(e){if(!this.isStopped){var u=this.errors,o=this.retries,c=this.retriesSubscription;if(o)this.errors=null,this.retriesSubscription=null;else{if(u=new t.Subject,(o=(0,i.tryCatch)(this.notifier)(u))===s.errorObject)return r.prototype.error.call(this,s.errorObject.e);c=(0,n.subscribeToResult)(this,o)}this._unsubscribeAndRecycle(),this.errors=u,this.retries=o,this.retriesSubscription=c,u.next(e)}},u.prototype._unsubscribe=function(){var r=this.errors,e=this.retriesSubscription;r&&(r.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},u.prototype.notifyNext=function(r,e,t,i,s){var u=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=u,this.source.subscribe(this)},u}(u.OuterSubscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"m7Y6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sample=n;var t=require("tslib"),e=u(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function n(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new s(t),u=e.subscribe(r);return u.add((0,i.subscribeToResult)(r,this.notifier)),u},t}(),s=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return e.__extends(r,t),r.prototype._next=function(t){this.value=t,this.hasValue=!0},r.prototype.notifyNext=function(t,e,r,i,u){this.emitValue()},r.prototype.notifyComplete=function(){this.emitValue()},r.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"yyRa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sampleTime=n;var e=require("tslib"),t=s(e),r=require("../Subscriber"),i=require("../scheduler/async");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function n(e,t){return void 0===t&&(t=i.async),function(r){return r.lift(new u(e,t))}}var u=function(){function e(e,t){this.period=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.period,this.scheduler))},e}(),o=function(e){function r(t,r,i){var s=e.call(this,t)||this;return s.period=r,s.scheduler=i,s.hasValue=!1,s.add(i.schedule(c,r,{subscriber:s,period:r})),s}return t.__extends(r,e),r.prototype._next=function(e){this.lastValue=e,this.hasValue=!0},r.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},r}(r.Subscriber);function c(e){var t=e.subscriber,r=e.period;t.notifyNext(),this.schedule(e,r)}
},{"tslib":"7aRT","../Subscriber":"Qs1E","../scheduler/async":"FFCS"}],"mAyD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SequenceEqualSubscriber=exports.SequenceEqualOperator=void 0,exports.sequenceEqual=s;var t=require("tslib"),e=i(t),r=require("../Subscriber"),o=require("../util/tryCatch"),n=require("../util/errorObject");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function s(t,e){return function(r){return r.lift(new u(t,e))}}var u=function(){function t(t,e){this.compareTo=t,this.comparor=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.compareTo,this.comparor))},t}();exports.SequenceEqualOperator=u;var c=function(t){function r(e,r,o){var n=t.call(this,e)||this;return n.compareTo=r,n.comparor=o,n._a=[],n._b=[],n._oneComplete=!1,n.add(r.subscribe(new p(e,n))),n}return e.__extends(r,t),r.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},r.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},r.prototype.checkValues=function(){for(var t=this._a,e=this._b,r=this.comparor;t.length>0&&e.length>0;){var i=t.shift(),s=e.shift(),u=!1;r?(u=(0,o.tryCatch)(r)(i,s))===n.errorObject&&this.destination.error(n.errorObject.e):u=i===s,u||this.emit(!1)}},r.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},r.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},r}(r.Subscriber);exports.SequenceEqualSubscriber=c;var p=function(t){function r(e,r){var o=t.call(this,e)||this;return o.parent=r,o}return e.__extends(r,t),r.prototype._next=function(t){this.parent.nextB(t)},r.prototype._error=function(t){this.parent.error(t)},r.prototype._complete=function(){this.parent._complete()},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/tryCatch":"BwKY","../util/errorObject":"IhTn"}],"lhL3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.share=n;var e=require("./multicast"),r=require("./refCount"),t=require("../Subject");function u(){return new t.Subject}function n(){return function(t){return(0,r.refCount)()((0,e.multicast)(u)(t))}}
},{"./multicast":"/d/y","./refCount":"bnAO","../Subject":"NfWW"}],"oi1F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shareReplay=r;var e=require("../ReplaySubject");function r(e,r,t){return function(u){return u.lift(n(e,r,t))}}function n(r,n,t){var u,c,i=0,o=!1,s=!1;return function(b){i++,u&&!o||(o=!1,u=new e.ReplaySubject(r,n,t),c=b.subscribe({next:function(e){u.next(e)},error:function(e){o=!0,u.error(e)},complete:function(){s=!0,u.complete()}}));var f=u.subscribe(this);return function(){i--,f.unsubscribe(),c&&0===i&&s&&c.unsubscribe()}}}
},{"../ReplaySubject":"PGZW"}],"Z6I5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.single=s;var e=require("tslib"),t=n(e),r=require("../Subscriber"),i=require("../util/EmptyError");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function s(e){return function(t){return t.lift(new o(e,t))}}var o=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.predicate,this.source))},e}(),u=function(e){function r(t,r,i){var n=e.call(this,t)||this;return n.predicate=r,n.source=i,n.seenValue=!1,n.index=0,n}return t.__extends(r,e),r.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)},r.prototype._next=function(e){var t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)},r.prototype.tryNext=function(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(e){this.destination.error(e)}},r.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new i.EmptyError)},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/EmptyError":"MbJR"}],"SA33":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skip=i;var t=require("tslib"),r=n(t),e=require("../Subscriber");function n(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r.default=t,r}function i(t){return function(r){return r.lift(new u(t))}}var u=function(){function t(t){this.total=t}return t.prototype.call=function(t,r){return r.subscribe(new o(t,this.total))},t}(),o=function(t){function e(r,e){var n=t.call(this,r)||this;return n.total=e,n.count=0,n}return r.__extends(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"U3UT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipLast=u;var t=require("tslib"),r=i(t),n=require("../Subscriber"),e=require("../util/ArgumentOutOfRangeError");function i(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r.default=t,r}function u(t){return function(r){return r.lift(new s(t))}}var s=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new e.ArgumentOutOfRangeError}return t.prototype.call=function(t,r){return 0===this._skipCount?r.subscribe(new n.Subscriber(t)):r.subscribe(new o(t,this._skipCount))},t}(),o=function(t){function n(r,n){var e=t.call(this,r)||this;return e._skipCount=n,e._count=0,e._ring=new Array(n),e}return r.__extends(n,t),n.prototype._next=function(t){var r=this._skipCount,n=this._count++;if(n<r)this._ring[n]=t;else{var e=n%r,i=this._ring,u=i[e];i[e]=t,this.destination.next(u)}},n}(n.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../util/ArgumentOutOfRangeError":"p9/g"}],"FTfF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipUntil=u;var t=require("tslib"),e=n(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.notifier))},t}(),s=function(t){function r(e,r){var n=t.call(this,e)||this;return n.hasValue=!1,n.add(n.innerSubscription=(0,i.subscribeToResult)(n,r)),n}return e.__extends(r,t),r.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},r.prototype.notifyNext=function(t,e,r,i,n){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},r.prototype.notifyComplete=function(){},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"Ppaj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipWhile=n;var t=require("tslib"),e=r(t),i=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t){return function(e){return e.lift(new s(t))}}var s=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.predicate))},t}(),o=function(t){function i(e,i){var r=t.call(this,e)||this;return r.predicate=i,r.skipping=!0,r.index=0,r}return e.__extends(i,t),i.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},i.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},i}(i.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"tqHQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startWith=c;var e=require("../observable/fromArray"),r=require("../observable/scalar"),t=require("../observable/empty"),a=require("../observable/concat"),o=require("../util/isScheduler");function c(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return function(l){var u=c[c.length-1];(0,o.isScheduler)(u)?c.pop():u=null;var n=c.length;return 1!==n||u?n>0?(0,a.concat)((0,e.fromArray)(c,u),l):(0,a.concat)((0,t.empty)(u),l):(0,a.concat)((0,r.scalar)(c[0]),l)}}
},{"../observable/fromArray":"WFxi","../observable/scalar":"q5qz","../observable/empty":"5BP8","../observable/concat":"g+vB","../util/isScheduler":"BtYd"}],"BAEt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubscribeOnObservable=void 0;var e=require("tslib"),r=t(e),s=require("../Observable"),i=require("../scheduler/asap"),u=require("../util/isNumeric");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s]);return r.default=e,r}var c=function(e){function s(r,s,t){void 0===s&&(s=0),void 0===t&&(t=i.asap);var c=e.call(this)||this;return c.source=r,c.delayTime=s,c.scheduler=t,(!(0,u.isNumeric)(s)||s<0)&&(c.delayTime=0),t&&"function"==typeof t.schedule||(c.scheduler=i.asap),c}return r.__extends(s,e),s.create=function(e,r,u){return void 0===r&&(r=0),void 0===u&&(u=i.asap),new s(e,r,u)},s.dispatch=function(e){var r=e.source,s=e.subscriber;return this.add(r.subscribe(s))},s.prototype._subscribe=function(e){var r=this.delayTime,i=this.source;return this.scheduler.schedule(s.dispatch,r,{source:i,subscriber:e})},s}(s.Observable);exports.SubscribeOnObservable=c;
},{"tslib":"7aRT","../Observable":"B88x","../scheduler/asap":"q4Vt","../util/isNumeric":"DEZm"}],"/smR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeOn=r;var e=require("../observable/SubscribeOnObservable");function r(e,r){return void 0===r&&(r=0),function(n){return n.lift(new t(e,r))}}var t=function(){function r(e,r){this.scheduler=e,this.delay=r}return r.prototype.call=function(r,t){return new e.SubscribeOnObservable(t,this.delay,this.scheduler).subscribe(r)},r}();
},{"../observable/SubscribeOnObservable":"BAEt"}],"seWQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchMap=s;var t=require("tslib"),e=u(t),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult"),n=require("./map"),o=require("../observable/from");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function s(t,e){return"function"==typeof e?function(r){return r.pipe(s(function(r,i){return(0,o.from)(t(r,i)).pipe((0,n.map)(function(t,n){return e(r,t,i,n)}))}))}:function(e){return e.lift(new c(t))}}var c=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.project))},t}(),p=function(t){function r(e,r){var i=t.call(this,e)||this;return i.project=r,i.index=0,i}return e.__extends(r,t),r.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},r.prototype._innerSub=function(t,e,r){var n=this.innerSubscription;n&&n.unsubscribe(),this.add(this.innerSubscription=(0,i.subscribeToResult)(this,t,e,r))},r.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this)},r.prototype._unsubscribe=function(){this.innerSubscription=null},r.prototype.notifyComplete=function(e){this.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},r.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU","./map":"aORC","../observable/from":"LnUO"}],"vG3r":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchAll=i;var e=require("./switchMap"),t=require("../util/identity");function i(){return(0,e.switchMap)(t.identity)}
},{"./switchMap":"seWQ","../util/identity":"Xo/Y"}],"pvsX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchMapTo=e;var t=require("./switchMap");function e(e,r){return r?(0,t.switchMap)(function(){return e},r):(0,t.switchMap)(function(){return e})}
},{"./switchMap":"seWQ"}],"hbmf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeUntil=u;var t=require("tslib"),e=i(t),r=require("../OuterSubscriber"),n=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function u(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new s(t),i=(0,n.subscribeToResult)(r,this.notifier);return i&&!i.closed?(r.add(i),e.subscribe(r)):r},t}(),s=function(t){function r(e){return t.call(this,e)||this}return e.__extends(r,t),r.prototype.notifyNext=function(t,e,r,n,i){this.complete()},r.prototype.notifyComplete=function(){},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"9qrb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeWhile=i;var t=require("tslib"),e=n(t),r=require("../Subscriber");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.predicate))},t}(),u=function(t){function r(e,r){var n=t.call(this,e)||this;return n.predicate=r,n.index=0,n}return e.__extends(r,t),r.prototype._next=function(t){var e,r=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void r.error(t)}this.nextOrComplete(t,e)},r.prototype.nextOrComplete=function(t,e){var r=this.destination;Boolean(e)?r.next(t):r.complete()},r}(r.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E"}],"rWZJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultThrottleConfig=void 0,exports.throttle=s;var t=require("tslib"),e=n(t),i=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var o=exports.defaultThrottleConfig={leading:!0,trailing:!1};function s(t,e){return void 0===e&&(e=o),function(i){return i.lift(new l(t,e.leading,e.trailing))}}var l=function(){function t(t,e,i){this.durationSelector=t,this.leading=e,this.trailing=i}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector,this.leading,this.trailing))},t}(),u=function(t){function i(e,i,r,n){var o=t.call(this,e)||this;return o.destination=e,o.durationSelector=i,o._leading=r,o._trailing=n,o._hasValue=!1,o}return e.__extends(i,t),i.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},i.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=null},i.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=(0,r.subscribeToResult)(this,e))},i.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},i.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=null,e&&this.send()},i.prototype.notifyNext=function(t,e,i,r,n){this.throttlingDone()},i.prototype.notifyComplete=function(){this.throttlingDone()},i}(i.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"ANbJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throttleTime=s;var t=require("tslib"),i=l(t),e=require("../Subscriber"),r=require("../scheduler/async"),n=require("./throttle");function l(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e]);return i.default=t,i}function s(t,i,e){return void 0===i&&(i=r.async),void 0===e&&(e=n.defaultThrottleConfig),function(r){return r.lift(new a(t,i,e.leading,e.trailing))}}var a=function(){function t(t,i,e,r){this.duration=t,this.scheduler=i,this.leading=e,this.trailing=r}return t.prototype.call=function(t,i){return i.subscribe(new u(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),u=function(t){function e(i,e,r,n,l){var s=t.call(this,i)||this;return s.duration=e,s.scheduler=r,s.leading=n,s.trailing=l,s._hasTrailingValue=!1,s._trailingValue=null,s}return i.__extends(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(h,this.duration,{subscriber:this})),this.leading&&this.destination.next(t))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(e.Subscriber);function h(t){t.subscriber.clearThrottle()}
},{"tslib":"7aRT","../Subscriber":"Qs1E","../scheduler/async":"FFCS","./throttle":"rWZJ"}],"Rxp8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeInterval=void 0,exports.timeInterval=u;var e=require("../scheduler/async"),r=require("./scan"),n=require("../observable/defer"),t=require("./map");function u(u){return void 0===u&&(u=e.async),function(e){return(0,n.defer)(function(){return e.pipe((0,r.scan)(function(e,r){var n=e.current;return{value:r,current:u.now(),last:n}},{current:u.now(),value:void 0,last:void 0}),(0,t.map)(function(e){var r=e.current,n=e.last,t=e.value;return new i(t,r-n)}))})}}var i=function(){return function(e,r){this.value=e,this.interval=r}}();exports.TimeInterval=i;
},{"../scheduler/async":"FFCS","./scan":"0jsb","../observable/defer":"F9YC","./map":"aORC"}],"u7rK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeoutWith=n;var t=require("tslib"),e=o(t),i=require("../scheduler/async"),r=require("../util/isDate"),s=require("../OuterSubscriber"),u=require("../util/subscribeToResult");function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function n(t,e,s){return void 0===s&&(s=i.async),function(i){var u=(0,r.isDate)(t),o=u?+t-s.now():Math.abs(t);return i.lift(new l(o,u,e,s))}}var l=function(){function t(t,e,i,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=i,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),c=function(t){function i(e,i,r,s,u){var o=t.call(this,e)||this;return o.absoluteTimeout=i,o.waitFor=r,o.withObservable=s,o.scheduler=u,o.action=null,o.scheduleTimeout(),o}return e.__extends(i,t),i.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add((0,u.subscribeToResult)(t,e))},i.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(i.dispatchTimeout,this.waitFor,this))},i.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},i.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},i}(s.OuterSubscriber);
},{"tslib":"7aRT","../scheduler/async":"FFCS","../util/isDate":"Rb1P","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"DLRl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeout=i;var r=require("../scheduler/async"),e=require("../util/TimeoutError"),t=require("./timeoutWith"),o=require("../observable/throwError");function i(i,u){return void 0===u&&(u=r.async),(0,t.timeoutWith)(i,(0,o.throwError)(new e.TimeoutError),u)}
},{"../scheduler/async":"FFCS","../util/TimeoutError":"RGBD","./timeoutWith":"u7rK","../observable/throwError":"BXbb"}],"L75v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timestamp=void 0,exports.timestamp=r;var e=require("../scheduler/async"),t=require("./map");function r(r){return void 0===r&&(r=e.async),(0,t.map)(function(e){return new i(e,r.now())})}var i=function(){return function(e,t){this.value=e,this.timestamp=t}}();exports.Timestamp=i;
},{"../scheduler/async":"FFCS","./map":"aORC"}],"vuVW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toArray=t;var e=require("./reduce");function r(e,r,t){return 0===t?[r]:(e.push(r),e)}function t(){return(0,e.reduce)(r,[])}
},{"./reduce":"mqtm"}],"0OlN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=u;var t=require("tslib"),e=i(t),n=require("../Subject"),o=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function u(t){return function(e){return e.lift(new s(t))}}var s=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var n=new c(t),o=e.subscribe(n);return o.closed||n.add((0,r.subscribeToResult)(n,this.windowBoundaries)),o},t}(),c=function(t){function o(e){var o=t.call(this,e)||this;return o.window=new n.Subject,e.next(o.window),o}return e.__extends(o,t),o.prototype.notifyNext=function(t,e,n,o,r){this.openWindow()},o.prototype.notifyError=function(t,e){this._error(t)},o.prototype.notifyComplete=function(t){this._complete()},o.prototype._next=function(t){this.window.next(t)},o.prototype._error=function(t){this.window.error(t),this.destination.error(t)},o.prototype._complete=function(){this.window.complete(),this.destination.complete()},o.prototype._unsubscribe=function(){this.window=null},o.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,o=this.window=new n.Subject;e.next(o)},o}(o.OuterSubscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"nCAU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowCount=o;var t=require("tslib"),i=r(t),e=require("../Subscriber"),n=require("../Subject");function r(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e]);return i.default=t,i}function o(t,i){return void 0===i&&(i=0),function(e){return e.lift(new s(t,i))}}var s=function(){function t(t,i){this.windowSize=t,this.startWindowEvery=i}return t.prototype.call=function(t,i){return i.subscribe(new u(t,this.windowSize,this.startWindowEvery))},t}(),u=function(t){function e(i,e,r){var o=t.call(this,i)||this;return o.destination=i,o.windowSize=e,o.startWindowEvery=r,o.windows=[new n.Subject],o.count=0,i.next(o.windows[0]),o}return i.__extends(e,t),e.prototype._next=function(t){for(var i=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,e=this.destination,r=this.windowSize,o=this.windows,s=o.length,u=0;u<s&&!this.closed;u++)o[u].next(t);var c=this.count-r+1;if(c>=0&&c%i==0&&!this.closed&&o.shift().complete(),++this.count%i==0&&!this.closed){var w=new n.Subject;o.push(w),e.next(w)}},e.prototype._error=function(t){var i=this.windows;if(i)for(;i.length>0&&!this.closed;)i.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(e.Subscriber);
},{"tslib":"7aRT","../Subscriber":"Qs1E","../Subject":"NfWW"}],"19p4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowTime=c;var e=require("tslib"),i=u(e),n=require("../Subject"),t=require("../scheduler/async"),r=require("../Subscriber"),o=require("../util/isNumeric"),s=require("../util/isScheduler");function u(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i.default=e,i}function c(e){var i=t.async,n=null,r=Number.POSITIVE_INFINITY;return(0,s.isScheduler)(arguments[3])&&(i=arguments[3]),(0,s.isScheduler)(arguments[2])?i=arguments[2]:(0,o.isNumeric)(arguments[2])&&(r=arguments[2]),(0,s.isScheduler)(arguments[1])?i=arguments[1]:(0,o.isNumeric)(arguments[1])&&(n=arguments[1]),function(t){return t.lift(new d(e,n,r,i))}}var d=function(){function e(e,i,n,t){this.windowTimeSpan=e,this.windowCreationInterval=i,this.maxWindowSize=n,this.scheduler=t}return e.prototype.call=function(e,i){return i.subscribe(new a(e,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},e}(),l=function(e){function n(){var i=null!==e&&e.apply(this,arguments)||this;return i._numberOfNextedValues=0,i}return i.__extends(n,e),n.prototype.next=function(i){this._numberOfNextedValues++,e.prototype.next.call(this,i)},Object.defineProperty(n.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),n}(n.Subject),a=function(e){function n(i,n,t,r,o){var s=e.call(this,i)||this;s.destination=i,s.windowTimeSpan=n,s.windowCreationInterval=t,s.maxWindowSize=r,s.scheduler=o,s.windows=[];var u=s.openWindow();if(null!==t&&t>=0){var c={subscriber:s,window:u,context:null},d={windowTimeSpan:n,windowCreationInterval:t,subscriber:s,scheduler:o};s.add(o.schedule(p,n,c)),s.add(o.schedule(h,t,d))}else{var l={subscriber:s,window:u,windowTimeSpan:n};s.add(o.schedule(w,n,l))}return s}return i.__extends(n,e),n.prototype._next=function(e){for(var i=this.windows,n=i.length,t=0;t<n;t++){var r=i[t];r.closed||(r.next(e),r.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(r))}},n.prototype._error=function(e){for(var i=this.windows;i.length>0;)i.shift().error(e);this.destination.error(e)},n.prototype._complete=function(){for(var e=this.windows;e.length>0;){var i=e.shift();i.closed||i.complete()}this.destination.complete()},n.prototype.openWindow=function(){var e=new l;return this.windows.push(e),this.destination.next(e),e},n.prototype.closeWindow=function(e){e.complete();var i=this.windows;i.splice(i.indexOf(e),1)},n}(r.Subscriber);function w(e){var i=e.subscriber,n=e.windowTimeSpan,t=e.window;t&&i.closeWindow(t),e.window=i.openWindow(),this.schedule(e,n)}function h(e){var i=e.windowTimeSpan,n=e.subscriber,t=e.scheduler,r=e.windowCreationInterval,o=n.openWindow(),s={action:this,subscription:null},u={subscriber:n,window:o,context:s};s.subscription=t.schedule(p,i,u),this.add(s.subscription),this.schedule(e,r)}function p(e){var i=e.subscriber,n=e.window,t=e.context;t&&t.action&&t.subscription&&t.action.remove(t.subscription),i.closeWindow(n)}
},{"tslib":"7aRT","../Subject":"NfWW","../scheduler/async":"FFCS","../Subscriber":"Qs1E","../util/isNumeric":"DEZm","../util/isScheduler":"BtYd"}],"5PR9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowToggle=l;var t=require("tslib"),e=u(t),r=require("../Subject"),i=require("../Subscription"),o=require("../util/tryCatch"),n=require("../util/errorObject"),s=require("../OuterSubscriber"),c=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function l(t,e){return function(r){return r.lift(new p(t,e))}}var p=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new b(t,this.openings,this.closingSelector))},t}(),b=function(t){function s(e,r,i){var o=t.call(this,e)||this;return o.openings=r,o.closingSelector=i,o.contexts=[],o.add(o.openSubscription=(0,c.subscribeToResult)(o,r,r)),o}return e.__extends(s,t),s.prototype._next=function(t){var e=this.contexts;if(e)for(var r=e.length,i=0;i<r;i++)e[i].window.next(t)},s.prototype._error=function(e){var r=this.contexts;if(this.contexts=null,r)for(var i=r.length,o=-1;++o<i;){var n=r[o];n.window.error(e),n.subscription.unsubscribe()}t.prototype._error.call(this,e)},s.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var r=e.length,i=-1;++i<r;){var o=e[i];o.window.complete(),o.subscription.unsubscribe()}t.prototype._complete.call(this)},s.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,r=-1;++r<e;){var i=t[r];i.window.unsubscribe(),i.subscription.unsubscribe()}},s.prototype.notifyNext=function(t,e,s,u,l){if(t===this.openings){var p=this.closingSelector,b=(0,o.tryCatch)(p)(e);if(b===n.errorObject)return this.error(n.errorObject.e);var h=new r.Subject,f=new i.Subscription,a={window:h,subscription:f};this.contexts.push(a);var d=(0,c.subscribeToResult)(this,b,a);d.closed?this.closeWindow(this.contexts.length-1):(d.context=a,f.add(d)),this.destination.next(h)}else this.closeWindow(this.contexts.indexOf(t))},s.prototype.notifyError=function(t){this.error(t)},s.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},s.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,r=e[t],i=r.window,o=r.subscription;e.splice(t,1),i.complete(),o.unsubscribe()}},s}(s.OuterSubscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../Subscription":"mK8y","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"2v1T":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowWhen=c;var t=require("tslib"),i=u(t),e=require("../Subject"),o=require("../util/tryCatch"),r=require("../util/errorObject"),n=require("../OuterSubscriber"),s=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e]);return i.default=t,i}function c(t){return function(i){return i.lift(new l(t))}}var l=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,i){return i.subscribe(new p(t,this.closingSelector))},t}(),p=function(t){function n(i,e){var o=t.call(this,i)||this;return o.destination=i,o.closingSelector=e,o.openWindow(),o}return i.__extends(n,t),n.prototype.notifyNext=function(t,i,e,o,r){this.openWindow(r)},n.prototype.notifyError=function(t,i){this._error(t)},n.prototype.notifyComplete=function(t){this.openWindow(t)},n.prototype._next=function(t){this.window.next(t)},n.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},n.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},n.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},n.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var i=this.window;i&&i.complete();var n=this.window=new e.Subject;this.destination.next(n);var u=(0,o.tryCatch)(this.closingSelector)();if(u===r.errorObject){var c=r.errorObject.e;this.destination.error(c),this.window.error(c)}else this.add(this.closingNotification=(0,s.subscribeToResult)(this,u))},n}(n.OuterSubscriber);
},{"tslib":"7aRT","../Subject":"NfWW","../util/tryCatch":"BwKY","../util/errorObject":"IhTn","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"6uQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withLatestFrom=i;var t=require("tslib"),e=n(t),r=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r;"function"==typeof t[t.length-1]&&(r=t.pop());var o=t;return e.lift(new s(o,r))}}var s=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.observables,this.project))},t}(),u=function(t){function r(e,r,n){var i=t.call(this,e)||this;i.observables=r,i.project=n,i.toRespond=[];var s=r.length;i.values=new Array(s);for(var u=0;u<s;u++)i.toRespond.push(u);for(u=0;u<s;u++){var a=r[u];i.add((0,o.subscribeToResult)(i,a,a,u))}return i}return e.__extends(r,t),r.prototype.notifyNext=function(t,e,r,o,n){this.values[r]=e;var i=this.toRespond;if(i.length>0){var s=i.indexOf(r);-1!==s&&i.splice(s,1)}},r.prototype.notifyComplete=function(){},r.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},r.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(r.OuterSubscriber);
},{"tslib":"7aRT","../OuterSubscriber":"87n1","../util/subscribeToResult":"9sHU"}],"eu+D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zip=r;var e=require("../observable/zip");function r(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(t){return t.lift.call(e.zip.apply(void 0,[t].concat(r)))}}
},{"../observable/zip":"12fO"}],"pvkO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zipAll=r;var e=require("../observable/zip");function r(r){return function(t){return t.lift(new e.ZipOperator(r))}}
},{"../observable/zip":"12fO"}],"xm9t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../internal/operators/audit");Object.defineProperty(exports,"audit",{enumerable:!0,get:function(){return e.audit}});var r=require("../internal/operators/auditTime");Object.defineProperty(exports,"auditTime",{enumerable:!0,get:function(){return r.auditTime}});var t=require("../internal/operators/buffer");Object.defineProperty(exports,"buffer",{enumerable:!0,get:function(){return t.buffer}});var n=require("../internal/operators/bufferCount");Object.defineProperty(exports,"bufferCount",{enumerable:!0,get:function(){return n.bufferCount}});var o=require("../internal/operators/bufferTime");Object.defineProperty(exports,"bufferTime",{enumerable:!0,get:function(){return o.bufferTime}});var i=require("../internal/operators/bufferToggle");Object.defineProperty(exports,"bufferToggle",{enumerable:!0,get:function(){return i.bufferToggle}});var a=require("../internal/operators/bufferWhen");Object.defineProperty(exports,"bufferWhen",{enumerable:!0,get:function(){return a.bufferWhen}});var u=require("../internal/operators/catchError");Object.defineProperty(exports,"catchError",{enumerable:!0,get:function(){return u.catchError}});var p=require("../internal/operators/combineAll");Object.defineProperty(exports,"combineAll",{enumerable:!0,get:function(){return p.combineAll}});var l=require("../internal/operators/combineLatest");Object.defineProperty(exports,"combineLatest",{enumerable:!0,get:function(){return l.combineLatest}});var s=require("../internal/operators/concat");Object.defineProperty(exports,"concat",{enumerable:!0,get:function(){return s.concat}});var c=require("../internal/operators/concatAll");Object.defineProperty(exports,"concatAll",{enumerable:!0,get:function(){return c.concatAll}});var f=require("../internal/operators/concatMap");Object.defineProperty(exports,"concatMap",{enumerable:!0,get:function(){return f.concatMap}});var b=require("../internal/operators/concatMapTo");Object.defineProperty(exports,"concatMapTo",{enumerable:!0,get:function(){return b.concatMapTo}});var m=require("../internal/operators/count");Object.defineProperty(exports,"count",{enumerable:!0,get:function(){return m.count}});var d=require("../internal/operators/debounce");Object.defineProperty(exports,"debounce",{enumerable:!0,get:function(){return d.debounce}});var g=require("../internal/operators/debounceTime");Object.defineProperty(exports,"debounceTime",{enumerable:!0,get:function(){return g.debounceTime}});var y=require("../internal/operators/defaultIfEmpty");Object.defineProperty(exports,"defaultIfEmpty",{enumerable:!0,get:function(){return y.defaultIfEmpty}});var x=require("../internal/operators/delay");Object.defineProperty(exports,"delay",{enumerable:!0,get:function(){return x.delay}});var v=require("../internal/operators/delayWhen");Object.defineProperty(exports,"delayWhen",{enumerable:!0,get:function(){return v.delayWhen}});var O=require("../internal/operators/dematerialize");Object.defineProperty(exports,"dematerialize",{enumerable:!0,get:function(){return O.dematerialize}});var q=require("../internal/operators/distinct");Object.defineProperty(exports,"distinct",{enumerable:!0,get:function(){return q.distinct}});var j=require("../internal/operators/distinctUntilChanged");Object.defineProperty(exports,"distinctUntilChanged",{enumerable:!0,get:function(){return j.distinctUntilChanged}});var P=require("../internal/operators/distinctUntilKeyChanged");Object.defineProperty(exports,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return P.distinctUntilKeyChanged}});var h=require("../internal/operators/elementAt");Object.defineProperty(exports,"elementAt",{enumerable:!0,get:function(){return h.elementAt}});var w=require("../internal/operators/endWith");Object.defineProperty(exports,"endWith",{enumerable:!0,get:function(){return w.endWith}});var T=require("../internal/operators/every");Object.defineProperty(exports,"every",{enumerable:!0,get:function(){return T.every}});var W=require("../internal/operators/exhaust");Object.defineProperty(exports,"exhaust",{enumerable:!0,get:function(){return W.exhaust}});var k=require("../internal/operators/exhaustMap");Object.defineProperty(exports,"exhaustMap",{enumerable:!0,get:function(){return k.exhaustMap}});var M=require("../internal/operators/expand");Object.defineProperty(exports,"expand",{enumerable:!0,get:function(){return M.expand}});var A=require("../internal/operators/filter");Object.defineProperty(exports,"filter",{enumerable:!0,get:function(){return A.filter}});var E=require("../internal/operators/finalize");Object.defineProperty(exports,"finalize",{enumerable:!0,get:function(){return E.finalize}});var z=require("../internal/operators/find");Object.defineProperty(exports,"find",{enumerable:!0,get:function(){return z.find}});var C=require("../internal/operators/findIndex");Object.defineProperty(exports,"findIndex",{enumerable:!0,get:function(){return C.findIndex}});var L=require("../internal/operators/first");Object.defineProperty(exports,"first",{enumerable:!0,get:function(){return L.first}});var I=require("../internal/operators/groupBy");Object.defineProperty(exports,"groupBy",{enumerable:!0,get:function(){return I.groupBy}});var U=require("../internal/operators/ignoreElements");Object.defineProperty(exports,"ignoreElements",{enumerable:!0,get:function(){return U.ignoreElements}});var R=require("../internal/operators/isEmpty");Object.defineProperty(exports,"isEmpty",{enumerable:!0,get:function(){return R.isEmpty}});var B=require("../internal/operators/last");Object.defineProperty(exports,"last",{enumerable:!0,get:function(){return B.last}});var F=require("../internal/operators/map");Object.defineProperty(exports,"map",{enumerable:!0,get:function(){return F.map}});var K=require("../internal/operators/mapTo");Object.defineProperty(exports,"mapTo",{enumerable:!0,get:function(){return K.mapTo}});var N=require("../internal/operators/materialize");Object.defineProperty(exports,"materialize",{enumerable:!0,get:function(){return N.materialize}});var S=require("../internal/operators/max");Object.defineProperty(exports,"max",{enumerable:!0,get:function(){return S.max}});var _=require("../internal/operators/merge");Object.defineProperty(exports,"merge",{enumerable:!0,get:function(){return _.merge}});var D=require("../internal/operators/mergeAll");Object.defineProperty(exports,"mergeAll",{enumerable:!0,get:function(){return D.mergeAll}});var G=require("../internal/operators/mergeMap");Object.defineProperty(exports,"mergeMap",{enumerable:!0,get:function(){return G.mergeMap}}),Object.defineProperty(exports,"flatMap",{enumerable:!0,get:function(){return G.mergeMap}});var H=require("../internal/operators/mergeMapTo");Object.defineProperty(exports,"mergeMapTo",{enumerable:!0,get:function(){return H.mergeMapTo}});var J=require("../internal/operators/mergeScan");Object.defineProperty(exports,"mergeScan",{enumerable:!0,get:function(){return J.mergeScan}});var Q=require("../internal/operators/min");Object.defineProperty(exports,"min",{enumerable:!0,get:function(){return Q.min}});var V=require("../internal/operators/multicast");Object.defineProperty(exports,"multicast",{enumerable:!0,get:function(){return V.multicast}});var X=require("../internal/operators/observeOn");Object.defineProperty(exports,"observeOn",{enumerable:!0,get:function(){return X.observeOn}});var Y=require("../internal/operators/onErrorResumeNext");Object.defineProperty(exports,"onErrorResumeNext",{enumerable:!0,get:function(){return Y.onErrorResumeNext}});var Z=require("../internal/operators/pairwise");Object.defineProperty(exports,"pairwise",{enumerable:!0,get:function(){return Z.pairwise}});var $=require("../internal/operators/partition");Object.defineProperty(exports,"partition",{enumerable:!0,get:function(){return $.partition}});var ee=require("../internal/operators/pluck");Object.defineProperty(exports,"pluck",{enumerable:!0,get:function(){return ee.pluck}});var re=require("../internal/operators/publish");Object.defineProperty(exports,"publish",{enumerable:!0,get:function(){return re.publish}});var te=require("../internal/operators/publishBehavior");Object.defineProperty(exports,"publishBehavior",{enumerable:!0,get:function(){return te.publishBehavior}});var ne=require("../internal/operators/publishLast");Object.defineProperty(exports,"publishLast",{enumerable:!0,get:function(){return ne.publishLast}});var oe=require("../internal/operators/publishReplay");Object.defineProperty(exports,"publishReplay",{enumerable:!0,get:function(){return oe.publishReplay}});var ie=require("../internal/operators/race");Object.defineProperty(exports,"race",{enumerable:!0,get:function(){return ie.race}});var ae=require("../internal/operators/reduce");Object.defineProperty(exports,"reduce",{enumerable:!0,get:function(){return ae.reduce}});var ue=require("../internal/operators/repeat");Object.defineProperty(exports,"repeat",{enumerable:!0,get:function(){return ue.repeat}});var pe=require("../internal/operators/repeatWhen");Object.defineProperty(exports,"repeatWhen",{enumerable:!0,get:function(){return pe.repeatWhen}});var le=require("../internal/operators/retry");Object.defineProperty(exports,"retry",{enumerable:!0,get:function(){return le.retry}});var se=require("../internal/operators/retryWhen");Object.defineProperty(exports,"retryWhen",{enumerable:!0,get:function(){return se.retryWhen}});var ce=require("../internal/operators/refCount");Object.defineProperty(exports,"refCount",{enumerable:!0,get:function(){return ce.refCount}});var fe=require("../internal/operators/sample");Object.defineProperty(exports,"sample",{enumerable:!0,get:function(){return fe.sample}});var be=require("../internal/operators/sampleTime");Object.defineProperty(exports,"sampleTime",{enumerable:!0,get:function(){return be.sampleTime}});var me=require("../internal/operators/scan");Object.defineProperty(exports,"scan",{enumerable:!0,get:function(){return me.scan}});var de=require("../internal/operators/sequenceEqual");Object.defineProperty(exports,"sequenceEqual",{enumerable:!0,get:function(){return de.sequenceEqual}});var ge=require("../internal/operators/share");Object.defineProperty(exports,"share",{enumerable:!0,get:function(){return ge.share}});var ye=require("../internal/operators/shareReplay");Object.defineProperty(exports,"shareReplay",{enumerable:!0,get:function(){return ye.shareReplay}});var xe=require("../internal/operators/single");Object.defineProperty(exports,"single",{enumerable:!0,get:function(){return xe.single}});var ve=require("../internal/operators/skip");Object.defineProperty(exports,"skip",{enumerable:!0,get:function(){return ve.skip}});var Oe=require("../internal/operators/skipLast");Object.defineProperty(exports,"skipLast",{enumerable:!0,get:function(){return Oe.skipLast}});var qe=require("../internal/operators/skipUntil");Object.defineProperty(exports,"skipUntil",{enumerable:!0,get:function(){return qe.skipUntil}});var je=require("../internal/operators/skipWhile");Object.defineProperty(exports,"skipWhile",{enumerable:!0,get:function(){return je.skipWhile}});var Pe=require("../internal/operators/startWith");Object.defineProperty(exports,"startWith",{enumerable:!0,get:function(){return Pe.startWith}});var he=require("../internal/operators/subscribeOn");Object.defineProperty(exports,"subscribeOn",{enumerable:!0,get:function(){return he.subscribeOn}});var we=require("../internal/operators/switchAll");Object.defineProperty(exports,"switchAll",{enumerable:!0,get:function(){return we.switchAll}});var Te=require("../internal/operators/switchMap");Object.defineProperty(exports,"switchMap",{enumerable:!0,get:function(){return Te.switchMap}});var We=require("../internal/operators/switchMapTo");Object.defineProperty(exports,"switchMapTo",{enumerable:!0,get:function(){return We.switchMapTo}});var ke=require("../internal/operators/take");Object.defineProperty(exports,"take",{enumerable:!0,get:function(){return ke.take}});var Me=require("../internal/operators/takeLast");Object.defineProperty(exports,"takeLast",{enumerable:!0,get:function(){return Me.takeLast}});var Ae=require("../internal/operators/takeUntil");Object.defineProperty(exports,"takeUntil",{enumerable:!0,get:function(){return Ae.takeUntil}});var Ee=require("../internal/operators/takeWhile");Object.defineProperty(exports,"takeWhile",{enumerable:!0,get:function(){return Ee.takeWhile}});var ze=require("../internal/operators/tap");Object.defineProperty(exports,"tap",{enumerable:!0,get:function(){return ze.tap}});var Ce=require("../internal/operators/throttle");Object.defineProperty(exports,"throttle",{enumerable:!0,get:function(){return Ce.throttle}});var Le=require("../internal/operators/throttleTime");Object.defineProperty(exports,"throttleTime",{enumerable:!0,get:function(){return Le.throttleTime}});var Ie=require("../internal/operators/throwIfEmpty");Object.defineProperty(exports,"throwIfEmpty",{enumerable:!0,get:function(){return Ie.throwIfEmpty}});var Ue=require("../internal/operators/timeInterval");Object.defineProperty(exports,"timeInterval",{enumerable:!0,get:function(){return Ue.timeInterval}});var Re=require("../internal/operators/timeout");Object.defineProperty(exports,"timeout",{enumerable:!0,get:function(){return Re.timeout}});var Be=require("../internal/operators/timeoutWith");Object.defineProperty(exports,"timeoutWith",{enumerable:!0,get:function(){return Be.timeoutWith}});var Fe=require("../internal/operators/timestamp");Object.defineProperty(exports,"timestamp",{enumerable:!0,get:function(){return Fe.timestamp}});var Ke=require("../internal/operators/toArray");Object.defineProperty(exports,"toArray",{enumerable:!0,get:function(){return Ke.toArray}});var Ne=require("../internal/operators/window");Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return Ne.window}});var Se=require("../internal/operators/windowCount");Object.defineProperty(exports,"windowCount",{enumerable:!0,get:function(){return Se.windowCount}});var _e=require("../internal/operators/windowTime");Object.defineProperty(exports,"windowTime",{enumerable:!0,get:function(){return _e.windowTime}});var De=require("../internal/operators/windowToggle");Object.defineProperty(exports,"windowToggle",{enumerable:!0,get:function(){return De.windowToggle}});var Ge=require("../internal/operators/windowWhen");Object.defineProperty(exports,"windowWhen",{enumerable:!0,get:function(){return Ge.windowWhen}});var He=require("../internal/operators/withLatestFrom");Object.defineProperty(exports,"withLatestFrom",{enumerable:!0,get:function(){return He.withLatestFrom}});var Je=require("../internal/operators/zip");Object.defineProperty(exports,"zip",{enumerable:!0,get:function(){return Je.zip}});var Qe=require("../internal/operators/zipAll");Object.defineProperty(exports,"zipAll",{enumerable:!0,get:function(){return Qe.zipAll}});
},{"../internal/operators/audit":"pl75","../internal/operators/auditTime":"UsjT","../internal/operators/buffer":"YpQd","../internal/operators/bufferCount":"L2rV","../internal/operators/bufferTime":"q2KB","../internal/operators/bufferToggle":"E7G3","../internal/operators/bufferWhen":"pPew","../internal/operators/catchError":"TXdn","../internal/operators/combineAll":"7cm5","../internal/operators/combineLatest":"CWCf","../internal/operators/concat":"/N1E","../internal/operators/concatAll":"gOvZ","../internal/operators/concatMap":"wzcJ","../internal/operators/concatMapTo":"cEOt","../internal/operators/count":"ItUr","../internal/operators/debounce":"xwCK","../internal/operators/debounceTime":"B6x9","../internal/operators/defaultIfEmpty":"WMek","../internal/operators/delay":"wqoi","../internal/operators/delayWhen":"EkH9","../internal/operators/dematerialize":"T9UD","../internal/operators/distinct":"WOX4","../internal/operators/distinctUntilChanged":"4g3F","../internal/operators/distinctUntilKeyChanged":"PHGZ","../internal/operators/elementAt":"3YiC","../internal/operators/endWith":"4eHk","../internal/operators/every":"s+tD","../internal/operators/exhaust":"6L1O","../internal/operators/exhaustMap":"dh+N","../internal/operators/expand":"xb4A","../internal/operators/filter":"2Z4q","../internal/operators/finalize":"pwt7","../internal/operators/find":"NLOD","../internal/operators/findIndex":"BFxX","../internal/operators/first":"/Qph","../internal/operators/groupBy":"pn8u","../internal/operators/ignoreElements":"zoju","../internal/operators/isEmpty":"9kLc","../internal/operators/last":"PDCV","../internal/operators/map":"aORC","../internal/operators/mapTo":"ehRT","../internal/operators/materialize":"Kvui","../internal/operators/max":"S5cs","../internal/operators/merge":"Uip8","../internal/operators/mergeAll":"yTi9","../internal/operators/mergeMap":"I5oK","../internal/operators/mergeMapTo":"VclZ","../internal/operators/mergeScan":"NHaR","../internal/operators/min":"kHGi","../internal/operators/multicast":"/d/y","../internal/operators/observeOn":"fRUF","../internal/operators/onErrorResumeNext":"BKBC","../internal/operators/pairwise":"NKJ0","../internal/operators/partition":"Bl4q","../internal/operators/pluck":"4H+/","../internal/operators/publish":"+zvS","../internal/operators/publishBehavior":"J8x9","../internal/operators/publishLast":"TvgQ","../internal/operators/publishReplay":"TS2w","../internal/operators/race":"TTEx","../internal/operators/reduce":"mqtm","../internal/operators/repeat":"ZkdK","../internal/operators/repeatWhen":"uyiE","../internal/operators/retry":"IhyQ","../internal/operators/retryWhen":"RMyk","../internal/operators/refCount":"bnAO","../internal/operators/sample":"m7Y6","../internal/operators/sampleTime":"yyRa","../internal/operators/scan":"0jsb","../internal/operators/sequenceEqual":"mAyD","../internal/operators/share":"lhL3","../internal/operators/shareReplay":"oi1F","../internal/operators/single":"Z6I5","../internal/operators/skip":"SA33","../internal/operators/skipLast":"U3UT","../internal/operators/skipUntil":"FTfF","../internal/operators/skipWhile":"Ppaj","../internal/operators/startWith":"tqHQ","../internal/operators/subscribeOn":"/smR","../internal/operators/switchAll":"vG3r","../internal/operators/switchMap":"seWQ","../internal/operators/switchMapTo":"pvsX","../internal/operators/take":"95nX","../internal/operators/takeLast":"dknK","../internal/operators/takeUntil":"hbmf","../internal/operators/takeWhile":"9qrb","../internal/operators/tap":"5+df","../internal/operators/throttle":"rWZJ","../internal/operators/throttleTime":"ANbJ","../internal/operators/throwIfEmpty":"hlGy","../internal/operators/timeInterval":"Rxp8","../internal/operators/timeout":"DLRl","../internal/operators/timeoutWith":"u7rK","../internal/operators/timestamp":"L75v","../internal/operators/toArray":"vuVW","../internal/operators/window":"0OlN","../internal/operators/windowCount":"nCAU","../internal/operators/windowTime":"19p4","../internal/operators/windowToggle":"5PR9","../internal/operators/windowWhen":"2v1T","../internal/operators/withLatestFrom":"6uQf","../internal/operators/zip":"eu+D","../internal/operators/zipAll":"pvkO"}],"RSYQ":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../point"),r=require("./vertical-line"),i=function(){function i(e){n(this,i),this.y=e}return e(i,[{key:"isParallelTo",value:function(e){return e instanceof i}},{key:"isPerpendicularTo",value:function(e){return e instanceof r.VerticalLine}},{key:"getIntersectionPointWith",value:function(e){if(this.isParallelTo(e))throw new Error("Lines are parallel so there is no intersection point (Y="+this.y+")");if(this.isPerpendicularTo(e))return new t.Point(e.x,this.y);var n=e=e,r=(this.y-n.b)/n.m;return new t.Point(r,this.y)}},{key:"getPerpendicularLineAtPoint",value:function(e){return new r.VerticalLine(e.x)}},{key:"getParallelLineAtPoint",value:function(e){return new i(e.y)}},{key:"toString",value:function(){return"Line[y="+this.y+"]"}}]),i}();exports.HorizontalLine=i;
},{"../point":"bg89","./vertical-line":"a29i"}],"a29i":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("./horizontal-line"),r=require("../point"),i=function(){function i(e){n(this,i),this.x=e}return e(i,[{key:"isParallelTo",value:function(e){return e instanceof i}},{key:"isPerpendicularTo",value:function(e){return e instanceof t.HorizontalLine}},{key:"getIntersectionPointWith",value:function(e){if(this.isParallelTo(e))throw new Error("Lines are parallel so there is no intersection point (X="+this.x+")");if(this.isPerpendicularTo(e))return new r.Point(this.x,e.y);var n=e=e,t=n.m*this.x+n.b;return new r.Point(this.x,t)}},{key:"getPerpendicularLineAtPoint",value:function(e){return new t.HorizontalLine(e.y)}},{key:"getParallelLineAtPoint",value:function(e){return new i(e.x)}},{key:"toString",value:function(){return"Line[x="+this.x+"]"}}]),i}();exports.VerticalLine=i;
},{"./horizontal-line":"RSYQ","../point":"bg89"}],"5N3H":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../point"),i=function(){function i(e,t){n(this,i),this.m=e,this.b=t}return e(i,[{key:"isParallelTo",value:function(e){return this.m===e.m}},{key:"isPerpendicularTo",value:function(e){return this.m===-1/e.m}},{key:"getIntersectionPointWith",value:function(e){var n=(e.b-this.b)/(this.m-e.m),i=this.m*n+this.b;return new t.Point(n,i)}},{key:"getPerpendicularLineAtPoint",value:function(e){var n=-1/this.m;return new i(n,e.y-n*e.x)}},{key:"getParallelLineAtPoint",value:function(e){var n=this.m;return new i(n,e.y-n*e.x)}},{key:"toString",value:function(){return"Line[m="+this.m+" b="+this.b+"]"}}]),i}();exports.DiagonalLine=i;
},{"../point":"bg89"}],"oqUp":[function(require,module,exports) {
"use strict";var e=function(){function e(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,r,i){return r&&e(n.prototype,r),i&&e(n,i),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../domain/lines/vertical-line"),i=require("../../domain/lines/horizontal-line"),t=require("../../domain/lines/diagonal-line"),o=function(){function o(){n(this,o)}return e(o,null,[{key:"givenPoints",value:function(e,n){if(e.y===n.y)return new i.HorizontalLine(e.y);if(e.x===n.x)return new r.VerticalLine(e.x);var o=(e.y-n.y)/(e.x-n.x),a=e.y-e.x*o;return new t.DiagonalLine(o,a)}}]),o}();exports.LineFactory=o;
},{"../../domain/lines/vertical-line":"a29i","../../domain/lines/horizontal-line":"RSYQ","../../domain/lines/diagonal-line":"5N3H"}],"/ysq":[function(require,module,exports) {
"use strict";var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var o=require("./updatable"),r=require("../service/util/line-factory"),a=function(a){function s(t,i,o,r){e(this,s);var a=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this));return a.point1=t,a.point2=i,a.point3=o,a.point4=r,a.notifyUpdateOnPointUpdate(),a}return i(s,o.Updatable),t(s,[{key:"notifyUpdateOnPointUpdate",value:function(){var t=this;this.points.forEach(function(e){e.whenUpdated(function(){t.notifyUpdate(t)})})}},{key:"points",get:function(){return[this.point1,this.point2,this.point4,this.point3]}},{key:"centerOfMass",get:function(){var t=r.LineFactory.givenPoints(this.point1,this.point4),e=r.LineFactory.givenPoints(this.point2,this.point3);return t.getIntersectionPointWith(e)}},{key:"area",get:function(){var t=r.LineFactory.givenPoints(this.point1,this.point2),e=r.LineFactory.givenPoints(this.point3,this.point4),n=t.getPerpendicularLineAtPoint(this.point1).getIntersectionPointWith(e),i=this.point1.getDistanceTo(n);return this.point1.getDistanceTo(this.point2)*i}}],[{key:"givenThreePoints",value:function(t,e,n){var i=r.LineFactory.givenPoints(t,e),o=r.LineFactory.givenPoints(t,n),a=i.getParallelLineAtPoint(n),p=o.getParallelLineAtPoint(e);return new s(t,e,n,a.getIntersectionPointWith(p))}}]),s}();exports.Parallelogram=a;
},{"./updatable":"P0zd","../service/util/line-factory":"oqUp"}],"Mmj6":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(e,r){t(this,n),this._center=e,this._radius=r}return e(n,[{key:"update",value:function(e,t){this._center=e,this._radius=t}},{key:"center",get:function(){return this._center}},{key:"radius",get:function(){return this._radius}}],[{key:"getRadiusGivenArea",value:function(e){return Math.sqrt(e/Math.PI)}}]),n}();exports.Circle=n;
},{}],"ZmNU":[function(require,module,exports) {
"use strict";var a=function(){function a(a,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();function e(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("rxjs/operators"),i=require("./domain/parallelogram"),r=require("./domain/circle"),l=function(){function l(a,t,i,r,n){e(this,l),this.painter=a,this.infoBar=t,this.dialog=i,this.about=r,this.validator=n,this.updatables=[],this.allowedToRestart=!1}return a(l,[{key:"init",value:function(){var a=this,e=[];this.painter.onCanvasClicked().pipe(t.take(3)).subscribe({next:function(t){a.displayPoint(t),e.push(t)},error:function(a){return console.warn(a)},complete:function(){var t=a.validator.parallelogramCanBeBuilt(e);t.valid?a.continueApplicationExecution(e):(console.warn(t.error),a.dialog.show(),a.restart(!0))}})}},{key:"restart",value:function(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.allowedToRestart)&&(this.clearAppState(),this.init())}},{key:"continueApplicationExecution",value:function(a){this.parallelogram=i.Parallelogram.givenThreePoints(a[0],a[1],a[2]),this.circle=new r.Circle(this.parallelogram.centerOfMass,r.Circle.getRadiusGivenArea(this.parallelogram.area)),this.displayPoint(this.parallelogram.point4),this.displayParallelogram(this.parallelogram),this.displayCircle(this.circle),this.subscribeToPointsUpdates(),this.painter.makePointsSelectable(),this.infoBar.enableStartAgainButton(),this.allowedToRestart=!0}},{key:"displayPoint",value:function(a){this.painter.paintPoint(a),this.infoBar.displayPointInfo(a),this.updatables.push(a)}},{key:"displayParallelogram",value:function(a){this.painter.paintParallelogram(a),this.infoBar.displayParallelogramInfo(a),this.updatables.push(a)}},{key:"displayCircle",value:function(a){this.painter.paintCircle(a)}},{key:"subscribeToPointsUpdates",value:function(){var a=this,e=this.parallelogram.points;e.forEach(function(t,i){t.whenUpdated(function(t){var l=e[(i+1)%e.length];l.updateTo(l.x-t.x,l.y-t.y,!1),a.infoBar.updatePointInfo(l),a.circle.update(a.parallelogram.centerOfMass,r.Circle.getRadiusGivenArea(a.parallelogram.area)),a.painter.movePoint(l),a.painter.moveParallelogram(a.parallelogram),a.painter.moveCircle(a.circle)})})}},{key:"clearAppState",value:function(){this.painter.clear(),this.infoBar.clear(),this.clearUpdatables(),this.clearState()}},{key:"clearUpdatables",value:function(){this.updatables.forEach(function(a){a.destroySubscriptions()}),this.updatables.splice(0,this.updatables.length)}},{key:"clearState",value:function(){this.circle=null,this.parallelogram=null,this.allowedToRestart=!1}}]),l}();exports.Application=l;
},{"rxjs/operators":"xm9t","./domain/parallelogram":"/ysq","./domain/circle":"Mmj6"}],"AcVZ":[function(require,module,exports) {
"use strict";var e=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function o(e){var n=this;t(this,o),this.toggleDialog=function(){n.dialog.classList.toggle("dialog--open")},this.dialog=document.getElementById(e),this.message=this.dialog.children.item(0)}return e(o,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:o.DEFAULT};this.message.innerHTML=e.message,this.toggleDialog(),setTimeout(this.toggleDialog,3500)}}]),o}();o.DEFAULT="The points you selected cannot be used to build a parallelogram",exports.Dialog=o;
},{}],"ConU":[function(require,module,exports) {
"use strict";var e=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();function r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=require("../../domain/parallelogram"),t=function(){function t(){r(this,t)}return e(t,[{key:"parallelogramCanBeBuilt",value:function(e){try{return this.pointsAreDifferentOrElseThrow(e),this.parallelogramCanBeBuiltOfElseThrow(e),{valid:!0}}catch(e){return{valid:!1,error:e.message}}}},{key:"pointsAreDifferentOrElseThrow",value:function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)if(r!==n&&e[r].isEqualTo(e[n]))throw new Error("Points cannot be the same")}},{key:"parallelogramCanBeBuiltOfElseThrow",value:function(e){n.Parallelogram.givenThreePoints(e[0],e[1],e[2])}}]),t}();exports.InputValidator=t;
},{"../../domain/parallelogram":"/ysq"}],"3vPc":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function e(s){var i=this;t(this,e),this.hide=function(){i.section.classList.remove(e.SHOW_BOX)},this.toggle=function(){i.section.classList.toggle(e.SHOW_BOX)},this.section=document.getElementById(s),this.section.querySelector("[data-close]").addEventListener("click",this.hide)};e.SHOW_BOX="about-info--open",exports.About=e;
},{}],"ZCfc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./src/service/canvas/painter"),r=require("./src/service/info-bar/info-bar"),i=require("./src/application"),a=require("./src/service/dialog/dialog"),n=require("./src/service/validator/input-validator"),o=require("./src/service/about/about"),t=new e.Painter("canvas"),c=new r.InfoBar("info-bar"),s=new a.Dialog("error-dialog"),u=new o.About("about"),l=new n.InputValidator,v=new i.Application(t,c,s,u,l);v.init(),c.onStartAgainClicked(function(){v.restart()}),c.onAboutClicked(function(){u.toggle()});
},{"./src/service/canvas/painter":"ar8D","./src/service/info-bar/info-bar":"BFB5","./src/application":"ZmNU","./src/service/dialog/dialog":"AcVZ","./src/service/validator/input-validator":"ConU","./src/service/about/about":"3vPc"}]},{},["ZCfc"], null)